<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta name="google-site-verification" content="ry1yoyqNLU4E5QrzTiEwH_DmCaDdP_ZRhtp9KqfPD5Y" />
  
  <meta name="baidu-site-verification" content="8t675UMTPK" />
  <meta name="msvalidate.01" content="69587B143623DA93DFA18F587EACF888" />
  <meta charset="utf-8">
  
  <title>文强的个人空间</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="文强的个人空间">
<meta property="og:url" content="http://wenqiang-china.github.io/index.html">
<meta property="og:site_name" content="文强的个人空间">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="文强的个人空间">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="文强的个人空间" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
      <link href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" rel="stylesheet">
  
  
  
      <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
      <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">
  
  <link rel="stylesheet" href="/css/style.css">
  
      <style> .article { opacity: 0;} </style>
  
  <link href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">
  
  <script src="//cdn.bootcss.com/jquery/1.9.1/jquery.min.js"></script>
  <script src="//cdn.bootcss.com/clipboard.js/1.5.9/clipboard.min.js"></script>
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false,
          fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
          scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.0.9/scrollreveal.min.js"
      }
  </script>

  
      <script>
          yiliaConfig.rootUrl = "/";
      </script>
  

  
  
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">wenqiang</a></h1>
        </hgroup>

        
                


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:wenqiang_china@126.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" target="_blank" href="http://weibo.com/u/2631742593/" title="新浪微博"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/wenqiang-china/" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa 知乎" target="_blank" href="https://www.zhihu.com/people/wen-qiang-83-85" title="知乎"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Excel/">Excel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GIL/">GIL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQLdb/">MySQLdb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Queue/">Queue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/classmethod/">classmethod</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/multiprocessing/">multiprocessing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openpyxl/">openpyxl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/property/">property</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/staticmethod/">staticmethod</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xlrd/">xlrd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xlwt/">xlwt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/互联网/">互联网</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/代理/">代理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/休闲/">休闲</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/入门教程/">入门教程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/函数式编程/">函数式编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多线程/">多线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多进程/">多进程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/学习笔记/">学习笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/并发/">并发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/爬虫/">爬虫</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/爱情/">爱情</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程/">编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程题/">编程题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/音乐/">音乐</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/高级数据库/">高级数据库</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/wenqiang-china/">Wenqiang</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">Python党，立志成为全栈工程师的菜鸟一枚。爱大数据，更爱美女。</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">wenqiang</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">wenqiang</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:wenqiang_china@126.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" target="_blank" href="http://weibo.com/u/2631742593/" title="新浪微博"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/wenqiang-china/" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa 知乎" target="_blank" href="https://www.zhihu.com/people/wen-qiang-83-85" title="知乎"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-no-waiting" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/11/06/no-waiting/" class="article-date">
      <time datetime="2016-11-05T20:04:04.000Z" itemprop="datePublished">2016-11-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/06/no-waiting/">别在等待中失去了节奏</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>&#x518D;&#x4E00;&#x6B21;&#x4E8E;&#x51CC;&#x6668;&#x4ECE;&#x88AB;&#x7A9D;&#x4E2D;&#x51BB;&#x9192;&#xFF0C;&#x8F97;&#x8F6C;&#x53CD;&#x4FA7;&#x4E86;&#x8BB8;&#x4E45;&#xFF0C;&#x51B3;&#x5B9A;&#x5199;&#x4E00;&#x7BC7;&#x535A;&#x6587;&#x3002;&#x4F5C;&#x4E3A;&#x63A2;&#x8BA8;&#x7231;&#x60C5;&#x89C2;&#x7684;&#x535A;&#x6587;&#xFF0C;&#x53EF;&#x4EE5;&#x8BF4;&#x8FD9;&#x662F;&#x6240;&#x6709;&#x6211;&#x5199;&#x8FC7;&#x7684;&#x975E;&#x6280;&#x672F;&#x7C7B;&#x535A;&#x6587;&#x4E2D;&#x7684;&#x4E00;&#x80A1;&#x6E05;&#x6D41;&#x3002;</p>
<h3 id="&#x4ECE;&#x8282;&#x594F;&#x8C08;&#x8D77;"><a href="#&#x4ECE;&#x8282;&#x594F;&#x8C08;&#x8D77;" class="headerlink" title="&#x4ECE;&#x8282;&#x594F;&#x8C08;&#x8D77;"></a>&#x4ECE;&#x8282;&#x594F;&#x8C08;&#x8D77;</h3><p>&#x8282;&#x594F;&#x4F5C;&#x4E3A;&#x5F00;&#x573A;&#x6700;&#x4E3A;&#x5408;&#x9002;&#x4E0D;&#x8FC7;&#xFF0C;&#x5C0F;&#x5B66;&#x4E0A;&#x97F3;&#x4E50;&#x8BFE;&#x8001;&#x5E08;&#x5C31;&#x5938;&#x6211;&#x6253;&#x8282;&#x62CD;&#x7279;&#x522B;&#x51C6;&#x3002;&#x786E;&#x5207;&#x7684;&#x8BF4;&#xFF0C;&#x8FD9;&#x79CD;&#x8282;&#x594F;&#x611F;&#x4E5F;&#x53EF;&#x4EE5;&#x8BF4;&#x662F;&#x4ECE;&#x5C0F;&#x5B66;&#x5F00;&#x59CB;&#x7684;&#x3002;&#x5C0F;&#x5B66;&#x65F6;&#x8FDE;&#x505A;&#x4F5C;&#x4E1A;&#x90FD;&#x662F;&#x6309;&#x7167;&#x8001;&#x5E08;&#x8BF4;&#x597D;&#x7684;&#x8282;&#x594F;&#x6765;&#x7684;&#xFF0C;&#x4E94;&#x4E00;&#x4E03;&#x5929;&#x5047;&#xFF0C;&#x6BCF;&#x5929;&#x5199;&#x4E00;&#x70B9;&#x4F5C;&#x4E1A;&#x7136;&#x540E;&#x53BB;&#x73A9;&#xFF0C;&#x9075;&#x4ECE;&#x5B8C;&#x7F8E;&#x7684;&#x89C4;&#x5212;&#x3002;&#x7136;&#x800C;&#x7B2C;&#x4E03;&#x5929;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6BCD;&#x4EB2;&#x505A;&#x5B8C;&#x519C;&#x6D3B;&#x56DE;&#x6765;&#xFF0C;&#x89C1;&#x6211;&#x8FD8;&#x5728;&#x4E0D;&#x7D27;&#x4E0D;&#x6162;&#x7684;&#x5199;&#x4F5C;&#x4E1A;&#xFF0C;&#x95EE;&#x6211;&#x5199;&#x5B8C;&#x4E86;&#x6CA1;&#xFF0C;&#x6211;&#x8BF4;&#x8FD8;&#x6CA1;&#x6709;&#x3002;&#x4E8E;&#x662F;&#x5979;&#x628A;&#x6211;&#x6574;&#x4E2A;&#x4F5C;&#x4E1A;&#x672C;&#x90FD;&#x6495;&#x4E86;&#x3002;&#x6211;&#x6D41;&#x4E86;&#x4F1A;&#x773C;&#x6CEA;&#xFF0C;&#x7136;&#x800C;&#x8D76;&#x7D27;&#x82E6;&#x903C;&#x5730;&#x8D76;&#x8D77;&#x4E86;&#x4F5C;&#x4E1A;&#xFF0C;&#x7EC8;&#x4E8E;&#x5199;&#x4E86;&#x4E00;&#x4E0B;&#x5348;&#x5199;&#x5B8C;&#x4E86;&#x3002;&#x90A3;&#x662F;&#x6211;&#x7B2C;&#x4E00;&#x6B21;&#x53D1;&#x73B0;<strong>deadline&#x4E4B;&#x524D;&#x7684;&#x6548;&#x7387;&#x662F;&#x6700;&#x9AD8;&#x7684;</strong>&#x3002;&#x4E8E;&#x662F;&#x4ECE;&#x90A3;&#x4E4B;&#x540E;&#x6211;&#x6362;&#x4E86;&#x79CD;&#x8282;&#x594F;&#xFF0C;&#x6BCF;&#x6B21;&#x653E;&#x5047;&#x90FD;&#x662F;&#x5148;&#x73A9;&#x547D;&#x628A;&#x4F5C;&#x4E1A;&#x5199;&#x5B8C;&#xFF0C;&#x7136;&#x540E;&#x968F;&#x4FBF;&#x73A9;&#x3002;&#x5F53;&#x7136;&#x4E0D;&#x90FD;&#x662F;&#x7EAF;&#x4E3A;&#x4E86;&#x5B8C;&#x6210;&#x4F5C;&#x4E1A;&#x800C;&#x53BB;&#x505A;&#x4F5C;&#x4E1A;&#xFF0C;&#x4F8B;&#x5982;&#x521D;&#x4E2D;&#x7684;&#x65F6;&#x5019;&#x611F;&#x89C9;&#x505A;&#x82F1;&#x8BED;&#x9898;&#x662F;&#x79CD;&#x4EAB;&#x53D7;&#xFF0C;&#x6BCF;&#x6B21;&#x653E;&#x5047;&#x5F53;&#x665A;&#x6211;&#x90FD;&#x4F1A;&#x62FF;&#x51FA;&#x6240;&#x6709;&#x7684;&#x82F1;&#x8BED;&#x9898;&#x8BD5;&#x5377;&#x5806;&#x5728;&#x684C;&#x4E0A;&#xFF0C;&#x7136;&#x540E;&#x594B;&#x6218;1&#x4E2A;&#x591A;&#x5C0F;&#x65F6;&#xFF0C;&#x4EAB;&#x53D7;&#x8650;&#x9898;&#x7684;&#x4E50;&#x8DA3;&#x3002;8&#x5F00;&#x7684;&#x8BD5;&#x5377;&#xFF0C;&#x5355;&#x9762;3&#x5206;&#x949F;&#xFF0C;&#x6B63;&#x786E;&#x7387;95%&#xFF0C;&#x8FD9;&#x662F;&#x5F53;&#x65F6;&#x6211;&#x521B;&#x9020;&#x7684;&#x8BB0;&#x5F55;&#x3002;</p>
<p>&#x8FD9;&#x79CD;&#x8282;&#x594F;&#x4ECE;&#x5C0F;&#x5B66;&#x5230;&#x9AD8;&#x4E2D;&#x7ED3;&#x675F;&#xFF0C;&#x4E00;&#x8DEF;&#x611F;&#x89C9;&#x7279;&#x522B;&#x987A;&#x7545;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x8282;&#x594F;&#x8DEF;&#x7EBF;&#x548C;&#x5927;&#x4E3B;&#x9898;&#x5951;&#x5408;&#x7684;&#x7F18;&#x6545;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x8282;&#x594F;&#x4E0B;&#xFF0C;&#x4E0D;&#x7528;&#x8003;&#x8651;<code>deadline</code>&#xFF0C;&#x56E0;&#x4E3A;&#x5F88;&#x5C11;&#x4F1A;&#x9047;&#x5230;&#x3002;&#x76F4;&#x5230;&#x4E0A;&#x4E86;&#x5927;&#x5B66;&#xFF0C;&#x8FD9;&#x79CD;&#x5883;&#x51B5;&#x88AB;&#x6253;&#x7834;&#x3002;</p>
<h3 id="deadline&#x65B9;&#x5F0F;&#x7684;&#x5D1B;&#x8D77;"><a href="#deadline&#x65B9;&#x5F0F;&#x7684;&#x5D1B;&#x8D77;" class="headerlink" title="deadline&#x65B9;&#x5F0F;&#x7684;&#x5D1B;&#x8D77;"></a>deadline&#x65B9;&#x5F0F;&#x7684;&#x5D1B;&#x8D77;</h3><p>&#x6CA1;&#x9519;&#xFF0C;&#x5927;&#x5B66;&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x662F;<code>deadline</code>&#x65B9;&#x5F0F;&#x5D1B;&#x8D77;&#x7684;&#x5143;&#x5E74;&#x3002;&#x5927;&#x4E00;&#x7684;&#x65F6;&#x5019;&#x628A;&#x5F88;&#x591A;&#x7CBE;&#x529B;&#x653E;&#x5728;&#x9AD8;&#x6570;&#x4E0A;&#xFF0C;&#x4EE5;&#x4E3A;&#x53EF;&#x4EE5;&#x51ED;&#x501F;&#x9AD8;&#x6570;<code>&#x5236;&#x9738;&#x5B66;&#x9662;</code>&#xFF0C;&#x7136;&#x800C;&#x6700;&#x7EC8;&#x53D1;&#x73B0;&#x81EA;&#x5DF1;&#x8FD8;&#x662F;&#x592A;<code>naive</code>&#xFF0C;&#x8FDE;&#x81EA;&#x5DF1;&#x5BBF;&#x820D;&#x7684;&#x4E00;&#x4E2A;&#x6C5F;&#x82CF;&#x7684;&#x54E5;&#x4EEC;&#x90FD;&#x6BD4;&#x4E0D;&#x8FC7;&#x3002;&#x5728;&#x4E24;&#x6B21;&#x9AD8;&#x6570;&#x671F;&#x672B;&#x8003;&#x8BD5;&#x90FD;&#x5F98;&#x5F8A;&#x5728;90&#x5206;&#x8FB9;&#x7F18;&#x540E;&#xFF0C;&#x6211;&#x51B3;&#x5B9A;&#x8F6C;&#x53D8;&#x601D;&#x8DEF;&#xFF0C;&#x627E;&#x5BFB;&#x4E00;&#x6761;&#x53EF;&#x6301;&#x7EED;&#x53D1;&#x5C55;&#x7684;&#x65B0;&#x9053;&#x8DEF;&#x3002;&#x4E8E;&#x662F;&#x5728;&#x5927;&#x4E8C;&#x4E00;&#x5E74;&#xFF0C;&#x8003;&#x4E86;&#x82F1;&#x8BED;4&#x3001;6&#x7EA7;&#xFF0C;&#x8BA1;&#x7B97;&#x673A;2&#x3001;4&#x7EA7;&#xFF0C;&#x4E0D;&#x8FC7;&#x540E;&#x6765;&#x53D1;&#x73B0;&#x8FD9;&#x4E9B;&#x4E1C;&#x897F;&#x5E76;&#x6CA1;&#x4EC0;&#x4E48;&#x7528;&#x3002;&#x5176;&#x5B9E;&#x5728;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5DF2;&#x7ECF;&#x6709;&#x4E9B;&#x8DD1;&#x504F;&#x4E86;&#xFF0C;&#x4E0D;&#x518D;&#x50CF;&#x5927;&#x4E00;&#x5B66;&#x9AD8;&#x6570;&#x90A3;&#x6837;&#x82B1;&#x8D39;&#x5F88;&#x591A;&#x7ECF;&#x5386;&#x5728;&#x4E0A;&#x9762;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x8003;&#x8BD5;&#x524D;&#x7684;&#x534A;&#x4E2A;&#x6708;&#x5185;&#x5F00;&#x59CB;<code>&#x7A81;&#x51FB;&#x6A21;&#x5F0F;</code>&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x7EC8;&#x4E8E;&#x770B;&#x5230;<code>deadline</code>&#x65B9;&#x5F0F;&#x7684;&#x9AD8;&#x6548;&#x3002;&#x4ECE;&#x6B64;&#x5F00;&#x59CB;&#x6108;&#x53D1;&#x559C;&#x6B22;&#x4E0A;&#x4E86;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x4EE5;&#x81F3;&#x4E8E;&#x540E;&#x6765;&#x5F88;&#x591A;&#x5730;&#x65B9;&#x90FD;&#x5728;&#x7528;&#xFF0C;&#x5305;&#x62EC;&#x7814;&#x7A76;&#x751F;&#x9636;&#x6BB5;&#x7684;&#x8003;&#x524D;&#x590D;&#x4E60;&#xFF0C;&#x627E;&#x5B9E;&#x4E60;&#xFF0C;&#x751A;&#x81F3;&#x662F;&#x5B66;&#x4F4D;&#x8BBA;&#x6587;&#x7684;&#x5F00;&#x9898;&#x3002;&#x5F88;&#x591A;&#x65F6;&#x5019;&#x505A;&#x4E8B;&#x662F;&#x8FEB;&#x4E8E;<code>deadline</code>&#x7684;&#x538B;&#x529B;&#xFF0C;&#x5E38;&#x5E38;&#x5DEE;&#x4E00;&#x70B9;&#x70B9;&#x5C31;&#x8D85;&#x8FC7;<code>deadline</code>&#x4E86;&#xFF0C;&#x4E0D;&#x8FC7;&#x597D;&#x5728;&#x51ED;&#x501F;&#x8FD0;&#x6C14;<code>&#x82DF;&#x6D3B;</code>&#x5230;&#x73B0;&#x5728;&#x3002;</p>
<p>&#x5B9E;&#x4E60;&#x4E4B;&#x540E;&#x53D1;&#x73B0;<code>deadline</code>&#x7ADF;&#x7136;&#x5728;&#x5DE5;&#x4F5C;&#x4E2D;&#x5E7F;&#x6CDB;&#x4F7F;&#x7528;&#x3002;&#x6BCF;&#x6B21;&#x63A5;&#x5230;&#x9700;&#x6C42;&#x90FD;&#x8981;&#x9884;&#x4F30;&#x4E00;&#x4E2A;<code>deadline</code>&#xFF0C;&#x7136;&#x540E;&#x4E3A;&#x4E86;&#x6309;&#x65F6;&#x4EA4;&#x4ED8;&#x6709;&#x65F6;&#x5C31;&#x4E0D;&#x514D;&#x52A0;&#x73ED;&#x5B8C;&#x6210;&#x3002;</p>
<h3 id="deadline&#x51E0;&#x5B97;&#x7F6A;"><a href="#deadline&#x51E0;&#x5B97;&#x7F6A;" class="headerlink" title="deadline&#x51E0;&#x5B97;&#x7F6A;"></a>deadline&#x51E0;&#x5B97;&#x7F6A;</h3><p>&#x7136;&#x800C;<code>deadline</code>&#x5E26;&#x6765;&#x7684;&#x8D1F;&#x9762;&#x6548;&#x5E94;&#x592A;&#x591A;&#xFF0C;&#x9996;&#x5148;&#x5B83;&#x6253;&#x4E71;&#x4E86;<code>&#x8282;&#x594F;</code>&#x3002;&#x6211;&#x4E0D;&#x5F97;&#x4E0D;&#x5C06;&#x751F;&#x6D3B;&#x72B6;&#x6001;&#x5212;&#x5206;&#x4E3A;<code>&#x5E73;&#x5E38;&#x72B6;&#x6001;</code>&#x548C;<code>deadline&#x524D;&#x5915;&#x72B6;&#x6001;</code>&#xFF0C;&#x7136;&#x540E;&#x5728;&#x5206;&#x754C;&#x5CAD;&#x51FA;&#x6765;&#x4E00;&#x4E2A;&#x7A81;&#x53D8;&#xFF0C;&#x8E29;&#x4E00;&#x811A;&#x6CB9;&#x95E8;&#x5F00;&#x59CB;&#x53D8;&#x901F;&#x3002;&#x8FD9;&#x5BF9;&#x4E8E;&#x6211;&#x8FD9;&#x79CD;&#x5355;&#x7EBF;&#x7A0B;&#x5DE5;&#x4F5C;&#x751F;&#x6D3B;&#x7684;&#x4EBA;&#x6765;&#x8BF4;&#x662F;&#x79CD;&#x6311;&#x6218;&#xFF0C;&#x5E38;&#x5E38;&#x5728;&#x5404;&#x4E2A;<code>deadline</code>&#x95F4;&#x75B2;&#x4E8E;&#x5954;&#x6CE2;&#xFF0C;&#x611F;&#x53D7;&#x4E0D;&#x5230;&#x90A3;&#x79CD;<code>&#x4ECE;&#x5BB9;</code>&#x3002;&#x5176;&#x6B21;&#x5B83;&#x5FFD;&#x7565;&#x4E86;&#x8FC7;&#x7A0B;&#xFF0C;&#x6CA1;&#x6709;&#x4E86;&#x5168;&#x7A0B;&#x53C2;&#x4E0E;&#x7ED9;&#x4E88;&#x7684;&#x4EAB;&#x53D7;&#x4F53;&#x9A8C;&#x3002;</p>
<p>&#x5177;&#x4F53;&#x5230;&#x81EA;&#x5DF1;&#x8EAB;&#x4E0A;&#xFF0C;&#x56E0;&#x4E3A;&#x6709;&#x4E9B;deadline&#x6CA1;&#x6709;&#x786E;&#x5B9A;&#x597D;&#xFF0C;&#x6240;&#x4EE5;&#x76F4;&#x63A5;&#x5FFD;&#x89C6;&#x6389;&#x3002;&#x4F8B;&#x5982;&#x73B0;&#x5728;&#x5904;&#x4E8E;&#x627E;&#x5DE5;&#x4F5C;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x7136;&#x800C;&#x6821;&#x62DB;&#x5FEB;&#x7ED3;&#x675F;&#x4E86;&#x8FD8;&#x6CA1;&#x6709;&#x51FA;&#x624B;&#xFF0C;&#x4E3B;&#x8981;&#x539F;&#x56E0;&#x662F;&#x4E0D;&#x6E05;&#x695A;<code>deadline</code>&#x662F;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#xFF0C;&#x603B;&#x662F;&#x89C9;&#x5F97;&#x65F6;&#x95F4;&#x8FD8;&#x6709;&#x5F88;&#x591A;&#xFF0C;&#x8FC7;&#x6BB5;&#x65F6;&#x95F4;&#x518D;&#x60F3;&#x4E5F;&#x6CA1;&#x4E8B;&#x3002;&#x54EA;&#x6015;&#x662F;&#x6709;&#x4EBA;&#x50AC;&#xFF0C;&#x8FD8;&#x662F;&#x6CA1;&#x6709;&#x52A8;&#x529B;&#x8DD1;&#x3002;<strong>&#x603B;&#x89C9;&#x5F97;&#x9752;&#x6625;&#x4E00;&#x5927;&#x628A;&#xFF0C;&#x5374;&#x6CA1;&#x6709;&#x8BA4;&#x8BC6;&#x5230;&#x9752;&#x6625;&#x662F;&#x6700;&#x4E0D;&#x80FD;&#x8F9C;&#x8D1F;&#x7684;</strong>&#x3002;</p>
<h3 id="&#x542F;&#x53D1;&#x5F0F;"><a href="#&#x542F;&#x53D1;&#x5F0F;" class="headerlink" title="&#x542F;&#x53D1;&#x5F0F;"></a>&#x542F;&#x53D1;&#x5F0F;</h3><p>&#x6211;&#x5728;&#x4EBA;&#x5DE5;&#x667A;&#x80FD;&#x9886;&#x57DF;&#x770B;&#x5230;&#x4E86;&#x4E0A;&#x9762;&#x95EE;&#x9898;&#x7684;&#x5F71;&#x5B50;&#xFF0C;&#x8BF4;&#x8FD9;&#x53E5;&#x8BDD;&#x4E0D;&#x662F;&#x60F3;&#x5439;&#x725B;&#x903C;&#xFF0C;&#x800C;&#x662F;&#x60F3;&#x8BF4;&#x6211;&#x5728;AI&#x7684;&#x63A5;&#x89E6;&#x4E2D;&#x4F53;&#x4F1A;&#x5230;&#x4E86;&#x540C;&#x6837;&#x6DF1;&#x6DF1;&#x7684;<code>&#x65E0;&#x529B;&#x611F;</code>&#x3002;&#x5728;AI&#x4E2D;&#x5F88;&#x591A;&#x95EE;&#x9898;&#x662F;&#x5B58;&#x5728;&#x7CBE;&#x786E;&#x89E3;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x9700;&#x8981;&#x7684;&#x65F6;&#x95F4;&#x6216;&#x7A7A;&#x95F4;&#x90FD;&#x662F;&#x8D85;&#x4E4E;&#x60F3;&#x8C61;&#x7684;&#xFF0C;&#x7531;&#x4E8E;&#x8017;&#x4E0D;&#x8D77;&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x80FD;&#x9000;&#x800C;&#x6C42;&#x5176;&#x6B21;&#x3002;&#x4F46;&#x662F;&#x600E;&#x6837;&#x4EE5;&#x5C0F;&#x7684;&#x4EE3;&#x4EF7;&#x903C;&#x8FD1;&#x7CBE;&#x786E;&#x89E3;&#x5462;&#xFF0C;&#x8FD9;&#x4E2A;&#x5F88;&#x96BE;&#x8BF4;&#xFF0C;&#x5176;&#x4E2D;&#x6709;&#x4E00;&#x79CD;&#x65B9;&#x6848;&#x5C31;&#x662F;&#x91C7;&#x7528;&#x542F;&#x53D1;&#x5F0F;&#x7684;&#x7B56;&#x7565;&#x3002;&#x5927;&#x81F4;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x8FD9;&#x4E2A;&#x65F6;&#x523B;&#x662F;&#x80AF;&#x5B9A;&#x4E0D;&#x77E5;&#x9053;&#x600E;&#x6837;&#x624D;&#x662F;<code>&#x5168;&#x5C40;&#x6700;&#x4F18;</code>&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x5F53;&#x524D;&#x7684;<code>&#x5C40;&#x90E8;&#x72B6;&#x6001;</code>&#x4FDD;&#x6301;&#x6700;&#x4F18;&#x7684;&#xFF0C;&#x7136;&#x540E;&#x7ED3;&#x5408;&#x5B9E;&#x9645;&#x4E0D;&#x65AD;&#x8C03;&#x6574;&#xFF0C;&#x5C3D;&#x91CF;&#x4F7F;&#x5F97;&#x5168;&#x5C40;&#x6700;&#x4F18;&#x3002;&#x4F46;&#x662F;&#x8FD9;&#x6837;&#x771F;&#x7684;&#x5F88;&#x9760;&#x8C31;&#x5417;&#xFF0C;&#x4E0D;&#x4E00;&#x5B9A;&#xFF0C;&#x5C31;&#x50CF;&#x722C;&#x4E00;&#x5EA7;&#x5C71;&#xFF0C;&#x60F3;&#x8981;&#x6700;&#x5FEB;&#x5730;&#x5230;&#x8FBE;&#x5C71;&#x9876;&#xFF0C;&#x4E8E;&#x662F;&#x627E;&#x6700;&#x9661;&#x5CED;&#x7684;&#x5730;&#x65B9;&#x722C;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x91CC;&#x662F;&#x5347;&#x7684;&#x6700;&#x5FEB;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x722C;&#x7740;&#x722C;&#x7740;&#xFF0C;&#x8D8A;&#x6765;&#x8D8A;&#x5E73;&#x7F13;&#xFF0C;&#x751A;&#x81F3;&#x6700;&#x7EC8;&#x5C31;&#x6210;&#x4E86;&#x5E73;&#x8DEF;&#x3002;&#x4E8E;&#x662F;&#x7AD9;&#x8D77;&#x8EAB;&#x60F3;&#x8981;&#x611F;&#x53F9;<code>&#x4E00;&#x89C8;&#x4F17;&#x5C71;&#x5C0F;</code>&#xFF0C;&#x7ED3;&#x679C;&#x53D1;&#x73B0;&#x81EA;&#x5DF1;&#x722C;&#x7684;&#x53EA;&#x662F;&#x4E2A;&#x5C0F;&#x571F;&#x5761;&#xFF0C;&#x771F;&#x6B63;&#x7684;&#x9AD8;&#x5C71;&#x5728;&#x8EAB;&#x65C1;&#x77D7;&#x7ACB;&#x7740;&#x3002;</p>
<p>&#x5C3D;&#x7BA1;&#x53EF;&#x4EE5;&#x5C3D;&#x53EF;&#x80FD;&#x907F;&#x514D;&#x51FA;&#x73B0;&#x8FD9;&#x79CD;&#x7A98;&#x5883;&#xFF0C;&#x4F46;&#x662F;&#x5373;&#x4FBF;&#x662F;&#x5F15;&#x5165;&#x968F;&#x673A;&#xFF0C;&#x4E5F;&#x8981;&#x4E0D;&#x65AD;&#x5C1D;&#x8BD5;&#xFF0C;&#x8FED;&#x4EE3;&#xFF0C;&#x8C03;&#x4F18;&#xFF0C;&#x8981;&#x91CD;&#x590D;&#x5F88;&#x591A;&#x6B21;&#x624D;&#x80FD;&#x627E;&#x5230;&#x6BD4;&#x8F83;&#x7406;&#x60F3;&#x7684;&#x6A21;&#x578B;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x751F;&#x6D3B;&#x4E0D;&#x662F;&#x8FD9;&#x6837;&#xFF0C;<strong>&#x751F;&#x6D3B;&#x4E2D;&#x6CA1;&#x6709;Retry&#x6309;&#x94AE;&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x80FD;&#x4E00;&#x6C14;&#x5475;&#x6210;</strong>&#x3002;</p>
<h3 id="&#x6B63;&#x9898;"><a href="#&#x6B63;&#x9898;" class="headerlink" title="&#x6B63;&#x9898;"></a>&#x6B63;&#x9898;</h3><p>&#x524D;&#x9762;&#x8BF4;&#x7684;&#x8C8C;&#x4F3C;&#x79BB;&#x9898;&#x4E86;&#xFF0C;&#x5176;&#x5B9E;&#x4E0D;&#x7136;&#x3002;&#x8EAB;&#x4E3A;&#x4E00;&#x4E2A;&#x5B66;&#x7269;&#x7406;&#x51FA;&#x8EAB;&#x7684;&#xFF0C;&#x6211;&#x59CB;&#x7EC8;&#x575A;&#x4FE1;&#xFF0C;<code>&#x4E07;&#x7269;&#x540C;&#x7406;</code>&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x518D;&#x6B21;&#x5C55;&#x793A;&#x4E0B;&#x6211;&#x7684;&#x903B;&#x8F91;&#x601D;&#x8FA8;&#x8FC7;&#x7A0B;&#x3002;</p>
<h4 id="&#x7B80;&#x8981;&#x56DE;&#x987E;"><a href="#&#x7B80;&#x8981;&#x56DE;&#x987E;" class="headerlink" title="&#x7B80;&#x8981;&#x56DE;&#x987E;"></a>&#x7B80;&#x8981;&#x56DE;&#x987E;</h4><p>&#x5BF9;&#x4E8E;&#x5F02;&#x6027;&#x7684;&#x597D;&#x611F;&#x662F;&#x4ECE;&#x5E7C;&#x513F;&#x56ED;&#x5F00;&#x59CB;&#x840C;&#x751F;&#x7684;&#xFF0C;&#x5F53;&#x65F6;&#x89C9;&#x5F97;&#x4E00;&#x4E2A;&#x5973;&#x5B69;&#x86EE;&#x6F02;&#x4EAE;&#xFF0C;&#x7136;&#x540E;&#x8FC7;&#x4E86;&#x6BB5;&#x65F6;&#x95F4;&#x89C9;&#x5F97;&#x81EA;&#x5DF1;&#x4E4B;&#x524D;&#x7684;&#x8BA4;&#x8BC6;&#x5B58;&#x5728;&#x95EE;&#x9898;&#x3002;&#x8FC7;&#x4E86;&#x6BB5;&#x65F6;&#x95F4;&#x51B3;&#x5B9A;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x5973;&#x5B69;&#x86EE;&#x4E0D;&#x9519;&#xFF0C;&#x518D;&#x8FC7;&#x6BB5;&#x65F6;&#x95F4;&#x89C9;&#x5F97;&#x5F88;&#x4E00;&#x822C;&#x3002;&#x5982;&#x6B64;&#x53CD;&#x590D;&#x51E0;&#x6B21;&#xFF0C;&#x6211;&#x5BF9;&#x81EA;&#x5DF1;&#x7684;&#x5BA1;&#x7F8E;&#x89C2;&#x5F7B;&#x5E95;&#x5931;&#x53BB;&#x4FE1;&#x5FC3;&#x3002;&#x8FD9;&#x79CD;&#x5BA1;&#x7F8E;&#x89C2;&#x7684;&#x81EA;&#x5351;&#x4F7F;&#x81EA;&#x5DF1;&#x4E00;&#x76F4;&#x5904;&#x4E8E;&#x89C2;&#x671B;&#x6001;&#x5EA6;&#xFF0C;&#x56E0;&#x4E3A;&#x6015;&#x9009;&#x62E9;&#x51FA;&#x9519;&#xFF0C;&#x6240;&#x4EE5;&#x4E00;&#x76F4;&#x6CA1;&#x6709;&#x9009;&#x62E9;&#x3002;&#x8FD9;&#x79CD;<code>&#x6697;&#x604B;</code>&#x7684;&#x65B9;&#x5F0F;&#x81F3;&#x5C11;&#x4ECE;&#x8868;&#x9762;&#x770B;&#x662F;&#x65E0;&#x5BB3;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x4E00;&#x76F4;&#x4F7F;&#x7528;&#x4E86;10&#x591A;&#x5E74;&#xFF0C;&#x76F4;&#x5230;&#x73B0;&#x5728;&#x3002;</p>
<p>&#x4E0A;&#x4E86;&#x5927;&#x5B66;&#x540E;&#x603B;&#x514D;&#x4E0D;&#x4E86;&#x88AB;&#x4EB2;&#x621A;&#x50AC;&#x7740;&#x627E;&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x800C;&#x6211;&#x90FD;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x7406;&#x7531;&#x642A;&#x585E;&#x8FC7;&#x53BB;&#x3002;&#x8EAB;&#x4E3A;&#x4E00;&#x540D;&#x7406;&#x79D1;&#x751F;&#x51FA;&#x8EAB;&#xFF0C;&#x6700;&#x4E0D;&#x7F3A;&#x7684;&#x5C31;&#x662F;&#x7406;&#x7531;&#x5566;&#x3002;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x7406;&#x7531;&#x4E0D;&#x5149;&#x7CCA;&#x5F04;&#x4E86;&#x522B;&#x4EBA;&#xFF0C;&#x4E5F;&#x7CCA;&#x5F04;&#x4E86;&#x81EA;&#x5DF1;&#xFF0C;&#x5B83;&#x7684;&#x5185;&#x5BB9;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;&#x201C;&#x6211;&#x89C9;&#x5F97;&#x8C08;&#x604B;&#x7231;&#x80AF;&#x5B9A;&#x8981;&#x5403;&#x5403;&#x996D;&#x3001;&#x51FA;&#x53BB;&#x73A9;&#x4E00;&#x73A9;&#x4EC0;&#x4E48;&#x7684;&#xFF0C;&#x800C;&#x8FD9;&#x4E9B;&#x662F;&#x9700;&#x8981;&#x94B1;&#x7684;&#x3002;&#x80AF;&#x5B9A;&#x4E0D;&#x80FD;&#x7528;&#x7236;&#x6BCD;&#x7684;&#x94B1;&#x6765;&#x626F;&#x8FD9;&#x4E9B;&#x6CA1;&#x7528;&#x7684;&#x4E8B;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x81EA;&#x5DF1;&#x6709;&#x7ECF;&#x6D4E;&#x6765;&#x6E90;&#x3002;&#x4F46;&#x662F;&#x6211;&#x54E5;&#x54E5;&#x544A;&#x8BEB;&#x6211;&#x4E0D;&#x8981;&#x56E0;&#x4E3A;&#x53BB;&#x6323;&#x773C;&#x524D;&#x7684;&#x5C0F;&#x94B1;&#x800C;&#x5931;&#x53BB;&#x4E86;&#x6323;&#x65E5;&#x540E;&#x5927;&#x94B1;&#x7684;&#x673A;&#x4F1A;&#xFF0C;&#x6211;&#x89C9;&#x5F97;&#x597D;&#x6709;&#x9053;&#x7406;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5C31;&#x4E0D;&#x4F1A;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x53BB;&#x53C2;&#x52A0;&#x52E4;&#x5DE5;&#x52A9;&#x5B66;&#x3001;&#x5F53;&#x5BB6;&#x6559;&#x4E86;&#x3002;&#x65E2;&#x7136;&#x8FD9;&#x6837;&#x5C31;&#x6CA1;&#x6709;&#x7ECF;&#x6D4E;&#x6765;&#x6E90;&#x4E86;&#xFF0C;&#x90A3;&#x5C31;&#x4E0D;&#x7528;&#x8C08;&#x604B;&#x7231;&#x4E86;&#x3002;&#x201D;&#x8FD9;&#x4E2A;&#x7406;&#x7531;&#x5F88;&#x7B80;&#x77ED;&#x6709;&#x529B;&#xFF0C;&#x6211;&#x81EA;&#x5DF1;&#x90FD;&#x4FE1;&#x4E86;&#x3002;&#x867D;&#x7136;&#x540E;&#x6765;&#x81EA;&#x5DF1;&#x53C2;&#x52A0;&#x8FC7;&#x52E4;&#x5DE5;&#x52A9;&#x5B66;&#x3001;&#x5F53;&#x8FC7;&#x82F1;&#x8BED;&#x5BB6;&#x6559;&#xFF0C;&#x7136;&#x800C;&#x6323;&#x7684;&#x94B1;&#x90FD;&#x5F53;&#x4F19;&#x98DF;&#x8D39;&#x5403;&#x6389;&#x4E86;&#xFF0C;&#x800C;&#x4E14;&#x89C9;&#x5F97;&#x5F88;&#x5408;&#x7406;&#x3002;</p>
<h4 id="&#x5410;&#x69FD;&#x90E8;&#x5206;"><a href="#&#x5410;&#x69FD;&#x90E8;&#x5206;" class="headerlink" title="&#x5410;&#x69FD;&#x90E8;&#x5206;"></a>&#x5410;&#x69FD;&#x90E8;&#x5206;</h4><ul>
<li>&#x6839;&#x636E;6&#x5EA6;&#x7A7A;&#x95F4;&#x7406;&#x8BBA;&#xFF0C;&#x4EFB;&#x4F55;&#x4E24;&#x4E2A;&#x4EBA;&#x60F3;&#x8981;&#x5EFA;&#x7ACB;&#x8054;&#x7CFB;&#x6700;&#x591A;&#x7ECF;&#x8FC7;6&#x4E2A;&#x4EBA;&#x5C31;&#x591F;&#x4E86;&#xFF0C;&#x540E;&#x6765;&#x8FD8;&#x6709;&#x4EBA;&#x8BC1;&#x5B9E;&#x4E86;&#x597D;&#x50CF;&#x53EA;&#x8981;5&#x4E2A;&#x4EBA;&#xFF1F;&#x8FD9;&#x5757;&#x8BB0;&#x4E0D;&#x592A;&#x6E05;&#x4E86;&#x3002;&#x603B;&#x4E4B;<strong>&#x60F3;&#x8981;&#x8FDB;&#x5165;&#x5230;&#x67D0;&#x4E2A;&#x793E;&#x4EA4;&#x5708;&#x5E76;&#x4E0D;&#x96BE;</strong>&#x3002;</li>
<li>&#x4EBA;&#x4E0E;&#x4EBA;&#x4E4B;&#x95F4;&#x7684;&#x60C5;&#x611F;&#x603B;&#x662F;&#x5EFA;&#x7ACB;&#x5728;&#x76F8;&#x5904;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;<code>&#x65E5;&#x4E45;&#x751F;&#x60C5;</code>&#x4E86;&#x3002;&#x5BF9;&#x4E8E;&#x8FD9;&#x79CD;&#x73B0;&#x8C61;&#x7406;&#x89E3;&#x8D77;&#x6765;&#x5C31;&#x6BD4;&#x8F83;&#x591A;&#x5143;&#x5316;&#x4E86;&#xFF0C;&#x76F4;&#x89C2;&#x5730;&#x611F;&#x89C9;&#x8FD9;&#x4E0D;&#x5C31;&#x662F;&#x4E00;&#x53E5;&#x5E9F;&#x8BDD;&#x5417;&#xFF1B;&#x5FC3;&#x673A;&#x4E00;&#x4E9B;&#x7684;&#x7406;&#x89E3;&#x662F;&#x60F3;&#x8981;&#x548C;&#x4E00;&#x4E2A;&#x4EBA;&#x4EA7;&#x751F;&#x611F;&#x60C5;&#xFF0C;   &#x53EA;&#x8981;&#x9002;&#x5F53;&#x5730;&#x591A;&#x63A5;&#x89E6;&#xFF0C;&#x6700;&#x7EC8;&#x6210;&#x4E3A;TA&#x751F;&#x6D3B;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x5C31;&#x81EA;&#x7136;&#x800C;&#x7136;&#x6210;&#x529F;&#x4E86;&#x3002;</li>
<li>&#x672A;&#x6765;&#x662F;&#x4E0D;&#x786E;&#x5B9A;&#x7684;&#xFF0C;&#x8FD9;&#x662F;&#x7F8E;&#x597D;&#x4E5F;&#x662F;&#x6B8B;&#x9177;&#x7684;&#x5730;&#x65B9;&#x3002;&#x5BF9;&#x4E8E;&#x672A;&#x6765;&#x7684;&#x671F;&#x5F85;&#x53EF;&#x80FD;&#x662F;&#x51FA;&#x4E8E;&#x5BF9;&#x73B0;&#x72B6;&#x7684;&#x4E0D;&#x6EE1;&#x548C;&#x4E0D;&#x7518;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x53EA;&#x662F;&#x5355;&#x7EAF;&#x7684;&#x671F;&#x5F85;&#x3002;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x671F;&#x5F85;&#x6700;&#x7EC8;&#x4F1A;&#x6210;&#x4EC0;&#x4E48;&#x6837;&#x5B50;&#xFF0C;&#x8FD9;&#x4E2A;&#x8C01;&#x90FD;&#x8BF4;&#x4E0D;&#x51C6;&#x3002;&#x5177;&#x4F53;&#x5230;&#x672C;&#x6587;&#x7684;&#x4E3B;&#x65E8;&#xFF0C;&#x672A;&#x6765;&#x4F1A;&#x9047;&#x5230;&#x4EC0;&#x4E48;&#x4EBA;&#x662F;&#x5145;&#x6EE1;&#x672A;&#x77E5;&#x7684;&#x3002;&#x6211;&#x66FE;&#x4E3A;&#x300A;&#x5047;&#x5982;&#x7231;&#x6709;&#x5929;&#x610F;&#x300B;&#x300A;&#x6211;&#x8111;&#x4E2D;&#x7684;&#x6A61;&#x76AE;&#x64E6;&#x300B;&#x8FD9;&#x79CD;&#x523B;&#x9AA8;&#x94ED;&#x5FC3;&#x7684;&#x7231;&#x800C;&#x611F;&#x52A8;&#xFF0C;&#x867D;&#x7136;&#x6211;&#x66F4;&#x591A;&#x5728;&#x5F71;&#x89C6;&#x5267;&#x4E2D;&#x770B;&#x5230;&#xFF1B;&#x4E5F;&#x66FE;&#x4E3A;&#x89C1;&#x5230;&#x5F88;&#x591A;&#x5E74;&#x8FD1;&#x800C;&#x7ACB;&#x4E4B;&#x5E74;&#x7684;&#x9AD8;&#x6821;&#x8001;&#x5E08;&#x6025;&#x4E8E;&#x7ED3;&#x5A5A;&#x800C;&#x53C2;&#x4E0E;&#x5230;&#x5404;&#x79CD;&#x76F8;&#x4EB2;&#x4EA4;&#x53CB;&#x6D3B;&#x52A8;&#x800C;&#x550F;&#x5618;&#xFF0C;&#x867D;&#x7136;&#x8FD9;&#x4E00;&#x5E55;&#x5728;&#x751F;&#x6D3B;&#x4E2D;&#x5E38;&#x5E38;&#x770B;&#x5230;&#x3002;&#x91CF;&#x5B50;&#x529B;&#x5B66;&#x544A;&#x8BC9;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x9884;&#x6D4B;&#x5230;&#x672A;&#x6765;&#x662F;&#x4E0D;&#x53EF;&#x80FD;&#x7684;&#xFF0C;&#x5B9E;&#x9645;&#x72B6;&#x6001;&#x4F1A;&#x5728;&#x4E34;&#x8FD1;&#x771F;&#x76F8;&#x7684;&#x90A3;&#x4E00;&#x79D2;&#x77AC;&#x95F4;<code>&#x584C;&#x7F29;</code>&#x3002;   </li>
</ul>
<p>&#x7EFC;&#x4E0A;&#xFF0C;&#x65E0;&#x8BBA;&#x662F;&#x76F8;&#x8BC6;&#x76F8;&#x7231;&#xFF0C;&#x6216;&#x662F;&#x8C08;&#x5A5A;&#x8BBA;&#x5AC1;&#xFF0C;&#x90FD;&#x662F;&#x5728;&#x81EA;&#x5DF1;&#x7684;&#x4E00;&#x4E2A;&#x5C0F;&#x5708;&#x5B50;&#x4E2D;&#x505A;&#x51FA;&#x9009;&#x62E9;&#x7684;&#x3002;&#x8FD9;&#x4E2A;&#x5708;&#x5B50;&#x662F;&#x52A8;&#x6001;&#x53D8;&#x5316;&#xFF0C;&#x53EF;&#x4EE5;&#x60F3;&#x8C61;&#x6210;&#x94B1;&#x949F;&#x4E66;&#x5148;&#x751F;&#x8BF4;&#x7684;&#x201C;&#x56F4;&#x57CE;&#x201D;&#x3002;&#x81EA;&#x5DF1;&#x7A76;&#x7ADF;&#x4F1A;&#x9009;&#x62E9;&#x54EA;&#x4E00;&#x4E2A;&#x76F8;&#x4F34;&#x7EC8;&#x751F;&#xFF0C;&#x53D6;&#x51B3;&#x4E8E;&#x505A;&#x51FA;&#x9009;&#x62E9;&#x90A3;&#x4E00;&#x523B;&#x5708;&#x5B50;&#x91CC;&#x7684;&#x4EBA;&#x3002;&#x65E0;&#x8BBA;&#x662F;&#x9009;&#x62E9;&#x7B49;&#x5F85;&#x8FD8;&#x662F;&#x9009;&#x62E9;&#x6269;&#x5927;&#x5708;&#x5B50;&#xFF0C;&#x65E0;&#x975E;&#x90FD;&#x662F;&#x60F3;&#x5728;&#x4E00;&#x4E2A;&#x9002;&#x5F53;&#x7684;&#x65F6;&#x673A;&#x5728;&#x5408;&#x7406;&#x7684;&#x5708;&#x5B50;&#x4E2D;&#x505A;&#x51FA;&#x5408;&#x7406;&#x7684;&#x9009;&#x62E9;&#x3002;&#x4F46;&#x662F;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x7B97;&#x5408;&#x7406;&#x5462;&#xFF0C;&#x8FD9;&#x4E2A;&#x8C01;&#x77E5;&#x9053;&#x5462;&#x3002;&#x53EF;&#x80FD;&#x5728;&#x611F;&#x89C9;&#x5FC3;&#x6EE1;&#x610F;&#x8DB3;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x80FD;&#x5728;&#x611F;&#x89C9;&#x8EAB;&#x5FC3;&#x4FF1;&#x75B2;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x80FD;&#x5728;&#x8FEB;&#x4E8E;&#x8EAB;&#x8FB9;&#x538B;&#x529B;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x653E;&#x5F03;&#x4E86;&#x7B49;&#x5F85;&#xFF0C;&#x505A;&#x51FA;&#x4E86;&#x9009;&#x62E9;&#xFF0C;&#x4E8E;&#x662F;&#x8BF8;&#x591A;&#x4E0D;&#x786E;&#x5B9A;&#x7684;&#x4E1C;&#x897F;&#x77AC;&#x95F4;&#x786E;&#x5B9A;&#x4E86;&#x3002;&#x6B64;&#x65F6;&#x7684;&#x7231;&#x60C5;&#x5C31;&#x50CF;<code>&#x859B;&#x5B9A;&#x8C14;&#x7684;&#x732B;</code>&#xFF0C;&#x4EFB;&#x4F55;&#x63E3;&#x6D4B;&#x90FD;&#x662F;&#x5F92;&#x52B3;&#x7684;&#xFF0C;&#x6253;&#x5F00;&#x76D2;&#x5B50;&#x7684;&#x4E00;&#x5239;&#x90A3;&#xFF0C;&#x662F;&#x751F;&#x662F;&#x6B7B;&#x4E00;&#x76EE;&#x4E86;&#x7136;&#x3002;</p>
<h4 id="&#x601D;&#x8003;"><a href="#&#x601D;&#x8003;" class="headerlink" title="&#x601D;&#x8003;"></a>&#x601D;&#x8003;</h4><p>&#x4F46;&#x662F;&#x77E5;&#x9053;&#x4E86;&#x771F;&#x76F8;&#x540E;&#x4F1A;&#x600E;&#x6837;&#x5462;&#xFF1F;&#x4E0D;&#x77E5;&#x9053;&#xFF0C;&#x4E0D;&#x778E;&#x8BF4;&#x4E86;&#x3002;</p>
<h4 id="&#x7231;&#x60C5;&#x89C2;"><a href="#&#x7231;&#x60C5;&#x89C2;" class="headerlink" title="&#x7231;&#x60C5;&#x89C2;"></a>&#x7231;&#x60C5;&#x89C2;</h4><p>&#x7231;&#x60C5;&#x89C2;&#xFF0C;&#x62E9;&#x5076;&#x89C2;&#xFF0C;&#x5728;&#x6211;&#x770B;&#x6765;&#x57FA;&#x672C;&#x7B49;&#x540C;&#x3002;&#x8FD8;&#x662F;&#x90A3;&#x53E5;&#x8BDD;&#xFF0C;<strong>&#x4E07;&#x4E8B;&#x4E07;&#x7269;&#x7686;&#x540C;&#x7406;</strong>&#x3002;</p>
<ul>
<li>&#x9996;&#x5148;&#x6211;&#x7ED9;&#x81EA;&#x5DF1;&#x8BBE;&#x5B9A;&#x4E86;<code>deadline</code>&#xFF0C;&#x4E0D;&#x7BA1;&#x662F;&#x51FA;&#x4E8E;&#x5BF9;&#x81EA;&#x5DF1;&#x3001;&#x5BB6;&#x4EBA;&#x7684;&#x8D1F;&#x8D23;&#xFF0C;&#x8FD8;&#x662F;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x7F13;&#x5175;&#x4E4B;&#x8BA1;&#xFF0C;<code>deadline</code>&#x90FD;&#x662F;&#x4E0D;&#x53EF;&#x6216;&#x7F3A;&#x7684;&#x3002;&#x6211;&#x5C06;28&#x5C81;&#x4F5C;&#x4E3A;&#x7ED3;&#x5A5A;&#x7684;<code>deadline</code>&#xFF0C;&#x90A3;&#x4E48;&#x5411;&#x524D;&#x5012;&#x63A8;2&#x3001;3&#x5E74;&#xFF0C;&#x5C31;&#x662F;&#x604B;&#x7231;&#x5F00;&#x59CB;&#x7684;&#x65F6;&#x95F4;&#x3002;<br>&#x9664;&#x975E;&#x81EA;&#x5DF1;&#x5728;28&#x5C81;&#x5DE6;&#x53F3;&#x4E8B;&#x4E1A;&#x3001;&#x751F;&#x6D3B;&#x4E2D;&#x6709;&#x5F88;&#x5927;&#x6CE2;&#x52A8;&#xFF0C;&#x5426;&#x5219;&#x8FD9;&#x4E2A;<code>deadline</code>&#x8FD8;&#x662F;&#x5F88;&#x9760;&#x8C31;&#x3001;&#x5F88;&#x7A33;&#x5B9A;&#x7684;&#x3002;</li>
<li>&#x5176;&#x6B21;&#x6211;&#x5728;&#x627E;&#x5BFB;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F7F;&#x7528;&#x542F;&#x53D1;&#x5F0F;&#x7684;&#x539F;&#x5219;&#xFF0C;&#x5728;<code>best case</code> &#x548C; <code>worst case</code> &#x4E4B;&#x95F4;&#x505A;&#x51FA;&#x51B3;&#x7B56;&#x3002;&#x51B3;&#x7B56;&#x4F9D;&#x636E;&#x662F;&#x548C;&#x81EA;&#x5DF1;&#x7684;<code>&#x5951;&#x5408;</code>&#x7A0B;&#x5EA6;&#xFF0C;&#x8FD9;&#x4E2A;&#x6CA1;&#x529E;&#x6CD5;&#x91CF;&#x5316;&#xFF0C;&#x53EA;&#x53EF;&#x610F;&#x4F1A;&#x3002;</li>
</ul>
<h3 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h3><p>&#x65E0;&#x8BBA;&#x662F;&#x7231;&#x60C5;&#x3001;&#x751F;&#x6D3B;&#xFF0C;&#x7B49;&#x5F85;&#x90FD;&#x662F;&#x6574;&#x4E2A;&#x73AF;&#x8282;&#x4E2D;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x3002;&#x4F46;&#x662F;&#x65E0;&#x8BBA;&#x9009;&#x62E9;&#x600E;&#x6837;&#x7684;&#x51FA;&#x884C;&#x65B9;&#x5F0F;&#xFF0C;&#x6700;&#x8981;&#x7D27;&#x7684;&#x662F;<code>&#x5C3D;&#x5FEB;&#x4E0A;&#x8DEF;</code>&#xFF0C;&#x522B;&#x78E8;&#x8E6D;&#x3002;&#x8282;&#x594F;&#x8DEF;&#x4E0A;&#x627E;&#xFF0C;&#x98CE;&#x666F;&#x8DEF;&#x4E0A;&#x770B;&#xFF0C;&#x81F3;&#x4E8E;&#x4F55;&#x65F6;&#x9047;&#x5230;&#x4F55;&#x4EBA;&#x4F55;&#x65F6;&#xFF0C;&#x770B;&#x81EA;&#x5DF1;&#xFF0C;&#x4E5F;&#x770B;&#x522B;&#x4EBA;&#x3002;&#x4E00;&#x5207;&#x968F;&#x7F18;&#x53C8;&#x975E;&#x7F18;&#x3002;</p>
<p>&#x5199;&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x51B3;&#x5B9A;&#x628A;&#x5DE5;&#x4F5C;&#x627E;&#x4E86;&#x5148;&#x3002;</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/杂谈/">杂谈</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/爱情/">爱情</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-hexo-deploy-problem" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/29/hexo-deploy-problem/" class="article-date">
      <time datetime="2016-05-29T03:07:07.310Z" itemprop="datePublished">2016-05-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/hexo-deploy-problem/">hexo deploy时提示权限不够的问题</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>&#x4EE5;&#x524D;&#x6309;&#x7167;&#x7F51;&#x4E0A;&#x7684;&#x6559;&#x7A0B;&#x751F;&#x6210;&#x8FC7;ssh&#x7684;key&#xFF0C;&#x5E76;&#x4E14;&#x4E0A;&#x4F20;&#x5230;&#x4E86;coding.net&#x7684;&#x7F51;&#x7AD9;&#x4E0A;&#xFF0C;&#x539F;&#x4EE5;&#x4E3A;&#x8FD9;&#x6837;&#x5C31;&#x4E00;&#x52B3;&#x6C38;&#x9038;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x6BCF;&#x6B21;&#x91CD;&#x65B0;&#x6253;&#x5F00;git shell &#x90E8;&#x7F72;&#x535A;&#x5BA2;&#x65F6;&#x603B;&#x662F;&#x63D0;&#x793A;permission denied&#x3002;&#x4E0B;&#x9762;&#x662F;&#x89E3;&#x51B3;&#x529E;&#x6CD5;&#x3002;</p>
<p><strong>&#x6CE8;&#x610F;</strong>&#xFF1A;&#x524D;&#x63D0;&#x662F;&#x5DF2;&#x7ECF;&#x4F7F;&#x7528;ssh-keygen&#x751F;&#x6210;&#x8FC7;key&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#xFF0C;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x7C7B;&#x4F3C;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x751F;&#x6210;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;wenqiang_china@126.com&quot;</span><br></pre></td></tr></table></figure></p>
<p>&#x751F;&#x6210;&#x7684;key&#x4F1A;&#x5728;.ssh&#x6587;&#x4EF6;&#x5939;&#x4E2D;&#x3002;<br>&#x751F;&#x6210;&#x5B8C;&#x4EE5;&#x540E;&#x8981;&#x5C06;.ssh&#x6587;&#x4EF6;&#x5939;&#x4E2D;&#x7684;id_rsa.pub&#x6587;&#x4EF6;&#x590D;&#x5236;&#x540E;&#x63D0;&#x4EA4;&#x5230;github.com&#x4E0A;&#xFF0C;&#x7136;&#x540E;&#x8F93;&#x5165;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x9A8C;&#x8BC1;&#x662F;&#x5426;&#x63D0;&#x4EA4;&#x6210;&#x529F;&#x3002;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure></p>
<p>&#x4E0A;&#x8FF0;&#x8FC7;&#x7A0B;&#x4E0D;&#x8BE6;&#x7EC6;&#x8BF4;&#x4E86;&#xFF0C;&#x7F51;&#x4E0A;&#x6559;&#x7A0B;&#x5F88;&#x591A;&#x3002;</p>
<h3 id="&#x6B63;&#x6587;"><a href="#&#x6B63;&#x6587;" class="headerlink" title="&#x6B63;&#x6587;"></a>&#x6B63;&#x6587;</h3><p>&#x5F53;&#x4E0B;&#x6B21;&#x6267;&#x884C;hexo d&#x65F6;&#x63D0;&#x793A;&#x5982;&#x4E0B;&#x9519;&#x8BEF;&#x4FE1;&#x606F;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Permission denied (publickey).</span><br><span class="line">fatal: Could not read from remote repository.</span><br><span class="line"></span><br><span class="line">Please make sure you have the correct access rights</span><br><span class="line">and the repository exists.</span><br></pre></td></tr></table></figure></p>
<p>&#x6B64;&#x65F6;&#x6267;&#x884C;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x6DFB;&#x52A0;key<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -add ~/.ssh/id_rsa</span><br></pre></td></tr></table></figure></p>
<p>&#x4E4B;&#x540E;&#x6267;&#x884C;hexo d&#x5C31;&#x53EF;&#x4EE5;&#x6210;&#x529F;&#x90E8;&#x7F72;&#x4E86;&#x3002;</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/hexo/">hexo</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/">hexo</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-python-flask-experience" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/29/python-flask-experience/" class="article-date">
      <time datetime="2016-05-29T02:17:10.988Z" itemprop="datePublished">2016-05-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/python-flask-experience/">Python flask使用经验教训总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h3><p>&#x8FD9;&#x6BB5;&#x65F6;&#x95F4;&#x5F00;&#x59CB;&#x63A5;&#x89E6;flask&#xFF0C;&#x4E2D;&#x95F4;&#x9047;&#x5230;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x4E5F;&#x8D70;&#x8FC7;&#x5199;&#x5F2F;&#x8DEF;&#xFF0C;&#x672C;&#x7247;&#x535A;&#x5BA2;&#x7528;&#x6765;&#x8BF4;&#x660E;&#x4E0B;&#x81EA;&#x5DF1;&#x8FD9;&#x6BB5;&#x65F6;&#x95F4;&#x5185;&#x8E29;&#x7684;&#x5751;&#x3002;</p>
<h3 id="&#x6B63;&#x6587;"><a href="#&#x6B63;&#x6587;" class="headerlink" title="&#x6B63;&#x6587;"></a>&#x6B63;&#x6587;</h3><h4 id="&#x95EE;&#x9898;&#x4E00;&#xFF1A;&#x5728;&#x4F7F;&#x7528;SQLAlchemy&#x7BA1;&#x7406;MySQL&#x6570;&#x636E;&#x5E93;&#x65F6;&#xFF0C;&#x521B;&#x5EFA;db&#x5B9E;&#x4F8B;&#x65F6;&#x62A5;&#x9519;&#xFF0C;&#x63D0;&#x793A;Import-MySQLdb&#x51FA;&#x9519;"><a href="#&#x95EE;&#x9898;&#x4E00;&#xFF1A;&#x5728;&#x4F7F;&#x7528;SQLAlchemy&#x7BA1;&#x7406;MySQL&#x6570;&#x636E;&#x5E93;&#x65F6;&#xFF0C;&#x521B;&#x5EFA;db&#x5B9E;&#x4F8B;&#x65F6;&#x62A5;&#x9519;&#xFF0C;&#x63D0;&#x793A;Import-MySQLdb&#x51FA;&#x9519;" class="headerlink" title="&#x95EE;&#x9898;&#x4E00;&#xFF1A;&#x5728;&#x4F7F;&#x7528;SQLAlchemy&#x7BA1;&#x7406;MySQL&#x6570;&#x636E;&#x5E93;&#x65F6;&#xFF0C;&#x521B;&#x5EFA;db&#x5B9E;&#x4F8B;&#x65F6;&#x62A5;&#x9519;&#xFF0C;&#x63D0;&#x793A;Import MySQLdb&#x51FA;&#x9519;"></a>&#x95EE;&#x9898;&#x4E00;&#xFF1A;&#x5728;&#x4F7F;&#x7528;SQLAlchemy&#x7BA1;&#x7406;MySQL&#x6570;&#x636E;&#x5E93;&#x65F6;&#xFF0C;&#x521B;&#x5EFA;db&#x5B9E;&#x4F8B;&#x65F6;&#x62A5;&#x9519;&#xFF0C;&#x63D0;&#x793A;Import MySQLdb&#x51FA;&#x9519;</h4><p>&#x8981;&#x8BF4;&#x660E;&#x7684;&#x662F;&#xFF0C;&#x5728;&#x4F7F;&#x7528;SQLAlchemy&#x65F6;&#xFF0C;&#x8981;&#x5148;&#x5B89;&#x88C5;&#x597D;MySQL&#x6570;&#x636E;&#x5E93;&#x548C;MySQLdb&#xFF0C;&#x56E0;&#x4E3A;SQLAlchemy&#x4F1A;&#x8C03;&#x7528;MySQLdb&#x6A21;&#x5757;&#x3002;Windows&#x4E0B;&#x5B89;&#x88C5;MySQLdb&#x6A21;&#x5757;&#x53EF;&#x4EE5;&#x770B;&#x4E00;&#x770B;<a href="http://blog.csdn.net/wklken/article/details/7253245" target="_blank" rel="external">&#x8FD9;&#x7BC7;&#x535A;&#x5BA2;</a>&#xFF0C;&#x5982;&#x679C;&#x662F;linux&#x4E0B;&#x5B89;&#x88C5;&#x5219;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x6211;&#x7684;<a href="../../../04/28/mysqldb-install/">&#x8FD9;&#x7BC7;&#x535A;&#x5BA2;</a>&#x3002;</p>
<h4 id="&#x95EE;&#x9898;&#x4E8C;&#xFF1A;&#x540C;&#x6837;&#x5728;&#x4F7F;&#x7528;SQLAlchemy&#x65F6;&#xFF0C;&#x6267;&#x884C;db-create-all-&#x521B;&#x5EFA;&#x6570;&#x636E;&#x8868;&#x65F6;&#x63D0;&#x793A;OperationalError-mysql-exceptions-OperationalError-1045-&#x201C;Access-denied-for-user-&#x2018;ODBC&#x2019;-&#x2019;localhost&#x2019;-using-password-NO-&#x201D;"><a href="#&#x95EE;&#x9898;&#x4E8C;&#xFF1A;&#x540C;&#x6837;&#x5728;&#x4F7F;&#x7528;SQLAlchemy&#x65F6;&#xFF0C;&#x6267;&#x884C;db-create-all-&#x521B;&#x5EFA;&#x6570;&#x636E;&#x8868;&#x65F6;&#x63D0;&#x793A;OperationalError-mysql-exceptions-OperationalError-1045-&#x201C;Access-denied-for-user-&#x2018;ODBC&#x2019;-&#x2019;localhost&#x2019;-using-password-NO-&#x201D;" class="headerlink" title="&#x95EE;&#x9898;&#x4E8C;&#xFF1A;&#x540C;&#x6837;&#x5728;&#x4F7F;&#x7528;SQLAlchemy&#x65F6;&#xFF0C;&#x6267;&#x884C;db.create_all()&#x521B;&#x5EFA;&#x6570;&#x636E;&#x8868;&#x65F6;&#x63D0;&#x793A;OperationalError: (_mysql_exceptions.OperationalError) (1045, &#x201C;Access denied for user &#x2018;ODBC&#x2019;@&#x2019;localhost&#x2019; (using password: NO)&#x201D;)"></a>&#x95EE;&#x9898;&#x4E8C;&#xFF1A;&#x540C;&#x6837;&#x5728;&#x4F7F;&#x7528;SQLAlchemy&#x65F6;&#xFF0C;&#x6267;&#x884C;db.create_all()&#x521B;&#x5EFA;&#x6570;&#x636E;&#x8868;&#x65F6;&#x63D0;&#x793A;OperationalError: (_mysql_exceptions.OperationalError) (1045, &#x201C;Access denied for user &#x2018;ODBC&#x2019;@&#x2019;localhost&#x2019; (using password: NO)&#x201D;)</h4><p>&#x5206;&#x6790;&#xFF0C;&#x6743;&#x9650;&#x4E0D;&#x591F;&#xFF0C;&#x6CA1;&#x6709;&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7ED9;&#x6240;&#x64CD;&#x4F5C;&#x7684;&#x6570;&#x636E;&#x5E93;&#x6388;&#x6743;&#x3002;<br>&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x7C7B;&#x4F3C;&#x4E0B;&#x9762;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x4F8B;&#x5982;&#x6570;&#x636E;&#x5E93;&#x540D;&#x4E3A;test,&#x5219;&#x6388;&#x6743;&#x8BED;&#x53E5;&#x4E3A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grant select ,insert,update,delete,lock tables on test.* to username@localhost identified by &apos;password&apos;;</span><br></pre></td></tr></table></figure></p>
<p>&#x4E0A;&#x9762;&#x7684;username&#x5904;&#x586B;&#x5199;&#x81EA;&#x5DF1;&#x7684;&#x7528;&#x6237;&#x540D;&#xFF0C;password&#x5904;&#x586B;&#x5199;&#x81EA;&#x5DF1;&#x8FDE;&#x63A5;&#x65F6;&#x7684;&#x5BC6;&#x7801;&#x3002;</p>
<h4 id="&#x95EE;&#x9898;&#x4E09;&#xFF1A;&#x4F7F;&#x7528;SQLAlchemy&#x65F6;&#xFF0C;&#x6267;&#x884C;db-create-all-&#x65F6;&#x51FA;&#x9519;&#xFF0C;&#x63D0;&#x793A;&#xFF1A;OperationalError-mysql-exceptions-OperationalError-1049-&#x201C;Unknown-database-&#x2018;flasky&#x2019;&#x201D;"><a href="#&#x95EE;&#x9898;&#x4E09;&#xFF1A;&#x4F7F;&#x7528;SQLAlchemy&#x65F6;&#xFF0C;&#x6267;&#x884C;db-create-all-&#x65F6;&#x51FA;&#x9519;&#xFF0C;&#x63D0;&#x793A;&#xFF1A;OperationalError-mysql-exceptions-OperationalError-1049-&#x201C;Unknown-database-&#x2018;flasky&#x2019;&#x201D;" class="headerlink" title="&#x95EE;&#x9898;&#x4E09;&#xFF1A;&#x4F7F;&#x7528;SQLAlchemy&#x65F6;&#xFF0C;&#x6267;&#x884C;db.create_all()&#x65F6;&#x51FA;&#x9519;&#xFF0C;&#x63D0;&#x793A;&#xFF1A;OperationalError: (_mysql_exceptions.OperationalError) (1049, &#x201C;Unknown database &#x2018;flasky&#x2019;&#x201D;)"></a>&#x95EE;&#x9898;&#x4E09;&#xFF1A;&#x4F7F;&#x7528;SQLAlchemy&#x65F6;&#xFF0C;&#x6267;&#x884C;db.create_all()&#x65F6;&#x51FA;&#x9519;&#xFF0C;&#x63D0;&#x793A;&#xFF1A;OperationalError: (_mysql_exceptions.OperationalError) (1049, &#x201C;Unknown database &#x2018;flasky&#x2019;&#x201D;)</h4><p>&#x5206;&#x6790;&#xFF1A;&#x9519;&#x8BEF;&#x63D0;&#x793A;&#x672A;&#x77E5;&#x6570;&#x636E;&#x5E93;&#x201D;flasky&#x201D;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;MySQL&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x8FD9;&#x4E2A;&#x540D;&#x4E3A;flasky&#x7684;&#x6570;&#x636E;&#x5E93;&#x6839;&#x672C;&#x4E0D;&#x5B58;&#x5728;&#x3002;&#x6CE8;&#x610F;&#xFF0C;&#x8FDB;&#x884C;&#x521B;&#x5EFA;&#x8868;&#x64CD;&#x4F5C;&#x524D;&#xFF0C;&#x5FC5;&#x987B;&#x4FDD;&#x8BC1;&#x9996;&#x5148;&#x6240;&#x9700;&#x7684;&#x6570;&#x636E;&#x5E93;&#x5DF2;&#x7ECF;&#x5728;MySQL&#x4E2D;&#x521B;&#x5EFA;&#x597D;&#x3002;&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x7684;&#x540D;&#x5B57;&#x5728;&#x521B;&#x5EFA;flask&#x5E94;&#x7528;&#x65F6;&#x8BBE;&#x7F6E;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.config[<span class="string">&apos;SQLALCHEMY_DATABASE_URI&apos;</span>]=<span class="string">&apos;mysql://root:root@localhost/flasky&apos;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x4E0A;&#x9762;&#x6700;&#x540E;&#x7684;flasky&#x5C31;&#x662F;&#x6240;&#x7528;&#x7684;&#x6570;&#x636E;&#x5E93;&#x7684;&#x540D;&#x5B57;&#xFF0C;&#x8FD9;&#x4E2A;&#x8981;&#x5728;MySQL&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x5EFA;&#x597D;&#x3002;<br>&#x6240;&#x4EE5;&#xFF0C;<strong>&#x5408;&#x7406;&#x7684;&#x987A;&#x5E8F;&#x662F;&#xFF1A;&#x9996;&#x5148;&#x5728;MySQL&#x4E2D;&#x521B;&#x5EFA;&#x597D;flasky&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x7136;&#x540E;&#x6388;&#x6743;&#xFF0C;&#x518D;&#x4E4B;&#x540E;&#x5728;flask&#x5E94;&#x7528;&#x4E2D;&#x5B9A;&#x4E49;&#x7C7B;&#x578B;&#xFF0C;&#x5E76;&#x521B;&#x5EFA;&#x6570;&#x636E;&#x8868;</strong><br>&#x4E0A;&#x8FF0;&#x8FC7;&#x7A0B;&#x7C7B;&#x4F3C;&#x5982;&#x4E0B;&#x64CD;&#x4F5C;&#xFF1A;</p>
<ul>
<li><p>&#x9996;&#x5148;&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x5B9A;&#x4E49;&#x6570;&#x636E;&#x5E93;&#x5E76;&#x6388;&#x6743;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create database flasky;</span><br><span class="line">grant select,insert,update,delete,lock tables on flasky.* to username@localhost identified by &apos;password&apos;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>&#x63A5;&#x4E0B;&#x6765;&#x5728;flask&#x4EE3;&#x7801;&#x4E2D;&#x5B9A;&#x4E49;ORM&#xFF0C;&#x521B;&#x5EFA;SQLAlchemy&#x5B9E;&#x4F8B;&#x5E76;&#x5728;&#x5FC5;&#x8981;&#x7684;&#x65F6;&#x5019;&#x4F7F;&#x7528;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask.ext.sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"></span><br><span class="line">app=Flask(__name__)</span><br><span class="line">app.config[<span class="string">&apos;SQLALCHEMY_DATABASE_URI&apos;</span>]=<span class="string">&apos;mysql://username:password@localhost/flasky&apos;</span> <span class="comment">#&#x4F7F;&#x7528;MySQLdb&#x6570;&#x636E;&#x5E93;</span></span><br><span class="line">app.config[<span class="string">&apos;SQLALCHEMY_COMMIT_ON_TEARDOWN&apos;</span>]=<span class="keyword">True</span> <span class="comment">#&#x8BBE;&#x7F6E;&#x4E3A;&#x81EA;&#x52A8;&#x63D0;&#x4EA4;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x4E0B;&#x9762;&#x5B9A;&#x4E49;&#x4E24;&#x4E2A;&#x6570;&#x636E;&#x8868;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Role</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__=<span class="string">&apos;roles&apos;</span></span><br><span class="line">    id=db.Column(db.Integer,primary_key=<span class="keyword">True</span>)</span><br><span class="line">    name=db.Column(db.String(<span class="number">64</span>),unique=<span class="keyword">True</span>)</span><br><span class="line">    users=db.relationship(<span class="string">&quot;User&quot;</span>,backref=<span class="string">&quot;role&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&apos;&lt;Role %r&gt;&apos;</span>%self.name</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__=<span class="string">&quot;users&quot;</span></span><br><span class="line">    id=db.Column(db.Integer,primary_key=<span class="keyword">True</span>)</span><br><span class="line">    username=db.Column(db.String(<span class="number">64</span>),unique=<span class="keyword">True</span>,index=<span class="keyword">True</span>)</span><br><span class="line">    role_id=db.Column(db.Integer,db.ForeignKey(<span class="string">&apos;roles.id&apos;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&apos;&lt;User %r&gt;&apos;</span>%self.username</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x5728;python shell&#x4E0B;&#x6267;&#x884C;db.create_all()&#x65B9;&#x6CD5;&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x521B;&#x5EFA;&#x4E24;&#x4E2A;&#x6570;&#x636E;&#x8868;&#x3002;</p>
<h4 id="&#x95EE;&#x9898;&#x56DB;&#xFF1A;&#x5728;&#x4F7F;&#x7528;&#x6A21;&#x677F;&#x5F15;&#x64CE;&#x65F6;&#x6B63;&#x6587;&#x91C7;&#x7528;&#x4E2D;&#x6587;&#x4F1A;&#x51FA;&#x73B0;utf8-decode-error&#x7684;&#x9519;&#x8BEF;&#x51FA;&#x73B0;"><a href="#&#x95EE;&#x9898;&#x56DB;&#xFF1A;&#x5728;&#x4F7F;&#x7528;&#x6A21;&#x677F;&#x5F15;&#x64CE;&#x65F6;&#x6B63;&#x6587;&#x91C7;&#x7528;&#x4E2D;&#x6587;&#x4F1A;&#x51FA;&#x73B0;utf8-decode-error&#x7684;&#x9519;&#x8BEF;&#x51FA;&#x73B0;" class="headerlink" title="&#x95EE;&#x9898;&#x56DB;&#xFF1A;&#x5728;&#x4F7F;&#x7528;&#x6A21;&#x677F;&#x5F15;&#x64CE;&#x65F6;&#x6B63;&#x6587;&#x91C7;&#x7528;&#x4E2D;&#x6587;&#x4F1A;&#x51FA;&#x73B0;utf8 decode error&#x7684;&#x9519;&#x8BEF;&#x51FA;&#x73B0;"></a>&#x95EE;&#x9898;&#x56DB;&#xFF1A;&#x5728;&#x4F7F;&#x7528;&#x6A21;&#x677F;&#x5F15;&#x64CE;&#x65F6;&#x6B63;&#x6587;&#x91C7;&#x7528;&#x4E2D;&#x6587;&#x4F1A;&#x51FA;&#x73B0;utf8 decode error&#x7684;&#x9519;&#x8BEF;&#x51FA;&#x73B0;</h4><p>&#x539F;&#x56E0;&#x662F;&#x6A21;&#x677F;&#x6587;&#x4EF6;&#x7684;&#x7F16;&#x7801;&#x4E0D;&#x5BF9;&#xFF0C;&#x6700;&#x597D;&#x91C7;&#x7528;utf8&#x65E0;BOM&#x7684;&#x683C;&#x5F0F;&#x3002;&#x5728;notepad++ &#x4E2D;&#x9ED8;&#x8BA4;&#x7F16;&#x7801;&#x662F;ANSI&#xFF0C;&#x9700;&#x8981;&#x6539;&#x8FC7;&#x6765;&#x3002;</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Python/">Python</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/flask/">flask</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-python-functional-programming" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/20/python-functional-programming/" class="article-date">
      <time datetime="2016-05-20T00:16:31.950Z" itemprop="datePublished">2016-05-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/20/python-functional-programming/">浅说Python 中的函数式编程</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;"><a href="#&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;" class="headerlink" title="&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;"></a>&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;</h4><p>&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x601D;&#x60F3;&#x6709;&#x7740;50&#x591A;&#x5E74;&#x7684;&#x5386;&#x53F2;&#xFF0C;&#x6700;&#x53E4;&#x8001;&#x7684;&#x7B97;&#x662F;Lisp&#x8BED;&#x8A00;&#x4E86;&#x3002;&#x5982;&#x4ECA;&#x4F17;&#x591A;&#x8BED;&#x8A00;&#x90FD;&#x5728;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x4E0A;&#x652F;&#x6301;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#xFF0C;&#x5982;Python&#x3001;Ruby&#x3001;Javascript&#xFF0C;&#x800C;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;&#x8BED;&#x8A00;&#x5982;Java&#x3001;PHP&#x90FD;&#x589E;&#x52A0;&#x4E86;&#x5BF9;&#x4E8E;&#x533F;&#x540D;&#x51FD;&#x6570;&#x7684;&#x652F;&#x6301;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x51FD;&#x6570;&#x7F16;&#x7A0B;&#x7684;&#x601D;&#x60F3;&#x8FD8;&#x5F88;&#x53D7;&#x6B22;&#x8FCE;&#x3002;<br>&#x4E0B;&#x9762;&#x4E00;&#x6BB5;&#x8BDD;&#x5F15;&#x81EA;&#x77E5;&#x4E4E;&#xFF0C;<a href="https://www.zhihu.com/topic/19585411/top-answers" target="_blank" rel="external">&#x539F;&#x6587;&#x5730;&#x5740;</a></p>
<blockquote>
<p>&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x662F;&#x4E00;&#x79CD;&#x7F16;&#x7A0B;&#x8303;&#x5F0F;&#xFF0C;&#x5E38;&#x89C1;&#x7684;&#x7F16;&#x7A0B;&#x8303;&#x5F0F;&#x6709;&#x547D;&#x4EE4;&#x5F0F;&#x7F16;&#x7A0B;&#xFF0C;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#xFF0C;&#x903B;&#x8F91;&#x5F0F;&#x7F16;&#x7A0B;&#xFF0C;&#x503C;&#x5F97;&#x4E00;&#x63D0;&#x7684;&#x662F;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7F16;&#x7A0B;&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x547D;&#x4EE4;&#x5F0F;&#x7F16;&#x7A0B;&#x3002;&#x547D;&#x4EE4;&#x5F0F;&#x7F16;&#x7A0B;&#x662F;&#x9762;&#x5411;&#x8BA1;&#x7B97;&#x673A;&#x786C;&#x4EF6;&#x7684;&#x62BD;&#x8C61;&#xFF0C;&#x6709;&#x53D8;&#x91CF;&#xFF08;&#x5BF9;&#x5E94;&#x7740;&#x5B58;&#x50A8;&#x5355;&#x5143;&#xFF09;&#xFF0C;&#x8D4B;&#x503C;&#x8BED;&#x53E5;&#xFF08;&#x83B7;&#x53D6;&#x53CA;&#x5B58;&#x50A8;&#x6307;&#x4EE4;&#xFF09;&#xFF0C;&#x8868;&#x8FBE;&#x5F0F;&#xFF08;&#x5185;&#x5B58;&#x5F15;&#x7528;&#x548C;&#x7B97;&#x672F;&#x8FD0;&#x7B97;&#xFF09;&#x548C;&#x63A7;&#x5236;&#x8BED;&#x53E5;&#xFF08;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#xFF09;&#xFF0C;&#x603B;&#x4E4B;&#xFF0C;&#x547D;&#x4EE4;&#x5F0F;&#x7A0B;&#x5E8F;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x51AF;&#x8BFA;&#x4F9D;&#x66FC;&#x673A;&#x7684;&#x6307;&#x4EE4;&#x5E8F;&#x5217;&#x3002;&#x800C;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x662F;&#x9762;&#x5411;&#x6570;&#x5B66;&#x7684;&#x62BD;&#x8C61;&#xFF0C;&#x5C06;&#x8BA1;&#x7B97;&#x63CF;&#x8FF0;&#x4E3A;&#x4E00;&#x79CD;&#x8868;&#x8FBE;&#x5F0F;&#x6C42;&#x503C;&#xFF0C;&#x4E00;&#x53E5;&#x8BDD;&#xFF0C;&#x51FD;&#x6570;&#x5F0F;&#x7A0B;&#x5E8F;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x8868;&#x8FBE;&#x5F0F;&#x3002;<br>&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x5E76;&#x4E0D;&#x662F;&#x6307;&#x8BA1;&#x7B97;&#x673A;&#x4E2D;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x800C;&#x662F;&#x6307;&#x6570;&#x5B66;&#x4E2D;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x5373;&#x81EA;&#x53D8;&#x91CF;&#x7684;&#x6620;&#x5C04;&#xFF0C;&#x5373;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x503C;&#x4EC5;&#x51B3;&#x5B9A;&#x4E8E;&#x51FD;&#x6570;&#x53C2;&#x6570;&#x7684;&#x503C;&#xFF0C;&#x4E0D;&#x4F9D;&#x8D56;&#x5176;&#x4ED6;&#x72B6;&#x6001;&#x3002;&#x5728;&#x51FD;&#x6570;&#x5F0F;&#x8BED;&#x8A00;&#x4E2D;&#xFF0C;&#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x4E00;&#x7B49;&#x516C;&#x6C11;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x4EFB;&#x4F55;&#x5730;&#x65B9;&#x5B9A;&#x4E49;&#xFF0C;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x548C;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x53EF;&#x4EE5;&#x5BF9;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x7EC4;&#x5408;&#x3002;&#x7EAF;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x4E2D;&#x7684;&#x53D8;&#x91CF;&#x4E5F;&#x4E0D;&#x662F;&#x547D;&#x4EE4;&#x5F0F;&#x7F16;&#x7A0B;&#x4E2D;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x5373;&#x5B58;&#x50A8;&#x72B6;&#x6001;&#x7684;&#x5355;&#x5143;&#xFF0C;&#x800C;&#x662F;&#x4EE3;&#x6570;&#x4E2D;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x5373;&#x4E00;&#x4E2A;&#x503C;&#x7684;&#x540D;&#x79F0;&#x3002;&#x53D8;&#x91CF;&#x7684;&#x503C;&#x662F;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#xFF0C;&#x5373;&#x4E0D;&#x5141;&#x8BB8;&#x50CF;&#x547D;&#x4EE4;&#x5F0F;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x4E2D;&#x7684;&#x90A3;&#x6837;&#x591A;&#x6B21;&#x7ED9;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x8D4B;&#x503C;&#x3002;&#x4E25;&#x683C;&#x610F;&#x4E49;&#x4E0A;&#x7684;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x610F;&#x5473;&#x7740;&#x4E0D;&#x4F7F;&#x7528;&#x53EF;&#x53D8;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x8D4B;&#x503C;&#xFF0C;&#x5FAA;&#x73AF;&#x548C;&#x5176;&#x4ED6;&#x547D;&#x4EE4;&#x5F0F;&#x63A7;&#x5236;&#x7ED3;&#x6784;&#x8FDB;&#x884C;&#x7F16;&#x7A0B;&#x3002;</p>
</blockquote>
<p>&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x7684;&#x597D;&#x5904;<br>&#x5F15;&#x7528;&#x900F;&#x660E;&#x3001;&#x6CA1;&#x6709;&#x526F;&#x4F5C;&#x7528;&#xFF0C;&#x7528;&#x77E5;&#x4E4E;&#x4E0A;&#x7B54;&#x4E3B;&#x7684;&#x8BF4;&#x6CD5;&#x5C31;&#x662F;</p>
<blockquote>
<p>&#x4E00;&#x4E2A;&#x597D;&#x5904;&#x662F;&#xFF0C;&#x51FD;&#x6570;&#x65E2;&#x4E0D;&#x4F9D;&#x8D56;&#x5916;&#x90E8;&#x7684;&#x72B6;&#x6001;&#x4E5F;&#x4E0D;&#x4FEE;&#x6539;&#x5916;&#x90E8;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x548C;&#x8C03;&#x8BD5;&#x66F4;&#x52A0;&#x5BB9;&#x6613;&#x3002;&#x53E6;&#x4E00;&#x4E2A;&#x597D;&#x5904;&#x662F;&#x7531;&#x4E8E;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x95F4;&#x4E0D;&#x5171;&#x4EAB;&#x72B6;&#x6001;&#xFF0C;&#x56E0;&#x800C;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x53D1;&#x751F;&#x6B7B;&#x9501;&#xFF0C;&#x53EF;&#x4EE5;&#x5F88;&#x597D;&#x5730;&#x5B9E;&#x73B0;&#x5E76;&#x53D1;&#x3002;<br>&#x9664;&#x6B64;&#x4EE5;&#x5916;&#xFF0C;&#x51FD;&#x6570;&#x5F0F;&#x8BED;&#x8A00;&#x8FD8;&#x5177;&#x6709;&#x4EE5;&#x4E0B;&#x7279;&#x6027;&#xFF1A;</p>
<ul>
<li>&#x9AD8;&#x9636;&#x51FD;&#x6570;(Higher-order function)</li>
<li>&#x504F;&#x5E94;&#x7528;&#x51FD;&#x6570;(Partially Applied Functions)</li>
<li>&#x67EF;&#x91CC;&#x5316;(Currying)</li>
<li>&#x95ED;&#x5305;(Closure)</li>
</ul>
</blockquote>
<h4 id="Python-&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;"><a href="#Python-&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;" class="headerlink" title="Python &#x4E2D;&#x7684;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;"></a>Python &#x4E2D;&#x7684;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;</h4><p>Python&#x4E2D;&#x5BF9;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x7684;&#x652F;&#x6301;&#x4E3B;&#x8981;&#x96C6;&#x4E2D;&#x5728;&#x63D0;&#x4F9B;&#x4E86;map(),reduce(),filter()&#x4E09;&#x4E2A;&#x51FD;&#x6570;&#x548C;lambda&#x7B97;&#x5B50;&#xFF0C;&#x8BA9;&#x4EBA;&#x5403;&#x60CA;&#x7684;&#x662F;&#x4EC5;&#x51ED;&#x8FD9;&#x51E0;&#x4E2A;&#x51FD;&#x6570;&#x5C31;&#x51E0;&#x4E4E;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4EFB;&#x610F;&#x7684;Python&#x7A0B;&#x5E8F;&#x3002;<br>&#x5173;&#x4E8E;&#x8FD9;&#x51E0;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x53C2;&#x89C1;&#x6211;&#x7684;&#x53E6;&#x5916;&#x4E00;&#x7BC7;<a href="../../02/python-functions/">&#x535A;&#x5BA2;</a>&#xFF0C;&#x4E0A;&#x9762;&#x6709;&#x5BF9;&#x8FD9;&#x51E0;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x4ECB;&#x7ECD;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7684;&#x5185;&#x5BB9;&#x53C2;&#x8003;&#x81EA;<a href="http://python.jobbole.com/84927/" target="_blank" rel="external">&#x8FD9;&#x4E2A;&#x7F51;&#x5740;</a><br><em>&#x66FF;&#x6362;&#x6761;&#x4EF6;&#x63A7;&#x5236;&#x8BED;&#x53E5;</em><br>&#x5BF9;&#x4E8E;&#x4E0B;&#x9762;&#x7684;&#x6761;&#x4EF6;&#x63A7;&#x5236;&#x8BED;&#x53E5;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> condition1:</span><br><span class="line">    func1()</span><br><span class="line"><span class="keyword">elif</span> contidion2:</span><br><span class="line">    func2()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    func3()</span><br></pre></td></tr></table></figure></p>
<p>&#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x66FF;&#x6362;&#x6210;&#x4E0B;&#x9762;&#x7684;&#x8868;&#x8FBE;&#x5F0F;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(condition1 <span class="keyword">and</span> func1()) <span class="keyword">or</span> (condition2 <span class="keyword">and</span> func2()) <span class="keyword">or</span> (func3())</span><br></pre></td></tr></table></figure></p>
<p>&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>pr=<span class="keyword">lambda</span> p:p</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print_number=<span class="keyword">lambda</span> x:(x==<span class="number">1</span> <span class="keyword">and</span> pr(<span class="string">&quot;it&apos;s one&quot;</span>)) <span class="keyword">or</span> (x==<span class="number">2</span> <span class="keyword">and</span> pr(<span class="string">&quot;it&apos;s two&quot;</span>)) <span class="keyword">or</span> (pr(<span class="string">&quot;it&apos;s something else&quot;</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print_number(<span class="number">1</span>)</span><br><span class="line"><span class="string">&quot;it&apos;s one&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print_number(<span class="number">2</span>)</span><br><span class="line"><span class="string">&quot;it&apos;s two&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print_number(<span class="number">3</span>)</span><br><span class="line"><span class="string">&quot;it&apos;s something else&quot;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x91C7;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x6761;&#x4EF6;&#x63A7;&#x5236;&#x7684;&#x66FF;&#x6362;&#x3002;</p>
<p><em>&#x66FF;&#x6362;&#x5FAA;&#x73AF;&#x63A7;&#x5236;&#x8BED;&#x53E5;</em></p>
<ul>
<li><p>&#x66FF;&#x6362;for&#x5FAA;&#x73AF;<br>&#x7531;&#x4E8E;&#x548C;map&#x51FD;&#x6570;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7528;map&#x51FD;&#x6570;&#x6765;&#x5B9E;&#x73B0;for&#x5FAA;&#x73AF;&#xFF0C;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>cubic=<span class="keyword">lambda</span> x: x**<span class="number">3</span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line"><span class="meta">... </span>    cubic(x)</span><br><span class="line">...</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="number">27</span></span><br><span class="line"><span class="number">64</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>map(cubic,range(<span class="number">5</span>))</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">27</span>, <span class="number">64</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>&#x66FF;&#x6362;while&#x5FAA;&#x73AF;<br>&#x76F8;&#x8F83;&#x800C;&#x8A00;&#xFF0C;&#x66FF;&#x6362;while&#x5FAA;&#x73AF;&#x7A0D;&#x7A0D;&#x9EBB;&#x70E6;&#x4E00;&#x4E9B;&#xFF0C;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># statement-based while loop</span></span><br><span class="line"><span class="keyword">while</span> &lt;condition&gt;:</span><br><span class="line">    &lt;pre-suite&gt;</span><br><span class="line">    <span class="keyword">if</span> &lt;break_condition&gt;:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        &lt;suite&gt;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Equivalent FP-style recursive while loop</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">while_block</span><span class="params">()</span>:</span></span><br><span class="line">    &lt;pre-suite&gt;</span><br><span class="line">    <span class="keyword">if</span> &lt;break_condition&gt;:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        &lt;suite&gt;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">while_FP = <span class="keyword">lambda</span>: &lt;condition&gt; <span class="keyword">and</span> (while_block() <span class="keyword">or</span> while_FP())</span><br><span class="line">while_FP()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>&#x51FD;&#x6570;&#x5F0F;while_FP&#x5FAA;&#x73AF;&#x91C7;&#x7528;&#x4E86;&#x9012;&#x5F52;&#x7684;&#x6982;&#x5FF5;&#x3002;&#x5F53;&#x4E3A;true&#x65F6;&#xFF0C;&#x8FDB;&#x5165;&#x5FAA;&#x73AF;&#x4F53;&#xFF0C;&#x6267;&#x884C;while_block()&#xFF1B;&#x82E5;&#x4E3A;true&#x65F6;&#xFF0C;&#x8FD4;&#x56DE;1&#xFF0C;while_FP()&#x8C03;&#x7528;&#x7ED3;&#x675F;&#xFF1B;&#x82E5;&#x4E3A;false&#x65F6;&#xFF0C;&#x8FD4;&#x56DE;0&#xFF0C;&#x4F1A;&#x7EE7;&#x7EED;&#x6267;&#x884C;or&#x53F3;&#x4FA7;&#x7684;while_FP()&#xFF0C;&#x4ECE;&#x800C;&#x5B9E;&#x73B0;&#x9012;&#x5F52;&#x8C03;&#x7528;&#xFF1B;&#x82E5;&#x59CB;&#x7EC8;&#x4E3A;false&#xFF0C;&#x5219;&#x4F1A;&#x6301;&#x7EED;&#x9012;&#x5F52;&#x8C03;&#x7528;while_FP()&#xFF0C;&#x8FD9;&#x5C31;&#x5B9E;&#x73B0;&#x4E86;while&#x8BED;&#x53E5;&#x4E2D;&#x540C;&#x6837;&#x7684;&#x529F;&#x80FD;&#x3002;</p>
<p>&#x770B;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x8F93;&#x5165;&#x56DE;&#x663E;&#x7684;echo&#x529F;&#x80FD;&#xFF0C;&#x5BF9;&#x6BD4;&#x4E00;&#x4E0B;&#x547D;&#x4EE4;&#x5F0F;&#x7F16;&#x7A0B;&#x548C;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&#x547D;&#x4EE4;&#x5F0F;&#x7F16;&#x7A0B;&#x7248;&#x672C;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">echo_IMP</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        x = raw_input(<span class="string">&quot;IMP -- &quot;</span>)</span><br><span class="line">        <span class="keyword">print</span> x</span><br><span class="line">        <span class="keyword">if</span> x == <span class="string">&apos;quit&apos;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">echo_IMP()</span><br></pre></td></tr></table></figure></p>
<p>&#x4E0B;&#x9762;&#x662F;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x7248;&#x672C;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">monadic_print</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> x</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"> </span><br><span class="line">echo_FP = <span class="keyword">lambda</span>: monadic_print(raw_input(<span class="string">&quot;FP -- &quot;</span>))==<span class="string">&apos;quit&apos;</span> <span class="keyword">or</span> echo_FP()</span><br><span class="line">echo_FP()</span><br></pre></td></tr></table></figure></p>
<p>&#x518D;&#x6765;&#x770B;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x8BE5;&#x4F8B;&#x5B50;&#x5B9E;&#x73B0;&#x627E;&#x51FA;&#x7B1B;&#x5361;&#x5C14;&#x79EF;&#x5143;&#x7EC4;&#x96C6;&#x5408;&#x4E2D;&#x5143;&#x7D20;&#x4E4B;&#x79EF;&#x5927;&#x4E8E;25&#x7684;&#x6240;&#x6709;&#x5143;&#x7EC4;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bigmuls = <span class="keyword">lambda</span> xs,ys: filter(<span class="keyword">lambda</span> (x,y):x*y &gt; <span class="number">25</span>, combine(xs,ys))</span><br><span class="line">combine = <span class="keyword">lambda</span> xs,ys: map(<span class="keyword">None</span>, xs*len(ys), dupelms(ys,len(xs)))</span><br><span class="line">dupelms = <span class="keyword">lambda</span> lst,n: reduce(<span class="keyword">lambda</span> s,t:s+t, map(<span class="keyword">lambda</span> l,n=n: [l]*n, lst))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> bigmuls([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],[<span class="number">10</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">22</span>])</span><br><span class="line"></span><br><span class="line">[(<span class="number">3</span>, <span class="number">10</span>), (<span class="number">4</span>, <span class="number">10</span>), (<span class="number">2</span>, <span class="number">15</span>), (<span class="number">3</span>, <span class="number">15</span>), (<span class="number">4</span>, <span class="number">15</span>), (<span class="number">2</span>, <span class="number">22</span>), (<span class="number">3</span>, <span class="number">22</span>), (<span class="number">4</span>, <span class="number">22</span>)]</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Python/">Python</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/函数式编程/">函数式编程</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-python-property-function" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/20/python-property-function/" class="article-date">
      <time datetime="2016-05-19T16:28:18.763Z" itemprop="datePublished">2016-05-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/20/python-property-function/">Python 中的属性函数</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h4><p>Python&#x4E2D;&#x7684;&#x5C5E;&#x6027;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4E00;&#x4E9B;&#x6709;&#x7528;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4F8B;&#x5982;&#x5C06;&#x7C7B;&#x65B9;&#x6CD5;&#x8F6C;&#x6362;&#x4E3A;&#x53EA;&#x8BFB;&#x5C5E;&#x6027;&#x3001;&#x91CD;&#x65B0;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5C5E;&#x6027;&#x7684;setter&#x548C;getter&#x65B9;&#x6CD5;&#x3002;&#x4E0B;&#x9762;&#x8FDB;&#x5165;&#x6B63;&#x9898;&#x3002;</p>
<h4 id="&#x5C06;&#x7C7B;&#x65B9;&#x6CD5;&#x8F6C;&#x4E3A;&#x53EA;&#x8BFB;&#x5C5E;&#x6027;"><a href="#&#x5C06;&#x7C7B;&#x65B9;&#x6CD5;&#x8F6C;&#x4E3A;&#x53EA;&#x8BFB;&#x5C5E;&#x6027;" class="headerlink" title="&#x5C06;&#x7C7B;&#x65B9;&#x6CD5;&#x8F6C;&#x4E3A;&#x53EA;&#x8BFB;&#x5C5E;&#x6027;"></a>&#x5C06;&#x7C7B;&#x65B9;&#x6CD5;&#x8F6C;&#x4E3A;&#x53EA;&#x8BFB;&#x5C5E;&#x6027;</h4><p>&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x53C2;&#x8003;<a href="http://python.jobbole.com/80955/" target="_blank" rel="external">&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;</a><br>&#x5BF9;&#x4E8E;&#x4E0B;&#x9762;&#x7684;&#x4E00;&#x4E2A;&#x7C7B;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">#----------------------------------------------------------------------</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, first_name, last_name)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Constructor&quot;&quot;&quot;</span></span><br><span class="line">        self.first_name = first_name</span><br><span class="line">        self.last_name = last_name</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#----------------------------------------------------------------------</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">full_name</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span><br><span class="line">        Return the full name</span><br><span class="line">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;%s %s&quot;</span> % (self.first_name, self.last_name)</span><br></pre></td></tr></table></figure></p>
<p>&#x901A;&#x8FC7;&#x5C06;full_name&#x8BBE;&#x7F6E;&#x4E3A;&#x53EA;&#x8BFB;&#x5C5E;&#x6027;&#xFF0C;&#x5916;&#x63A5;&#x53EF;&#x4EE5;&#x50CF;&#x8C03;&#x7528;&#x666E;&#x901A;&#x7684;&#x5C5E;&#x6027;&#x4E00;&#x6837;&#x4F7F;&#x7528;full_name&#xFF0C;&#x4F8B;&#x5982;&#x4E0B;&#x9762;&#x8FD9;&#x6837;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; person = Person(&quot;Mike&quot;, &quot;Driscoll&quot;)</span><br><span class="line">&gt;&gt;&gt; person.full_name</span><br><span class="line">&apos;Mike Driscoll&apos;</span><br><span class="line">&gt;&gt;&gt; person.first_name</span><br><span class="line">&apos;Mike&apos;</span><br><span class="line">&gt;&gt;&gt; person.full_name = &quot;Jackalope&quot;</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;fragment&gt;</span><br><span class="line">AttributeError: can&apos;t set attribute</span><br></pre></td></tr></table></figure></p>
<p>&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x5730;&#x8BBF;&#x95EE;&#x5B83;&#xFF0C;&#x4F46;&#x662F;&#x65E0;&#x6CD5;&#x8BBE;&#x7F6E;&#x5C5E;&#x6027;&#xFF0C;&#x56E0;&#x4E3A;&#x6CA1;&#x6709;&#x76F8;&#x5E94;&#x7684;setter&#x65B9;&#x6CD5;&#xFF0C;&#x60F3;&#x8981;&#x6539;&#x53D8;&#xFF0C;&#x53EA;&#x80FD;&#x901A;&#x8FC7;&#x4FEE;&#x6539;first_name&#x5C5E;&#x6027;&#x6216;&#x8005;last_name&#x5C5E;&#x6027;&#x7684;&#x503C;&#x6765;&#x5B9E;&#x73B0;&#x3002;&#x4E0B;&#x9762;&#x770B;&#x53E6;&#x5916;&#x4E00;&#x4E2A;property&#x7684;&#x7528;&#x5904;&#xFF0C;&#x5373;&#x53D6;&#x4EE3;getter&#x548C;setter&#x65B9;&#x6CD5;&#x3002;</p>
<h4 id="&#x5B9E;&#x73B0;&#x5C5E;&#x6027;&#x7684;getter&#x548C;setter&#x65B9;&#x6CD5;"><a href="#&#x5B9E;&#x73B0;&#x5C5E;&#x6027;&#x7684;getter&#x548C;setter&#x65B9;&#x6CD5;" class="headerlink" title="&#x5B9E;&#x73B0;&#x5C5E;&#x6027;&#x7684;getter&#x548C;setter&#x65B9;&#x6CD5;"></a>&#x5B9E;&#x73B0;&#x5C5E;&#x6027;&#x7684;getter&#x548C;setter&#x65B9;&#x6CD5;</h4><p>&#x719F;&#x6089;Java&#x7F16;&#x7A0B;&#x7684;&#x4EBA;&#x80AF;&#x5B9A;&#x5BF9;getter&#x548C;setter&#x5E76;&#x4E0D;&#x964C;&#x751F;&#xFF0C;&#x5BF9;&#x4E8E;&#x7C7B;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x5C5E;&#x6027;&#xFF0C;&#x5BF9;&#x5916;&#x8981;&#x63D0;&#x4F9B;getter&#x548C;setter&#x65B9;&#x6CD5;&#xFF0C;&#x5982;&#x679C;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5199;Python&#x4EE3;&#x7801;&#xFF0C;&#x663E;&#x5F97;&#x4F18;&#x70B9;&#x4E0D;&#x4E13;&#x4E1A;&#xFF0C;&#x4E0D;&#x5149;&#x4EE3;&#x7801;&#x5197;&#x957F;&#xFF0C;&#x800C;&#x4E14;&#x5F71;&#x54CD;&#x7F8E;&#x89C2;&#x3002;&#x91C7;&#x7528;property&#x7684;&#x65B9;&#x5F0F;&#x53EF;&#x4EE5;&#x6539;&#x5584;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#x3002;&#x4E0B;&#x9762;&#x5148;&#x770B;&#x7B2C;&#x4E00;&#x4E2A;&#x7248;&#x672C;&#x7684;property&#x6539;&#x5199;&#x793A;&#x4F8B;&#x3002;<br>&#x5047;&#x8BBE;&#x73B0;&#x5728;&#x6709;&#x4E00;&#x4E2A;&#x7C7B;Fees&#xFF0C;&#x5B83;&#x6709;&#x4E00;&#x4E2A;&#x5C5E;&#x6027;_fee&#xFF0C;&#x5982;&#x679C;&#x6A21;&#x4EFF;&#x5176;&#x4ED6;&#x8BED;&#x8A00;&#x7684;&#x65B9;&#x5F0F;&#x63D0;&#x4F9B;getter&#x548C;setter&#x65B9;&#x6CD5;&#x7684;&#x8BDD;&#x5C31;&#x662F;&#x8FD9;&#x6837;&#x7684;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> Decimal</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fees</span><span class="params">(object)</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Constructor&quot;&quot;&quot;</span></span><br><span class="line">        self._fee = <span class="keyword">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_fee</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span><br><span class="line">        The getter</span><br><span class="line">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self._fee</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_fee</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span><br><span class="line">        The setter </span><br><span class="line">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(value, str):</span><br><span class="line">            self._fee = Decimal(value)</span><br><span class="line">        <span class="keyword">elif</span> isinstance(value, Decimal):</span><br><span class="line">            self._fee = value</span><br><span class="line"> </span><br><span class="line"><span class="comment">#----------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    f = Fees()</span><br><span class="line">    f.set_fee(<span class="string">&quot;100&quot;</span>)</span><br><span class="line">    f.get_fee()</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x6837;&#x8868;&#x9762;&#x770B;&#x8D77;&#x6765;&#x633A;&#x4E0D;&#x9519;&#x7684;&#x3002;&#x4E0A;&#x9762;&#x672C;&#x610F;&#x662F;&#x68C0;&#x67E5;&#x8F93;&#x5165;&#x6570;&#x636E;&#x662F;&#x4E0D;&#x662F;&#x6570;&#x503C;&#x7C7B;&#x578B;&#x6216;&#x8005;&#x662F;&#x53EF;&#x4EE5;&#x8F6C;&#x6362;&#x4E3A;&#x6570;&#x503C;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x5219;&#x5141;&#x8BB8;&#xFF0C;&#x5426;&#x5219;&#x4E0D;&#x5141;&#x8BB8;&#x8BBE;&#x7F6E;&#x3002;&#x4F46;&#x662F;&#x5982;&#x679C;&#x7528;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#x5C5E;&#x6027;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x8BBE;&#x5B9A;&#x5C5E;&#x6027;&#x7684;&#x503C;&#xFF0C;&#x90A3;&#x4E48;&#x5BF9;_fee&#x7684;&#x9A8C;&#x8BC1;&#x5C31;&#x4E0D;&#x8D77;&#x4F5C;&#x7528;&#x4E86;&#x3002;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x4F7F;&#x7528;&#x8FC7;&#x7A0B;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.set_fee(<span class="string">&quot;200&quot;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.get_fee()</span><br><span class="line">Decimal(<span class="string">&apos;200&apos;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x770B;&#x8D77;&#x6765;&#x8FD8;&#x4E0D;&#x9519;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.set_fee(<span class="string">&quot;haha&quot;</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">24</span>, <span class="keyword">in</span> set_fee</span><br><span class="line">  File <span class="string">&quot;C:\Users\wenqiang\Anaconda\lib\decimal.py&quot;</span>, line <span class="number">547</span>, <span class="keyword">in</span> __new__</span><br><span class="line">    <span class="string">&quot;Invalid literal for Decimal: %r&quot;</span> % value)</span><br><span class="line">  File <span class="string">&quot;C:\Users\wenqiang\Anaconda\lib\decimal.py&quot;</span>, line <span class="number">3873</span>, <span class="keyword">in</span> _raise_error</span><br><span class="line">    <span class="keyword">raise</span> error(explanation)</span><br><span class="line">decimal.InvalidOperation: Invalid literal <span class="keyword">for</span> Decimal: <span class="string">&apos;haha&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x4F46;&#x662F;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x5C31;&#x4E0D;&#x884C;&#x4E86;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f._fee=<span class="string">&quot;haha&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.get_fee()</span><br><span class="line"><span class="string">&apos;haha&apos;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x4E0B;&#x9762;&#x901A;&#x8FC7;property&#x6765;&#x5B9E;&#x73B0;getter&#x548C;setter&#x7684;&#x529F;&#x80FD;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> Decimal</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fees</span><span class="params">(object)</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Constructor&quot;&quot;&quot;</span></span><br><span class="line">        self._fee = <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fee</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span><br><span class="line">        The fee property - the getter</span><br><span class="line">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self._fee</span><br><span class="line"></span><br><span class="line"><span class="meta">    @fee.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fee</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span><br><span class="line">        The setter of the fee property</span><br><span class="line">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(value, str):</span><br><span class="line">            self._fee = Decimal(value)</span><br><span class="line">        <span class="keyword">elif</span> isinstance(value, Decimal):</span><br><span class="line">            self._fee = value</span><br><span class="line"></span><br><span class="line"><span class="comment">#----------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    f = Fees()</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x56DE;&#x770B;&#x4E00;&#x4E0B;&#x4F7F;&#x7528;&#x8D77;&#x6765;&#x5982;&#x4F55;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>f=Fees()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.fee=<span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.fee</span><br><span class="line">Decimal(<span class="string">&apos;1&apos;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.fee=<span class="string">&quot;haha&quot;</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">11</span>, <span class="keyword">in</span> fee</span><br><span class="line">  File <span class="string">&quot;C:\Users\wenqiang\Anaconda\lib\decimal.py&quot;</span>, line <span class="number">547</span>, <span class="keyword">in</span> __new__</span><br><span class="line">    <span class="string">&quot;Invalid literal for Decimal: %r&quot;</span> % value)</span><br><span class="line">  File <span class="string">&quot;C:\Users\wenqiang\Anaconda\lib\decimal.py&quot;</span>, line <span class="number">3873</span>, <span class="keyword">in</span> _raise_error</span><br><span class="line">    <span class="keyword">raise</span> error(explanation)</span><br><span class="line">decimal.InvalidOperation: Invalid literal <span class="keyword">for</span> Decimal: <span class="string">&apos;haha&apos;</span></span><br><span class="line"><span class="comment">#&#x54C8;&#x54C8;&#xFF0C;&#x8FD8;&#x662F;&#x88AB;&#x5F02;&#x5E38;&#x4FEE;&#x6539;&#x4E86;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f._fee=<span class="string">&quot;haha&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.fee</span><br><span class="line"><span class="string">&apos;haha&apos;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure></p>
<p>&#x901A;&#x8FC7;&#x4EE5;&#x4E0A;&#x5BF9;&#x6BD4;&#xFF0C;&#x53D1;&#x73B0;&#x8FD9;&#x79CD;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x76F8;&#x5BF9;&#x4E8E;getter&#x548C;setter&#x6765;&#x8BF4;&#x5E76;&#x6CA1;&#x6709;&#x591A;&#x5927;&#x6539;&#x8FDB;&#xFF0C;&#x522B;&#x6025;&#xFF0C;&#x770B;&#x4E00;&#x4E0B;&#x7248;&#x672C;2&#x4E2D;&#x7684;&#x6539;&#x8FDB;&#x3002;<br>&#x7248;&#x672C;&#x4E8C;&#xFF0C;&#x4E13;&#x95E8;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x7C7B;&#xFF0C;&#x5C06;&#x8FD9;&#x4E2A;&#x7C7B;&#x5E94;&#x7528;&#x5230;&#x591A;&#x4E2A;&#x5C5E;&#x6027;&#x4E0A;&#x3002;&#x4E0B;&#x9762;&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#x8BF4;&#x660E;&#x4E00;&#x4E0B;&#xFF0C;&#x4F8B;&#x5B50;&#x6765;&#x81EA;&#x4E8E;<a href="http://www.geekfan.net/7862/" target="_blank" rel="external">&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;</a></p>
<p>&#x770B;&#x4E00;&#x4E0B;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4F7F;&#x7528;&#x7B2C;&#x4E00;&#x4E2A;&#x7248;&#x672C;&#x7684;&#x6548;&#x679C;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Movie</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, title, rating, runtime, budget, gross)</span>:</span></span><br><span class="line">        self._rating = <span class="keyword">None</span></span><br><span class="line">        self._runtime = <span class="keyword">None</span></span><br><span class="line">        self._budget = <span class="keyword">None</span></span><br><span class="line">        self._gross = <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line">        self.title = title</span><br><span class="line">        self.rating = rating</span><br><span class="line">        self.runtime = runtime</span><br><span class="line">        self.gross = gross</span><br><span class="line">        self.budget = budget</span><br><span class="line"></span><br><span class="line">    <span class="comment">#nice</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">budget</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._budget</span><br><span class="line"></span><br><span class="line"><span class="meta">    @budget.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">budget</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Negative value not allowed: %s&quot;</span> % value)</span><br><span class="line">        self._budget = value</span><br><span class="line"></span><br><span class="line">    <span class="comment">#ok    </span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rating</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._rating</span><br><span class="line"></span><br><span class="line"><span class="meta">    @rating.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rating</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Negative value not allowed: %s&quot;</span> % value)</span><br><span class="line">        self._rating = value</span><br><span class="line"></span><br><span class="line">    <span class="comment">#uhh...</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">runtime</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._runtime</span><br><span class="line"></span><br><span class="line"><span class="meta">    @runtime.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">runtime</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Negative value not allowed: %s&quot;</span> % value)</span><br><span class="line">        self._runtime = value        </span><br><span class="line"></span><br><span class="line">    <span class="comment">#is this forever?</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gross</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._gross</span><br><span class="line"></span><br><span class="line"><span class="meta">    @gross.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gross</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Negative value not allowed: %s&quot;</span> % value)</span><br><span class="line">        self._gross = value        </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">profit</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.gross - self.budget</span><br></pre></td></tr></table></figure></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5BF9;&#x4E8E;&#x591A;&#x4E2A;&#x5C5E;&#x6027;&#x8FD9;&#x6837;&#x8BBE;&#x7F6E;&#x4ECD;&#x7136;&#x5F88;&#x9EBB;&#x70E6;&#xFF0C;&#x4E0B;&#x9762;&#x770B;&#x4E00;&#x4E0B;&#x7248;&#x672C;2&#x7684;&#x5199;&#x6CD5;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> weakref <span class="keyword">import</span> WeakKeyDictionary</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NonNegative</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;A descriptor that forbids negative values&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, default)</span>:</span></span><br><span class="line">        self.default = default</span><br><span class="line">        self.data = WeakKeyDictionary()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__get__</span><span class="params">(self, instance, owner)</span>:</span></span><br><span class="line">        <span class="comment"># we get here when someone calls x.d, and d is a NonNegative instance</span></span><br><span class="line">        <span class="comment"># instance = x</span></span><br><span class="line">        <span class="comment"># owner = type(x)</span></span><br><span class="line">        <span class="keyword">return</span> self.data.get(instance, self.default)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__set__</span><span class="params">(self, instance, value)</span>:</span></span><br><span class="line">        <span class="comment"># we get here when someone calls x.d = val, and d is a NonNegative instance</span></span><br><span class="line">        <span class="comment"># instance = x</span></span><br><span class="line">        <span class="comment"># value = val</span></span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Negative value not allowed: %s&quot;</span> % value)</span><br><span class="line">        self.data[instance] = value</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Movie</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#always put descriptors at the class-level</span></span><br><span class="line">    rating = NonNegative(<span class="number">0</span>)</span><br><span class="line">    runtime = NonNegative(<span class="number">0</span>)</span><br><span class="line">    budget = NonNegative(<span class="number">0</span>)</span><br><span class="line">    gross = NonNegative(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, title, rating, runtime, budget, gross)</span>:</span></span><br><span class="line">        self.title = title</span><br><span class="line">        self.rating = rating</span><br><span class="line">        self.runtime = runtime</span><br><span class="line">        self.budget = budget</span><br><span class="line">        self.gross = gross</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">profit</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.gross - self.budget</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x7ED3;&#x5408;&#x4E86;&#x8BBF;&#x95EE;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x5F53;&#x89E3;&#x91CA;&#x5668;&#x9047;&#x5230;&#x5BF9;&#x5C5E;&#x6027;&#x7684;&#x8BBF;&#x95EE;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x8F93;&#x51FA;&#xFF0C;&#x5C31;&#x4F1A;&#x5C06;&#x8BE5;&#x5C5E;&#x6027;&#x770B;&#x4F5C;&#x4E00;&#x4E2A;&#x5E26;&#x6709;<strong>get</strong>&#x65B9;&#x6CD5;&#x7684;&#x63CF;&#x8FF0;&#x7B26;&#xFF1B;&#x5982;&#x679C;&#x662F;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;&#xFF0C;Python&#x5C31;&#x4F1A;&#x8BC6;&#x522B;&#x51FA;&#x8BE5;&#x5C5E;&#x6027;&#x662F;&#x4E00;&#x4E2A;&#x5E26;&#x6709;<strong>set</strong>&#x65B9;&#x6CD5;&#x7684;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x4ECE;&#x800C;&#x6267;&#x884C;Nonnegative&#x7C7B;&#x4E2D;&#x7684;<strong>set</strong>&#x65B9;&#x6CD5;&#x3002;&#x5173;&#x4E8E;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x66F4;&#x591A;&#x4ECB;&#x7ECD;&#xFF0C;&#x63A8;&#x8350;&#x770B;&#x4E00;&#x4E0B;<a href="http://www.geekfan.net/7862/" target="_blank" rel="external">&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;</a>&#x3002;<br>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x518D;&#x6765;&#x8BD5;&#x8BD5;&#x53EF;&#x4E0D;&#x53EF;&#x4EE5;&#x968F;&#x610F;&#x4FEE;&#x6539;&#x5C5E;&#x6027;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = Movie(<span class="string">&apos;Casablanca&apos;</span>, <span class="number">97</span>, <span class="number">102</span>, <span class="number">964000</span>, <span class="number">1300000</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> m.budget  <span class="comment"># calls Movie.budget.__get__(m, Movie)</span></span><br><span class="line"><span class="number">964000</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.budget=<span class="number">300</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.budget</span><br><span class="line"><span class="number">300</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.budget=<span class="number">-24</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">16</span>, <span class="keyword">in</span> __set__</span><br><span class="line">ValueError: Negative value <span class="keyword">not</span> allowed: <span class="number">-24</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x9762;&#x5728;Nonegative&#x7C7B;&#x4E2D;&#x5BF9;&#x6570;&#x503C;&#x662F;&#x5426;&#x4E3A;&#x8D1F;&#x505A;&#x4E86;&#x9650;&#x5B9A;&#xFF0C;&#x901A;&#x8FC7;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#x5C5E;&#x6027;&#x7684;&#x65B9;&#x6CD5;&#x65E0;&#x6CD5;&#x518D;&#x4FEE;&#x6539;&#x5C5E;&#x6027;&#x7684;&#x503C;&#x4E86;&#xFF0C;&#x539F;&#x7406;&#x4E0A;&#x9762;&#x8BF4;&#x8FC7;&#x4E86;&#x3002;&#x4E0D;&#x8FC7;&#x5BF9;&#x4E8E;&#x591A;&#x4E2A;&#x5C5E;&#x6027;&#x6267;&#x884C;&#x4E0D;&#x540C;&#x903B;&#x8F91;&#x7684;getter&#x548C;setter&#x529F;&#x80FD;&#x65F6;&#xFF0C;&#x4E00;&#x4E2A;&#x8BBF;&#x95EE;&#x63CF;&#x8FF0;&#x7B26;&#x5C31;&#x4E0D;&#x8DB3;&#x4EE5;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x5C31;&#x8981;&#x5F15;&#x5165;&#x591A;&#x4E2A;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x770B;&#x95EE;&#x9898;&#x7684;&#x5177;&#x4F53;&#x60C5;&#x51B5;&#x5408;&#x7406;&#x4F7F;&#x7528;&#x3002;</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Python/">Python</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/property/">property</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-python-diffrence-between-staticmethod-and-classmethod" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/19/python-diffrence-between-staticmethod-and-classmethod/" class="article-date">
      <time datetime="2016-05-19T14:46:52.620Z" itemprop="datePublished">2016-05-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/19/python-diffrence-between-staticmethod-and-classmethod/">Python 中@classmethod和@staticmethod的区别</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h4><p>&#x8FD9;&#x662F;stackoverflow&#x4E0A;&#x9762;&#x7684;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x539F;&#x6587;&#x5730;&#x5740;<a href="https://stackoverflow.com/questions/136097/what-is-the-difference-between-staticmethod-and-classmethod-in-python?rq=1" target="_blank" rel="external">What is the difference between @staticmethod and @classmethod in Python?</a>&#xFF0C;&#x73B0;&#x5C06;&#x5176;&#x7FFB;&#x8BD1;&#x4E3A;&#x4E2D;&#x6587;&#xFF0C;&#x653E;&#x5728;&#x4E0B;&#x9762;&#xFF0C;&#x4EC5;&#x4F9B;&#x53C2;&#x8003;&#x3002;</p>
<h4 id="&#x6B63;&#x6587;"><a href="#&#x6B63;&#x6587;" class="headerlink" title="&#x6B63;&#x6587;"></a>&#x6B63;&#x6587;</h4><p><strong>&#x95EE;&#x9898;</strong>&#xFF1A;&#x51FD;&#x6570;&#x7528;@classmethod&#x88C5;&#x9970;&#x548C;&#x7528;@staticmethod&#x88C5;&#x9970;&#x6709;&#x4EC0;&#x4E48;&#x533A;&#x522B;&#xFF1F;<br><strong>&#x56DE;&#x7B54;</strong>&#xFF1A;<br><em>&#x56DE;&#x7B54;&#x4E00;&#xFF1A;unutbu</em>&#xFF1A;&#x5148;&#x4E3E;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x6CE8;&#x610F;foo,class_foo,static_foo&#x8C03;&#x7528;&#x65F6;&#x7684;&#x7279;&#x5F81;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(self,x)</span>:</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;executing foo(%s,%s)&quot;</span>%(self,x)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">class_foo</span><span class="params">(cls,x)</span>:</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;executing class_foo(%s,%s)&quot;</span>%(cls,x)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">static_foo</span><span class="params">(x)</span>:</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;executing static_foo(%s)&quot;</span>%x    </span><br><span class="line"></span><br><span class="line">a=A()</span><br></pre></td></tr></table></figure></p>
<p>&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x7684;&#x5E38;&#x7528;&#x65B9;&#x5F0F;&#xFF0C;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;a&#x4F5C;&#x4E3A;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x88AB;&#x9690;&#x5F0F;&#x5730;&#x4F20;&#x9012;&#x8FC7;&#x53BB;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.foo(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># executing foo(&lt;__main__.A object at 0xb7dbef0c&gt;,1)</span></span><br></pre></td></tr></table></figure></p>
<p>&#x5982;&#x679C;&#x4F7F;&#x7528;@classmethod&#xFF0C;&#x7C7B;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x7684;&#x7C7B;&#x578B;&#x4F5C;&#x4E3A;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x88AB;&#x9690;&#x5F0F;&#x5730;&#x4F20;&#x9012;&#x8FDB;&#x6765;&#x800C;&#x975E;&#x901A;&#x8FC7;self&#x7684;&#x65B9;&#x5F0F;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.class_foo(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># executing class_foo(&lt;class &apos;__main__.A&apos;&gt;,1)</span></span><br></pre></td></tr></table></figure></p>
<p>&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528;class_foo&#x6765;&#x4F7F;&#x7528;&#x7C7B;&#xFF0C;&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x628A;&#x4E00;&#x4E2A;&#x4E1C;&#x897F;&#x5B9A;&#x4E49;&#x6210;classmethod&#xFF0C;&#x90A3;&#x5F88;&#x6709;&#x53EF;&#x80FD;&#x4F60;&#x8BD5;&#x56FE;&#x901A;&#x8FC7;&#x7C7B;&#x800C;&#x975E;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x6765;&#x8C03;&#x7528;&#x5B83;&#x3002;A.foo(1)&#x4F1A;&#x5F15;&#x53D1;TypeError&#x5F02;&#x5E38;&#xFF0C;&#x800C;&#x4F7F;&#x7528;A.class_foo(1)&#x5219;&#x53EF;&#x4EE5;&#x6B63;&#x786E;&#x8FD0;&#x884C;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A.class_foo(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># executing class_foo(&lt;class &apos;__main__.A&apos;&gt;,1)</span></span><br></pre></td></tr></table></figure></p>
<p>&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x7528;&#x9014;&#x5C31;&#x662F;&#x5229;&#x7528;classmethod&#x6765;&#x521B;&#x5EFA;<a href="http://stackoverflow.com/questions/1950414/what-does-classmethod-do-in-this-code/1950927#1950927" target="_blank" rel="external">&#x53EF;&#x7EE7;&#x627F;&#x3001;&#x53EF;&#x66FF;&#x4EE3;&#x7684;&#x6784;&#x9020;&#x5668;</a>&#x3002;</p>
<p>&#x4F7F;&#x7528;staticmethod&#xFF0C;self(&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;)&#x6216;&#x8005;cls&#xFF08;&#x7C7B;&#x578B;&#xFF09;&#x90FD;&#x6CA1;&#x6709;&#x4F5C;&#x4E3A;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x4F20;&#x9012;&#x3002;&#x5B83;&#x770B;&#x8D77;&#x6765;&#x548C;&#x666E;&#x901A;&#x7684;&#x51FD;&#x6570;&#x6CA1;&#x4EC0;&#x4E48;&#x533A;&#x522B;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x80FD;&#x4ECE;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x6216;&#x8005;&#x7C7B;&#x672C;&#x8EAB;&#x8C03;&#x7528;&#x5B83;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a.static_foo(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># executing static_foo(1)</span></span><br><span class="line"></span><br><span class="line">A.static_foo(<span class="string">&apos;hi&apos;</span>)</span><br><span class="line"><span class="comment"># executing static_foo(hi)</span></span><br></pre></td></tr></table></figure></p>
<p>staticmethod&#x7528;&#x6765;&#x5BF9;&#x7C7B;&#x4E0E;&#x7C7B;&#x95F4;&#x6709;&#x5173;&#x8054;&#x7684;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x5206;&#x7EC4;&#x3002;</p>
<p>foo&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x4F46;&#x662F;&#x5F53;&#x4F60;&#x8C03;&#x7528;a.foo&#x65F6;&#x4F60;&#x5E76;&#x4E0D;&#x4F1A;&#x5F97;&#x5230;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x4F60;&#x4F1A;&#x5F97;&#x5230;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x4E00;&#x4E2A;&#x201C;&#x5C40;&#x90E8;&#x9002;&#x7528;&#x201D;&#x7248;&#x672C;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;&#x5176;&#x4E0E;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;a&#x7ED1;&#x5B9A;&#x8D77;&#x6765;&#x3002;foo&#x9700;&#x8981;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x800C;a.foo&#x53EA;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x3002;<br>a&#x548C;foo&#x53D1;&#x751F;&#x4E86;&#x7ED1;&#x5B9A;&#xFF0C;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x7B80;&#x8FF0;&#x4E86;&#x7ED1;&#x5B9A;&#x7684;&#x542B;&#x4E49;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(a.foo)</span><br><span class="line"><span class="comment"># &lt;bound method A.foo of &lt;__main__.A object at 0xb7d52f0c&gt;&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x5982;&#x679C;&#x4F7F;&#x7528;a.class_foo&#xFF0C;&#x5219;a&#x4E0D;&#x4F1A;&#x548C;class_foo&#x53D1;&#x751F;&#x7ED1;&#x5B9A;&#xFF0C;&#x800C;&#x662F;&#x7C7B;A&#x548C;class_foo&#x53D1;&#x751F;&#x4E86;&#x7ED1;&#x5B9A;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(a.class_foo)</span><br><span class="line"><span class="comment"># &lt;bound method type.class_foo of &lt;class &apos;__main__.A&apos;&gt;&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x4F7F;&#x7528;staticmethod&#xFF0C;&#x867D;&#x7136;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x4F46;&#x662F;a.static_foo&#x53EA;&#x662F;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x800C;&#x6CA1;&#x6709;&#x53C2;&#x6570;&#x7684;&#x7ED1;&#x5B9A;&#x3002;static_foo&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x53C2;&#x6570;,a.static_foot&#x540C;&#x6837;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(a.static_foo)</span><br><span class="line"><span class="comment"># &lt;function static_foo at 0xb7d479cc&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x7C7B;&#x4F3C;&#xFF0C;&#x4F7F;&#x7528;A.static_foo&#x65F6;&#x4E5F;&#x4F1A;&#x6709;&#x540C;&#x6837;&#x7684;&#x6548;&#x679C;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(A.static_foo)</span><br><span class="line"><span class="comment"># &lt;function static_foo at 0xb7d479cc&gt;</span></span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Python/">Python</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/classmethod/">classmethod</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/staticmethod/">staticmethod</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-python-documentation-multiprocessing" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/18/python-documentation-multiprocessing/" class="article-date">
      <time datetime="2016-05-18T13:32:41.969Z" itemprop="datePublished">2016-05-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/18/python-documentation-multiprocessing/">Python 文档随译--multiprocessing模块</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h3><p>Python&#x5B98;&#x65B9;&#x6587;&#x6863;&#x4EE5;&#x524D;&#x6CA1;&#x6709;&#x8BA4;&#x771F;&#x8BFB;&#xFF0C;&#x73B0;&#x5728;&#x4ED4;&#x7EC6;&#x8BFB;&#x4E00;&#x904D;&#xFF0C;&#x5E76;&#x4E14;&#x505A;&#x4E00;&#x4E0B;&#x968F;&#x8BD1;&#xFF08;&#x5C31;&#x662F;&#x8BF4;&#x7FFB;&#x8BD1;&#x5730;&#x6BD4;&#x8F83;&#x968F;&#x610F; &#x5475;&#x5475;&#xFF09;&#x3002;&#x6C34;&#x5E73;&#x6709;&#x9650;&#xFF0C;&#x7FFB;&#x8BD1;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x95EE;&#x9898;&#xFF0C;&#x8BF7;&#x81EA;&#x884C;&#x659F;&#x914C;&#x3002;<br>&#x672C;&#x6587;&#x5BF9;&#x5E94;&#x7684;&#x5B98;&#x65B9;&#x6587;&#x6863;&#x94FE;&#x63A5;&#xFF1A;<a href="https://docs.python.org/2.7/library/multiprocessing.html" target="_blank" rel="external">multiprocessing</a></p>
<h3 id="&#x6B63;&#x6587;"><a href="#&#x6B63;&#x6587;" class="headerlink" title="&#x6B63;&#x6587;"></a>&#x6B63;&#x6587;</h3><h4 id="&#x7B80;&#x4ECB;"><a href="#&#x7B80;&#x4ECB;" class="headerlink" title="&#x7B80;&#x4ECB;"></a>&#x7B80;&#x4ECB;</h4><p>multiprocessing&#x6A21;&#x5757;&#x652F;&#x6301;&#x7528;&#x548C;Treading&#x6A21;&#x5757;API&#x76F8;&#x4F3C;&#x7684;&#x8BED;&#x6CD5;&#x751F;&#x6210;&#x8FDB;&#x7A0B;&#x3002;&#x8BE5;&#x6A21;&#x5757;&#x652F;&#x6301;&#x672C;&#x5730;&#x548C;&#x8FDC;&#x7A0B;&#x5E76;&#x53D1;&#xFF0C;&#x5229;&#x7528;subprocesses&#x800C;&#x4E0D;&#x662F;threads&#xFF0C;&#x6709;&#x6548;&#x5730;&#x907F;&#x5F00;&#x4E86;GIL&#x7684;&#x9650;&#x5236;&#x3002;&#x8BE5;&#x6A21;&#x5757;&#x5141;&#x8BB8;&#x7A0B;&#x5E8F;&#x5458;&#x5728;&#x673A;&#x5668;&#x4E0A;&#x5145;&#x5206;&#x5229;&#x7528;&#x591A;&#x4E2A;CPU&#xFF0C;&#x8BE5;&#x6A21;&#x5757;&#x652F;&#x6301;Windows&#x548C;Unix&#x5E73;&#x53F0;&#x3002;</p>
<p>multiprocessing&#x6A21;&#x5757;&#x540C;&#x6837;&#x63D0;&#x4F9B;&#x4E86;Threading&#x6A21;&#x5757;&#x6240;&#x6CA1;&#x6709;&#x7684;&#xFF0C;&#x4F8B;&#x5982;&#x5B83;&#x63D0;&#x4F9B;&#x7684;Pool&#x5BF9;&#x8C61;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x5177;&#x6709;&#x4E00;&#x4E9B;&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x8BA9;&#x591A;&#x4E2A;&#x8F93;&#x5165;&#x6570;&#x636E;&#x5E76;&#x884C;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x901A;&#x8FC7;&#x5C06;&#x6570;&#x636E;&#x5206;&#x914D;&#x5230;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E2D;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;Pool&#x5BF9;&#x8C61;&#x5B9E;&#x73B0;&#x5E76;&#x884C;&#x5316;&#x7684;&#x7B80;&#x5355;&#x4F8B;&#x5B50;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x*x</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    p = Pool(<span class="number">5</span>)</span><br><span class="line">    print(p.map(f, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]))</span><br></pre></td></tr></table></figure></p>
<p>&#x8F93;&#x51FA;&#x4E3A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1, 4, 9]</span><br></pre></td></tr></table></figure></p>
<h4 id="Process&#x7C7B;"><a href="#Process&#x7C7B;" class="headerlink" title="Process&#x7C7B;"></a>Process&#x7C7B;</h4><p>&#x5728;multiprocessing&#x6A21;&#x5757;&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;Process&#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4E14;&#x901A;&#x8FC7;start&#x65B9;&#x6CD5;&#x6765;&#x8C03;&#x7528;&#x5B83;&#x4EEC;&#x3002;Process&#x91C7;&#x7528;threading.Thread&#xFF0C;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x591A;&#x8FDB;&#x7A0B;&#x7684;&#x4F8B;&#x5B50;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(name)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&apos;hello&apos;</span>, name</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    p = Process(target=f, args=(<span class="string">&apos;bob&apos;</span>,))</span><br><span class="line">    p.start()</span><br><span class="line">    p.join()</span><br></pre></td></tr></table></figure></p>
<p>&#x60F3;&#x8981;&#x663E;&#x793A;&#x51FA;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;ID&#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x7167;&#x4E0B;&#x9762;&#x7684;&#x6269;&#x5C55;&#x4F8B;&#x5B50;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">info</span><span class="params">(title)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> title</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&apos;module name:&apos;</span>, __name__</span><br><span class="line">    <span class="keyword">if</span> hasattr(os, <span class="string">&apos;getppid&apos;</span>):  <span class="comment"># only available on Unix</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&apos;parent process:&apos;</span>, os.getppid()</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&apos;process id:&apos;</span>, os.getpid()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(name)</span>:</span></span><br><span class="line">    info(<span class="string">&apos;function f&apos;</span>)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&apos;hello&apos;</span>, name</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    info(<span class="string">&apos;main line&apos;</span>)</span><br><span class="line">    p = Process(target=f, args=(<span class="string">&apos;bob&apos;</span>,))</span><br><span class="line">    p.start()</span><br><span class="line">    p.join()</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x8FDB;&#x7A0B;&#x95F4;&#x4EA4;&#x6362;&#x5BF9;&#x8C61;"><a href="#&#x8FDB;&#x7A0B;&#x95F4;&#x4EA4;&#x6362;&#x5BF9;&#x8C61;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x95F4;&#x4EA4;&#x6362;&#x5BF9;&#x8C61;"></a>&#x8FDB;&#x7A0B;&#x95F4;&#x4EA4;&#x6362;&#x5BF9;&#x8C61;</h4><p>multiprocessing&#x652F;&#x6301;&#x4E24;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x4EA4;&#x6362;&#x901A;&#x9053;&#x3002;</p>
<p><strong>Queue</strong><br>Queue&#x7C7B;&#x51E0;&#x4E4E;&#x5C31;&#x662F;Queue.Queue&#x7C7B;&#x7684;&#x514B;&#x9686;&#xFF0C;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Queue</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(q)</span>:</span></span><br><span class="line">    q.put([<span class="number">42</span>, <span class="keyword">None</span>, <span class="string">&apos;hello&apos;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    q = Queue()</span><br><span class="line">    p = Process(target=f, args=(q,))</span><br><span class="line">    p.start()</span><br><span class="line">    <span class="keyword">print</span> q.get()    <span class="comment"># prints &quot;[42, None, &apos;hello&apos;]&quot;</span></span><br><span class="line">    p.join()</span><br></pre></td></tr></table></figure></p>
<p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#xFF0C;Queue&#x65E2;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x540C;&#x65F6;&#x53C8;&#x662F;&#x8FDB;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x3002;</p>
<p><strong>Pipes</strong><br>pipe&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x4E00;&#x5BF9;&#x8FDE;&#x63A5;&#x5BF9;&#x8C61;&#xFF0C;&#x5B83;&#x4EEC;&#x662F;&#x7BA1;&#x9053;&#x7684;&#x4E24;&#x7AEF;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;&#x53CC;&#x5411;&#x7684;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x4E2A;&#x4F8B;&#x5B50;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Pipe</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(conn)</span>:</span></span><br><span class="line">    conn.send([<span class="number">42</span>, <span class="keyword">None</span>, <span class="string">&apos;hello&apos;</span>])</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    parent_conn, child_conn = Pipe()</span><br><span class="line">    p = Process(target=f, args=(child_conn,))</span><br><span class="line">    p.start()</span><br><span class="line">    <span class="keyword">print</span> parent_conn.recv()   <span class="comment"># prints &quot;[42, None, &apos;hello&apos;]&quot;</span></span><br><span class="line">    p.join()</span><br></pre></td></tr></table></figure></p>
<p>pipe&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x7684;&#x4E24;&#x4E2A;&#x8FDE;&#x63A5;&#x5BF9;&#x8C61;&#x8868;&#x793A;&#x7BA1;&#x9053;&#x7684;&#x4E24;&#x7AEF;&#xFF0C;&#x6BCF;&#x4E2A;&#x8FDE;&#x63A5;&#x5BF9;&#x8C61;&#x90FD;&#x6709;send()&#x548C;recv()&#x65B9;&#x6CD5;&#x3002;&#x6CE8;&#x610F;&#x5982;&#x679C;&#x7BA1;&#x9053;&#x7684;&#x4E24;&#x7AEF;&#x540C;&#x65F6;&#x4ECE;&#x5BF9;&#x65B9;&#x63A5;&#x6536;&#x6216;&#x8005;&#x540C;&#x65F6;&#x5411;&#x5BF9;&#x65B9;&#x53D1;&#x9001;&#x6570;&#x636E;&#x5219;&#x4F1A;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x88AB;&#x7834;&#x574F;&#x3002;</p>
<h4 id="&#x8FDB;&#x7A0B;&#x540C;&#x6B65;"><a href="#&#x8FDB;&#x7A0B;&#x540C;&#x6B65;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x540C;&#x6B65;"></a>&#x8FDB;&#x7A0B;&#x540C;&#x6B65;</h4><p>multiprocessing&#x63D0;&#x4F9B;&#x4E86;&#x548C;threading&#x6A21;&#x5757;&#x7B49;&#x4EF7;&#x7684;&#x540C;&#x6B65;&#x539F;&#x8BED;&#x3002;&#x4F8B;&#x5982;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x9501;&#x6765;&#x786E;&#x4FDD;&#x67D0;&#x4E00;&#x65F6;&#x523B;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5411;&#x7EC8;&#x7AEF;&#x8F93;&#x51FA;&#x4FE1;&#x606F;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Lock</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(l, i)</span>:</span></span><br><span class="line">    l.acquire()</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&apos;hello world&apos;</span>, i</span><br><span class="line">    l.release()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    lock = Lock()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        Process(target=f, args=(lock, num)).start()</span><br></pre></td></tr></table></figure></p>
<p>&#x5982;&#x679C;&#x4E0D;&#x4F7F;&#x7528;&#x9501;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x5C31;&#x4F1A;&#x6DF7;&#x6742;&#x5728;&#x4E00;&#x8D77;&#x3002;</p>
<h4 id="&#x8FDB;&#x7A0B;&#x95F4;&#x5171;&#x4EAB;&#x72B6;&#x6001;"><a href="#&#x8FDB;&#x7A0B;&#x95F4;&#x5171;&#x4EAB;&#x72B6;&#x6001;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x95F4;&#x5171;&#x4EAB;&#x72B6;&#x6001;"></a>&#x8FDB;&#x7A0B;&#x95F4;&#x5171;&#x4EAB;&#x72B6;&#x6001;</h4><p>&#x6211;&#x4EEC;&#x5728;&#x8FDB;&#x884C;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x65F6;&#x6700;&#x597D;&#x907F;&#x514D;&#x5206;&#x4EAB;&#x72B6;&#x6001;&#xFF0C;&#x518D;&#x4F7F;&#x7528;&#x591A;&#x8FDB;&#x7A0B;&#x65F6;&#x5C24;&#x5176;&#x8981;&#x6CE8;&#x610F;&#x3002;<br>&#x5982;&#x679C;&#x975E;&#x8981;&#x8FD9;&#x4E48;&#x505A;&#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x7167;&#x4E0B;&#x9762;&#x7ED9;&#x51FA;&#x7684; &#x4E24;&#x79CD;&#x65B9;&#x5F0F;<br><strong>&#x5171;&#x4EAB;&#x5185;&#x5B58;</strong><br>&#x53EF;&#x4EE5;&#x7528;Value&#x6216;&#x8005;Array&#x7C7B;&#x5728;&#x5171;&#x4EAB;&#x5B58;&#x50A8;&#x533A;&#x5B58;&#x50A8;&#x6570;&#x636E;&#xFF0C;&#x4F8B;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from multiprocessing import Process, Value, Array</span><br><span class="line"></span><br><span class="line">def f(n, a):</span><br><span class="line">    n.value = 3.1415927</span><br><span class="line">    for i in range(len(a)):</span><br><span class="line">        a[i] = -a[i]</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    num = Value(&apos;d&apos;, 0.0)</span><br><span class="line">    arr = Array(&apos;i&apos;, range(10))</span><br><span class="line"></span><br><span class="line">    p = Process(target=f, args=(num, arr))</span><br><span class="line">    p.start()</span><br><span class="line">    p.join()</span><br><span class="line"></span><br><span class="line">    print num.value</span><br><span class="line">    print arr[:]</span><br></pre></td></tr></table></figure></p>
<p>&#x7A0B;&#x5E8F;&#x5C06;&#x4F1A;&#x6253;&#x5370;&#x5982;&#x4E0B;&#x7684;&#x5185;&#x5BB9;&#xFF1A;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3.1415927</span></span><br><span class="line">[<span class="number">0</span>, <span class="number">-1</span>, <span class="number">-2</span>, <span class="number">-3</span>, <span class="number">-4</span>, <span class="number">-5</span>, <span class="number">-6</span>, <span class="number">-7</span>, <span class="number">-8</span>, <span class="number">-9</span>]</span><br><span class="line">```		</span><br><span class="line">&#x53C2;&#x6570;d&#x548C;i&#x5728;&#x521B;&#x5EFA;num&#x548C;arr&#x65F6;&#x88AB;array&#x6A21;&#x5757;&#x5F53;&#x505A;&#x5B57;&#x8282;&#x7801;&#x4F7F;&#x7528;&#xFF0C;d&#x8868;&#x660E;&#x662F;&#x4E00;&#x4E2A;&#x53CC;&#x7CBE;&#x5EA6;&#x6D6E;&#x70B9;&#x6570;&#xFF0C;&#x800C;i&#x5219;&#x6307;&#x660E;&#x4E00;&#x4E2A;&#x6709;&#x7B26;&#x53F7;&#x7684;&#x6574;&#x6570;&#x7C7B;&#x578B;&#x3002;&#x8FD9;&#x4E9B;&#x5171;&#x4EAB;&#x5BF9;&#x8C61;&#x662F;&#x7EBF;&#x7A0B;&#x548C;&#x8FDB;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x3002;</span><br><span class="line">&#x60F3;&#x8981;&#x66F4;&#x7075;&#x6D3B;&#x5F97;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;multiprocessing.sharedctypes,&#x5B83;&#x652F;&#x6301;&#x4ECE;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x521B;&#x5EFA;&#x4E13;&#x95E8;&#x7684;ctype&#x5BF9;&#x8C61;&#x3002;</span><br><span class="line"></span><br><span class="line"><span class="comment">##&#x670D;&#x52A1;&#x8FDB;&#x7A0B;##</span></span><br><span class="line">&#x7531;Manager()&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x7684;manager&#x5BF9;&#x8C61;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x63A7;&#x5236;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x8FDB;&#x7A0B;&#xFF0C;&#x5B83;&#x80FD;&#x7BA1;&#x7406;Python&#x5BF9;&#x8C61;&#x5E76;&#x4E14;&#x5141;&#x8BB8;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x901A;&#x8FC7;&#x4EE3;&#x7406;&#x64CD;&#x4F5C;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x3002;</span><br><span class="line">&#x7531;Manager()&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x7684;manager&#x5BF9;&#x8C61;&#x652F;&#x6301;&#x4EE5;&#x4E0B;&#x8FD9;&#x4E9B;&#x7C7B;&#x578B;&#xFF1A;list, dict, Namespace, Lock, RLock, Semaphore, BoundedSemaphore, Condition, Event, Queue, Value <span class="keyword">and</span> Array&#x3002;&#x4E0B;&#x9762;&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;</span><br><span class="line">``` Python</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Manager</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(d, l)</span>:</span></span><br><span class="line">    d[<span class="number">1</span>] = <span class="string">&apos;1&apos;</span></span><br><span class="line">    d[<span class="string">&apos;2&apos;</span>] = <span class="number">2</span></span><br><span class="line">    d[<span class="number">0.25</span>] = <span class="keyword">None</span></span><br><span class="line">    l.reverse()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    manager = Manager()</span><br><span class="line"></span><br><span class="line">    d = manager.dict()</span><br><span class="line">    l = manager.list(range(<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line">    p = Process(target=f, args=(d, l))</span><br><span class="line">    p.start()</span><br><span class="line">    p.join()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> d</span><br><span class="line">    <span class="keyword">print</span> l</span><br></pre></td></tr></table></figure>
<p>&#x4EE5;&#x4E0A;&#x4EE3;&#x7801;&#x5C06;&#x6253;&#x5370;&#x51FA;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">{0.25: None, 1: &apos;1&apos;, &apos;2&apos;: 2}</span><br><span class="line">[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]</span><br></pre></td></tr></table></figure></p>
<p>&#x670D;&#x52A1;&#x8FDB;&#x7A0B;&#x7BA1;&#x7406;&#x76F8;&#x5BF9;&#x4E8E;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x5177;&#x6709;&#x66F4;&#x9AD8;&#x7684;&#x7075;&#x6D3B;&#x6027;&#x56E0;&#x4E3A;&#x5B83;&#x652F;&#x6301;Python&#x4E2D;&#x539F;&#x751F;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF1B;&#x540C;&#x65F6;&#x4E00;&#x4E2A;manager&#x5BF9;&#x8C61;&#x53EF;&#x4EE5;&#x4E3A;&#x7F51;&#x7EDC;&#x4E0A;&#x4E0D;&#x540C;&#x8BA1;&#x7B97;&#x673A;&#x4E0A;&#x7684;&#x8FDB;&#x7A0B;&#x6240;&#x5171;&#x4EAB;&#xFF0C;&#x4F46;&#x7F3A;&#x70B9;&#x662F;&#x6BD4;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x8981;&#x6162;&#x3002;</p>
<h4 id="&#x4F7F;&#x7528;workers&#x6C60;"><a href="#&#x4F7F;&#x7528;workers&#x6C60;" class="headerlink" title="&#x4F7F;&#x7528;workers&#x6C60;"></a>&#x4F7F;&#x7528;workers&#x6C60;</h4><p>Pool&#x7C7B;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x5DE5;&#x4F5C;&#x8FDB;&#x7A0B;&#x6C60;&#xFF0C;&#x5B83;&#x63D0;&#x4F9B;&#x4E86;&#x51E0;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x65B9;&#x6CD5;&#x5C06;&#x4EFB;&#x52A1;&#x5206;&#x53D1;&#x5230;&#x5404;&#x4E2A;&#x8FDB;&#x7A0B;&#x3002;&#x4F8B;&#x5982;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool, TimeoutError</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x*x</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    pool = Pool(processes=<span class="number">4</span>)              <span class="comment"># start 4 worker processes</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># print &quot;[0, 1, 4,..., 81]&quot;</span></span><br><span class="line">    <span class="keyword">print</span> pool.map(f, range(<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># print same numbers in arbitrary order</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> pool.imap_unordered(f, range(<span class="number">10</span>)):</span><br><span class="line">        <span class="keyword">print</span> i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># evaluate &quot;f(20)&quot; asynchronously</span></span><br><span class="line">    res = pool.apply_async(f, (<span class="number">20</span>,))      <span class="comment"># runs in *only* one process</span></span><br><span class="line">    <span class="keyword">print</span> res.get(timeout=<span class="number">1</span>)              <span class="comment"># prints &quot;400&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># evaluate &quot;os.getpid()&quot; asynchronously</span></span><br><span class="line">    res = pool.apply_async(os.getpid, ()) <span class="comment"># runs in *only* one process</span></span><br><span class="line">    <span class="keyword">print</span> res.get(timeout=<span class="number">1</span>)              <span class="comment"># prints the PID of that process</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># launching multiple evaluations asynchronously *may* use more processes</span></span><br><span class="line">    multiple_results = [pool.apply_async(os.getpid, ()) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>)]</span><br><span class="line">    <span class="keyword">print</span> [res.get(timeout=<span class="number">1</span>) <span class="keyword">for</span> res <span class="keyword">in</span> multiple_results]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># make a single worker sleep for 10 secs</span></span><br><span class="line">    res = pool.apply_async(time.sleep, (<span class="number">10</span>,))</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">print</span> res.get(timeout=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> TimeoutError:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;We lacked patience and got a multiprocessing.TimeoutError&quot;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x6CE8;&#x610F;&#xFF1A;pool&#x7684;&#x65B9;&#x6CD5;&#x7EDD;&#x5BF9;&#x4E0D;&#x80FD;&#x88AB;&#x521B;&#x5EFA;&#x5B83;&#x7684;&#x8FDB;&#x7A0B;&#x6240;&#x4F7F;&#x7528;&#x3002;<br><strong>&#x6CE8;&#x610F;</strong>&#xFF1A;&#x8FD9;&#x4E2A;&#x5305;&#x4E0B;&#x9762;&#x7684;&#x529F;&#x80FD;&#x9700;&#x8981;&#x786E;&#x4FDD;<strong>main</strong>&#x6A21;&#x5757;&#x5BF9;&#x4E8E;&#x5B50;&#x8FDB;&#x7A0B;&#x662F;&#x53EF;&#x4EE5;&#x5BFC;&#x5165;&#x7684;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5728;&#x4E00;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x7A0B;&#x5E8F;&#x4E0D;&#x80FD;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#xFF0C;&#x4F8B;&#x5982;&#x5728;&#x4EA4;&#x4E92;&#x6A21;&#x5F0F;&#x4E0B;&#xFF0C;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = Pool(<span class="number">5</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">return</span> x*x</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.map(f, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">Process PoolWorker<span class="number">-1</span>:</span><br><span class="line">Process PoolWorker<span class="number">-2</span>:</span><br><span class="line">Process PoolWorker<span class="number">-3</span>:</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">AttributeError: <span class="string">&apos;module&apos;</span> object has no attribute <span class="string">&apos;f&apos;</span></span><br><span class="line">AttributeError: <span class="string">&apos;module&apos;</span> object has no attribute <span class="string">&apos;f&apos;</span></span><br><span class="line">AttributeError: <span class="string">&apos;module&apos;</span> object has no attribute <span class="string">&apos;f&apos;</span></span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Python/">Python</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/multiprocessing/">multiprocessing</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-python-queue" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/15/python-queue/" class="article-date">
      <time datetime="2016-05-15T05:29:24.341Z" itemprop="datePublished">2016-05-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/15/python-queue/">Python Queue介绍</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h3><p>Python&#x4E2D;&#x7684;Queue&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x540C;&#x6B65;&#x961F;&#x5217;&#xFF0C;&#x5E76;&#x4E14;&#x8BE5;&#x7C7B;&#x5B9E;&#x73B0;&#x4E86;&#x6240;&#x6709;&#x9700;&#x8981;&#x7684;&#x9501;&#x539F;&#x8BED;&#x3002;Queue&#x5B9E;&#x73B0;&#x4E86;&#x4E09;&#x79CD;&#x961F;&#x5217;&#xFF1A;&#x666E;&#x901A;&#x7684;FIFO&#x961F;&#x5217;&#xFF08;Queue&#xFF09;&#x3001;LIFO&#x961F;&#x5217;&#xFF08;LifoQueue&#xFF09;&#x3001;&#x4F18;&#x5148;&#x7EA7;&#x961F;&#x5217;&#xFF08;PriorityQueue&#xFF09;&#x3002;&#x5176;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x7C7B;&#x4F3C;&#xFF0C;&#x4E0B;&#x9762;&#x4EE5;&#x666E;&#x901A;&#x7684;&#x5148;&#x8FDB;&#x5148;&#x51FA;&#x961F;&#x5217;Queue&#x4E3A;&#x4F8B;&#x8C08;&#x4E00;&#x4E0B;Queue&#x4E2D;&#x7684;&#x4E3B;&#x8981;&#x65B9;&#x6CD5;</p>
<h4 id="Queue&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x53CA;&#x4F7F;&#x7528;"><a href="#Queue&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x53CA;&#x4F7F;&#x7528;" class="headerlink" title="Queue&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x53CA;&#x4F7F;&#x7528;"></a>Queue&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x53CA;&#x4F7F;&#x7528;</h4><p>&#x4F7F;&#x7528;Queue<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&#x5F15;&#x5165;Queue&#x7C7B;</span></span><br><span class="line"><span class="keyword">from</span> Queue <span class="keyword">import</span> Queue</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x5F97;&#x5230;&#x961F;&#x5217;&#x7684;&#x5927;&#x5C0F;</span></span><br><span class="line">Queue.qsize()</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x5224;&#x65AD;&#x961F;&#x5217;&#x662F;&#x5426;&#x4E3A;&#x7A7A;</span></span><br><span class="line">Queue.empty()</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x5224;&#x65AD;&#x961F;&#x5217;&#x662F;&#x5426;&#x5DF2;&#x6EE1;</span></span><br><span class="line">Queue.full()</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x4ECE;&#x961F;&#x5217;&#x5934;&#x83B7;&#x53D6;&#x5143;&#x7D20;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;&#x963B;&#x585E;</span></span><br><span class="line">Queue.get([block[,timeout]])</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x4ECE;&#x961F;&#x5217;&#x5934;&#x83B7;&#x53D6;&#x5143;&#x7D20;&#xFF0C;&#x975E;&#x963B;&#x585E;&#x65B9;&#x5F0F;</span></span><br><span class="line">Queue.get_nowait()</span><br><span class="line"><span class="comment">#&#x6216;&#x8005;</span></span><br><span class="line">Queue.get(block=<span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x963B;&#x585E;&#x5199;&#x5165;&#x961F;&#x5217;</span></span><br><span class="line">Queue.put(item)</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x975E;&#x963B;&#x585E;&#x5199;&#x5165;&#x961F;&#x5217;</span></span><br><span class="line">Queue.put_nowait(item)</span><br><span class="line"><span class="comment">#&#x6216;&#x8005;</span></span><br><span class="line">Queue.put(item,block=<span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x5411;&#x961F;&#x5217;&#x4E2D;&#x5DF2;&#x5B8C;&#x6210;&#x7684;&#x5143;&#x7D20;&#x53D1;&#x9001;join&#x4FE1;&#x53F7;</span></span><br><span class="line">Queue.task_done()</span><br></pre></td></tr></table></figure></p>
<p>&#x4E0A;&#x9762;&#x4ECE;&#x961F;&#x5217;&#x4E2D;&#x83B7;&#x53D6;&#x5143;&#x7D20;&#x548C;&#x5411;&#x961F;&#x5217;&#x4E2D;&#x6DFB;&#x52A0;&#x5143;&#x7D20;&#x90FD;&#x6709;&#x963B;&#x585E;&#x548C;&#x975E;&#x963B;&#x585E;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x91C7;&#x7528;&#x963B;&#x585E;&#x65B9;&#x5F0F;&#xFF0C;&#x5982;&#x679C;&#x4ECE;&#x961F;&#x5217;&#x4E2D;&#x53D6;&#x5143;&#x7D20;&#x800C;&#x5143;&#x7D20;&#x4E3A;&#x7A7A;&#xFF0C;&#x5219;&#x7EBF;&#x7A0B;&#x4F1A;&#x505C;&#x4E0B;&#x6765;&#x7B49;&#x5F85;&#x77E5;&#x9053;&#x961F;&#x5217;&#x4E2D;&#x6709;&#x5143;&#x7D20;&#x53EF;&#x4EE5;&#x53D6;&#x51FA;&#xFF1B;&#x5982;&#x679C;&#x5411;&#x961F;&#x5217;&#x4E2D;&#x6DFB;&#x52A0;&#x5143;&#x7D20;&#x800C;&#x6B64;&#x65F6;&#x961F;&#x5217;&#x5DF2;&#x6EE1;&#xFF0C;&#x5219;&#x540C;&#x6837;&#x7EBF;&#x7A0B;&#x4F1A;&#x505C;&#x4E0B;&#x6765;&#x76F4;&#x5230;&#x505C;&#x6B62;&#x3002;&#x5982;&#x679C;&#x91C7;&#x7528;&#x975E;&#x963B;&#x585E;&#x65B9;&#x5F0F;&#xFF0C;&#x53D6;&#x5143;&#x7D20;&#x65F6;&#x4E00;&#x65E6;&#x961F;&#x5217;&#x4E3A;&#x7A7A;&#xFF0C;&#x5219;&#x4F1A;&#x5F15;&#x53D1;Empty&#x5F02;&#x5E38;&#xFF0C;&#x653E;&#x5143;&#x7D20;&#x65F6;&#x4E00;&#x65E6;&#x961F;&#x5217;&#x5DF2;&#x6EE1;&#xFF0C;&#x5C31;&#x4F1A;&#x5F15;&#x53D1;Full&#x5F02;&#x5E38;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x662F;&#x91C7;&#x7528;Queue&#x5B9E;&#x73B0;&#x7684;&#x7ECF;&#x5178;&#x751F;&#x4EA7;&#x8005;&#x6D88;&#x8D39;&#x8005;&#x95EE;&#x9898;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x6765;&#x6E90;&#xFF1A;<a href="http://blog.itpub.net/22664653/viewspace-764044/" target="_blank" rel="external">Python&#x6A21;&#x5757;&#x4E4B;Queue</a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Queue <span class="keyword">import</span> Queue</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment">#Producer thread</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span><span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, t_name, queue)</span>:</span></span><br><span class="line">        threading.Thread.__init__(self, name=t_name)</span><br><span class="line">        self.data=queue</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">            <span class="keyword">print</span> <span class="string">&quot;%s: %s is producing %d to the queue!&quot;</span> %(time.ctime(), self.getName(), i)</span><br><span class="line">            self.data.put(i)</span><br><span class="line">            time.sleep(random.randrange(<span class="number">10</span>)/<span class="number">5</span>)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;%s: %s finished!&quot;</span> %(time.ctime(), self.getName())</span><br><span class="line"></span><br><span class="line"><span class="comment">#Consumer thread</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span><span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, t_name, queue)</span>:</span></span><br><span class="line">        threading.Thread.__init__(self, name=t_name)</span><br><span class="line">        self.data=queue</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">            val = self.data.get()</span><br><span class="line">            <span class="keyword">print</span> <span class="string">&quot;%s: %s is consuming. %d in the queue is consumed!&quot;</span> %(time.ctime(), self.getName(), val)</span><br><span class="line">            time.sleep(random.randrange(<span class="number">10</span>))</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;%s: %s finished!&quot;</span> %(time.ctime(), self.getName())</span><br><span class="line"></span><br><span class="line"><span class="comment">#Main thread</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    queue = Queue()</span><br><span class="line">    producer = Producer(<span class="string">&apos;Pro.&apos;</span>, queue)</span><br><span class="line">    consumer = Consumer(<span class="string">&apos;Con.&apos;</span>, queue)</span><br><span class="line">    producer.start()</span><br><span class="line">    consumer.start()</span><br><span class="line">    producer.join()</span><br><span class="line">    consumer.join()</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&apos;All threads terminate!&apos;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p>
<p>&#x6700;&#x540E;&#x9644;&#x4E0A;Queue&#x6A21;&#x5757;&#x7684;&#x6E90;&#x7801;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;A multi-producer, multi-consumer queue.&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time <span class="keyword">as</span> _time</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">import</span> threading <span class="keyword">as</span> _threading          <span class="comment"># &#x5BFC;&#x5165;threading&#x6A21;&#x5757;</span></span><br><span class="line"><span class="keyword">except</span> ImportError:</span><br><span class="line">    <span class="keyword">import</span> dummy_threading <span class="keyword">as</span> _threading    <span class="comment"># &#x8BE5;&#x6A21;&#x5757;&#x7684;&#x63A5;&#x53E3;&#x548C;thread&#x76F8;&#x540C;&#xFF0C;&#x5728;&#x6CA1;&#x6709;&#x5B9E;&#x73B0;thread&#x6A21;&#x5757;&#x7684;&#x5E73;&#x53F0;&#x4E0A;&#x63D0;&#x4F9B;thread&#x6A21;&#x5757;&#x7684;&#x529F;&#x80FD;&#x3002;</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque               <span class="comment"># https://github.com/BeginMan/pythonStdlib/blob/master/collections.md</span></span><br><span class="line"><span class="keyword">import</span> heapq                                <span class="comment"># &#x5806;&#x6392;&#x5E8F; https://github.com/qiwsir/algorithm/blob/master/heapq.md</span></span><br><span class="line"></span><br><span class="line">__all__ = [<span class="string">&apos;Empty&apos;</span>, <span class="string">&apos;Full&apos;</span>, <span class="string">&apos;Queue&apos;</span>, <span class="string">&apos;PriorityQueue&apos;</span>, <span class="string">&apos;LifoQueue&apos;</span>]  <span class="comment"># &#x6A21;&#x5757;&#x7EA7;&#x522B;&#x66B4;&#x9732;&#x63A5;&#x53E3;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Empty</span><span class="params">(Exception)</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;&#x5F53;&#x8C03;&#x7528;Queue.get(block=0)/get_nowait()&#x65F6;&#x89E6;&#x53D1;Empty&#x5F02;&#x5E38;</span><br><span class="line"></span><br><span class="line">    &#x8C03;&#x7528;&#x961F;&#x5217;&#x5BF9;&#x8C61;&#x7684;get()&#x65B9;&#x6CD5;&#x4ECE;&#x961F;&#x5934;&#x5220;&#x9664;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x9879;&#x76EE;&#x3002;&#x53EF;&#x9009;&#x53C2;&#x6570;&#x4E3A;block&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;True&#x3002;</span><br><span class="line">    &#x5982;&#x679C;&#x961F;&#x5217;&#x4E3A;&#x7A7A;&#x4E14;block&#x4E3A;True&#xFF0C;get()&#x5C31;&#x4F7F;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x6682;&#x505C;&#xFF0C;&#x76F4;&#x81F3;&#x6709;&#x9879;&#x76EE;&#x53EF;&#x7528;&#x3002;</span><br><span class="line">    &#x5982;&#x679C;&#x961F;&#x5217;&#x4E3A;&#x7A7A;&#x4E14;block&#x4E3A;False&#xFF0C;&#x961F;&#x5217;&#x5C06;&#x5F15;&#x53D1;Empty&#x5F02;&#x5E38;</span><br><span class="line">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Full</span><span class="params">(Exception)</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;&#x5F53;&#x8C03;&#x7528;Queue.put(block=0)/put_nowait()&#x65F6;&#x89E6;&#x53D1;Full&#x5F02;&#x5E38;</span><br><span class="line"></span><br><span class="line">    &#x5982;&#x679C;&#x961F;&#x5217;&#x5F53;&#x524D;&#x4E3A;&#x7A7A;&#x4E14;block&#x4E3A;1&#xFF0C;put()&#x65B9;&#x6CD5;&#x5C31;&#x4F7F;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x6682;&#x505C;,&#x76F4;&#x5230;&#x7A7A;&#x51FA;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5355;&#x5143;&#x3002;</span><br><span class="line">    &#x5982;&#x679C;block&#x4E3A;0&#xFF0C;put&#x65B9;&#x6CD5;&#x5C06;&#x5F15;&#x53D1;Full&#x5F02;&#x5E38;&#x3002;</span><br><span class="line">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7ED9;&#x5B9A;&#x7684;&#x6700;&#x5927;&#x5927;&#x5C0F;&#x7684;&#x961F;&#x5217;&#x5BF9;&#x8C61;.</span><br><span class="line"></span><br><span class="line">    FIFO(&#x5148;&#x8FDB;&#x5148;&#x51FA;)&#x961F;&#x5217;, &#x7B2C;&#x4E00;&#x52A0;&#x5165;&#x961F;&#x5217;&#x7684;&#x4EFB;&#x52A1;, &#x88AB;&#x7B2C;&#x4E00;&#x4E2A;&#x53D6;&#x51FA;</span><br><span class="line">    If maxsize is &lt;= 0, the queue size is &#x65E0;&#x9650;&#x5927;&#x5C0F;.</span><br><span class="line">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, maxsize=<span class="number">0</span>)</span>:</span></span><br><span class="line">        self.maxsize = maxsize</span><br><span class="line">        self._init(maxsize)             <span class="comment"># &#x521D;&#x59CB;&#x5316;queue&#x4E3A;&#x7A7A;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># &#x6240;&#x6709;&#x83B7;&#x53D6;&#x9501;&#x7684;&#x65B9;&#x6CD5;&#x5FC5;&#x987B;&#x5728;&#x8FD4;&#x56DE;&#x4E4B;&#x524D;&#x5148;&#x91CA;&#x653E;&#xFF0C;&#x4E92;&#x65A5;&#x9501;&#x5728;&#x4E0B;&#x9762;&#x4E09;&#x4E2A;Condition&#x6761;&#x4EF6;&#x5171;&#x4EAB;</span></span><br><span class="line">        <span class="comment"># &#x4ECE;&#x800C;&#x83B7;&#x53D6;&#x548C;&#x91CA;&#x653E;&#x7684;&#x6761;&#x4EF6;&#x4E0B;&#x4E5F;&#x83B7;&#x5F97;&#x548C;&#x91CA;&#x653E;&#x4E92;&#x65A5;&#x9501;&#x3002;</span></span><br><span class="line">        self.mutex = _threading.Lock()  <span class="comment"># Lock&#x9501;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># &#x5F53;&#x6DFB;&#x52A0;queue&#x5143;&#x7D20;&#x65F6;&#x901A;&#x77E5;`not_empty`,&#x4E4B;&#x540E;&#x7EBF;&#x7A0B;&#x7B49;&#x5F85;get</span></span><br><span class="line">        self.not_empty = _threading.Condition(self.mutex)       <span class="comment"># not_empty Condition&#x5B9E;&#x4F8B;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># &#x5F53;&#x79FB;&#x9664;queue&#x5143;&#x7D20;&#x65F6;&#x901A;&#x77E5;`not_full`,&#x4E4B;&#x540E;&#x7EBF;&#x7A0B;&#x7B49;&#x5F85;put.</span></span><br><span class="line">        self.not_full = _threading.Condition(self.mutex)        <span class="comment"># not_full Condition&#x5B9E;&#x4F8B;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># &#x5F53;&#x672A;&#x5B8C;&#x6210;&#x7684;&#x4EFB;&#x52A1;&#x6570;&#x4E3A;0&#x65F6;&#xFF0C;&#x901A;&#x77E5;`all_tasks_done`,&#x7EBF;&#x7A0B;&#x7B49;&#x5F85;join()</span></span><br><span class="line">        self.all_tasks_done = _threading.Condition(self.mutex)  <span class="comment"># all_tasks_done Condition&#x5B9E;&#x4F8B;</span></span><br><span class="line">        self.unfinished_tasks = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">task_done</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;&#x8868;&#x660E;&#xFF0C;&#x4EE5;&#x524D;&#x6392;&#x961F;&#x7684;&#x4EFB;&#x52A1;&#x5B8C;&#x6210;&#x4E86;</span><br><span class="line"></span><br><span class="line">        &#x88AB;&#x6D88;&#x8D39;&#x8005;&#x7EBF;&#x7A0B;&#x4F7F;&#x7528;. &#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;get()&#xFF0C;&#x968F;&#x540E;&#x8C03;&#x7528;task_done()&#x544A;&#x77E5;queue&#x8FD9;&#x4E2A;task&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;</span><br><span class="line">        &quot;&quot;&quot;</span></span><br><span class="line">        self.all_tasks_done.acquire()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># unfinished_tasks &#x7D2F;&#x51CF;</span></span><br><span class="line">            unfinished = self.unfinished_tasks - <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> unfinished &lt;= <span class="number">0</span>:</span><br><span class="line">                <span class="comment"># &#x8C03;&#x7528;&#x591A;&#x6B21;task_done&#x5219;&#x89E6;&#x53D1;&#x5F02;&#x5E38;</span></span><br><span class="line">                <span class="keyword">if</span> unfinished &lt; <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">raise</span> ValueError(<span class="string">&apos;task_done() called too many times&apos;</span>)</span><br><span class="line">                self.all_tasks_done.notify_all()    <span class="comment"># &#x91CA;&#x653E;&#x6240;&#x6709;&#x7B49;&#x5F85;&#x8BE5;&#x6761;&#x4EF6;&#x7684;&#x7EBF;&#x7A0B;</span></span><br><span class="line">            self.unfinished_tasks = unfinished</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            self.all_tasks_done.release()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">join</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;&#x963B;&#x585E;&#x76F4;&#x5230;&#x6240;&#x6709;&#x4EFB;&#x52A1;&#x90FD;&#x5904;&#x7406;&#x5B8C;&#x6210;</span><br><span class="line">        &#x672A;&#x5B8C;&#x6210;&#x7684;task&#x4F1A;&#x5728;put()&#x7D2F;&#x52A0;&#xFF0C;&#x5728;task_done()&#x7D2F;&#x51CF;, &#x4E3A;0&#x65F6;&#xFF0C;join()&#x975E;&#x963B;&#x585E;.</span><br><span class="line">        &quot;&quot;&quot;</span></span><br><span class="line">        self.all_tasks_done.acquire()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># &#x4E00;&#x76F4;&#x5FAA;&#x73AF;&#x68C0;&#x67E5;&#x672A;&#x5B8C;&#x6210;&#x6570;</span></span><br><span class="line">            <span class="keyword">while</span> self.unfinished_tasks:</span><br><span class="line">                self.all_tasks_done.wait()</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            self.all_tasks_done.release()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">qsize</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;&#x8FD4;&#x56DE;&#x961F;&#x5217;&#x7684;&#x8FD1;&#x4F3C;&#x5927;&#x5C0F;&#xFF08;&#x4E0D;&#x53EF;&#x9760;&#xFF01;&#xFF09;&quot;&quot;&quot;</span></span><br><span class="line">        self.mutex.acquire()</span><br><span class="line">        n = self._qsize()       <span class="comment"># len(queue)</span></span><br><span class="line">        self.mutex.release()</span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">empty</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;&#x961F;&#x5217;&#x662F;&#x5426;&#x4E3A;&#x7A7A;(&#x4E0D;&#x53EF;&#x9760;).&quot;&quot;&quot;</span></span><br><span class="line">        self.mutex.acquire()</span><br><span class="line">        n = <span class="keyword">not</span> self._qsize()</span><br><span class="line">        self.mutex.release()</span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">full</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;&#x961F;&#x5217;&#x662F;&#x5426;&#x5DF2;&#x6EE1;(&#x4E0D;&#x53EF;&#x9760;!).&quot;&quot;&quot;</span></span><br><span class="line">        self.mutex.acquire()</span><br><span class="line">        n = <span class="number">0</span> &lt; self.maxsize == self._qsize()</span><br><span class="line">        self.mutex.release()</span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put</span><span class="params">(self, item, block=True, timeout=None)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;&#x6DFB;&#x52A0;&#x5143;&#x7D20;.</span><br><span class="line"></span><br><span class="line">        &#x5982;&#x679C;&#x53EF;&#x9009;&#x53C2;&#x6570;block&#x4E3A;True&#x5E76;&#x4E14;timeout&#x53C2;&#x6570;&#x4E3A;None(&#x9ED8;&#x8BA4;), &#x4E3A;&#x963B;&#x585E;&#x578B;put().</span><br><span class="line">        &#x5982;&#x679C;timeout&#x662F;&#x6B63;&#x6570;, &#x4F1A;&#x963B;&#x585E;timeout&#x65F6;&#x95F4;&#x5E76;&#x5F15;&#x53D1;Queue.Full&#x5F02;&#x5E38;.</span><br><span class="line">        &#x5982;&#x679C;block&#x4E3A;False&#x4E3A;&#x975E;&#x963B;&#x585E;put</span><br><span class="line">        &quot;&quot;&quot;</span></span><br><span class="line">        self.not_full.acquire()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> self.maxsize &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> block:</span><br><span class="line">                    <span class="keyword">if</span> self._qsize() == self.maxsize:</span><br><span class="line">                        <span class="keyword">raise</span> Full</span><br><span class="line">                <span class="keyword">elif</span> timeout <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">                    <span class="keyword">while</span> self._qsize() == self.maxsize:</span><br><span class="line">                        self.not_full.wait()</span><br><span class="line">                <span class="keyword">elif</span> timeout &lt; <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">raise</span> ValueError(<span class="string">&quot;&apos;timeout&apos; must be a non-negative number&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    endtime = _time() + timeout</span><br><span class="line">                    <span class="keyword">while</span> self._qsize() == self.maxsize:</span><br><span class="line">                        remaining = endtime - _time()</span><br><span class="line">                        <span class="keyword">if</span> remaining &lt;= <span class="number">0.0</span>:</span><br><span class="line">                            <span class="keyword">raise</span> Full</span><br><span class="line">                        self.not_full.wait(remaining)</span><br><span class="line"></span><br><span class="line">            self._put(item)</span><br><span class="line">            self.unfinished_tasks += <span class="number">1</span></span><br><span class="line">            self.not_empty.notify()</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            self.not_full.release()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put_nowait</span><span class="params">(self, item)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span><br><span class="line">        &#x975E;&#x963B;&#x585E;put</span><br><span class="line">        &#x5176;&#x5B9E;&#x5C31;&#x662F;&#x5C06;put&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;block&#x8BBE;&#x4E3A;False</span><br><span class="line">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self.put(item, <span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, block=True, timeout=None)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;&#x79FB;&#x9664;&#x5217;&#x961F;&#x5143;&#x7D20;&#x5E76;&#x5C06;&#x5143;&#x7D20;&#x8FD4;&#x56DE;.</span><br><span class="line"></span><br><span class="line">        block = True&#x4E3A;&#x963B;&#x585E;&#x51FD;&#x6570;, block = False&#x4E3A;&#x975E;&#x963B;&#x585E;&#x51FD;&#x6570;. &#x53EF;&#x80FD;&#x8FD4;&#x56DE;Queue.Empty&#x5F02;&#x5E38;</span><br><span class="line">        &quot;&quot;&quot;</span></span><br><span class="line">        self.not_empty.acquire()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> block:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> self._qsize():</span><br><span class="line">                    <span class="keyword">raise</span> Empty</span><br><span class="line">            <span class="keyword">elif</span> timeout <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">                <span class="keyword">while</span> <span class="keyword">not</span> self._qsize():</span><br><span class="line">                    self.not_empty.wait()</span><br><span class="line">            <span class="keyword">elif</span> timeout &lt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;&apos;timeout&apos; must be a non-negative number&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                endtime = _time() + timeout</span><br><span class="line">                <span class="keyword">while</span> <span class="keyword">not</span> self._qsize():</span><br><span class="line">                    remaining = endtime - _time()</span><br><span class="line">                    <span class="keyword">if</span> remaining &lt;= <span class="number">0.0</span>:</span><br><span class="line">                        <span class="keyword">raise</span> Empty</span><br><span class="line">                    self.not_empty.wait(remaining)</span><br><span class="line">            item = self._get()</span><br><span class="line">            self.not_full.notify()</span><br><span class="line">            <span class="keyword">return</span> item</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            self.not_empty.release()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_nowait</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span><br><span class="line">        &#x975E;&#x963B;&#x585E;get()</span><br><span class="line">        &#x4E5F;&#x5373;&#x662F;get()&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x4E3A;False</span><br><span class="line">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> self.get(<span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Override these methods to implement other queue organizations</span></span><br><span class="line">    <span class="comment"># (e.g. stack or priority queue).</span></span><br><span class="line">    <span class="comment"># These will only be called with appropriate locks held</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># &#x521D;&#x59CB;&#x5316;&#x961F;&#x5217;&#x8868;&#x793A;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_init</span><span class="params">(self, maxsize)</span>:</span></span><br><span class="line">        self.queue = deque()        <span class="comment"># &#x5C06;queue&#x521D;&#x59CB;&#x5316;&#x4E3A;&#x4E00;&#x4E2A;&#x7A7A;&#x7684;deque&#x5BF9;&#x8C61;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_qsize</span><span class="params">(self, len=len)</span>:</span>      <span class="comment"># &#x961F;&#x5217;&#x957F;&#x5EA6;</span></span><br><span class="line">        <span class="keyword">return</span> len(self.queue)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Put a new item in the queue</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_put</span><span class="params">(self, item)</span>:</span></span><br><span class="line">        self.queue.append(item)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Get an item from the queue</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.queue.popleft()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PriorityQueue</span><span class="params">(Queue)</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span><br><span class="line">    &#x7EE7;&#x627F;Queue</span><br><span class="line">    &#x6784;&#x9020;&#x4E00;&#x4E2A;&#x4F18;&#x5148;&#x7EA7;&#x961F;&#x5217;</span><br><span class="line">    maxsize&#x8BBE;&#x7F6E;&#x961F;&#x5217;&#x5927;&#x5C0F;&#x7684;&#x4E0A;&#x754C;, &#x5982;&#x679C;&#x63D2;&#x5165;&#x6570;&#x636E;&#x65F6;, &#x8FBE;&#x5230;&#x4E0A;&#x754C;&#x4F1A;&#x53D1;&#x751F;&#x963B;&#x585E;, &#x76F4;&#x5230;&#x961F;&#x5217;&#x53EF;&#x4EE5;&#x653E;&#x5165;&#x6570;&#x636E;.</span><br><span class="line">    &#x5F53;maxsize&#x5C0F;&#x4E8E;&#x6216;&#x8005;&#x7B49;&#x4E8E;0, &#x8868;&#x793A;&#x4E0D;&#x9650;&#x5236;&#x961F;&#x5217;&#x7684;&#x5927;&#x5C0F;(&#x9ED8;&#x8BA4;).</span><br><span class="line">    &#x4F18;&#x5148;&#x7EA7;&#x961F;&#x5217;&#x4E2D;, &#x6700;&#x5C0F;&#x503C;&#x88AB;&#x6700;&#x5148;&#x53D6;&#x51FA;</span><br><span class="line">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_init</span><span class="params">(self, maxsize)</span>:</span></span><br><span class="line">        self.queue = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_qsize</span><span class="params">(self, len=len)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> len(self.queue)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_put</span><span class="params">(self, item, heappush=heapq.heappush)</span>:</span></span><br><span class="line">        heappush(self.queue, item)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get</span><span class="params">(self, heappop=heapq.heappop)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> heappop(self.queue)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LifoQueue</span><span class="params">(Queue)</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span><br><span class="line">    &#x6784;&#x9020;&#x4E00;LIFO(&#x5148;&#x8FDB;&#x540E;&#x51FA;)&#x961F;&#x5217;</span><br><span class="line">    maxsize&#x8BBE;&#x7F6E;&#x961F;&#x5217;&#x5927;&#x5C0F;&#x7684;&#x4E0A;&#x754C;, &#x5982;&#x679C;&#x63D2;&#x5165;&#x6570;&#x636E;&#x65F6;, &#x8FBE;&#x5230;&#x4E0A;&#x754C;&#x4F1A;&#x53D1;&#x751F;&#x963B;&#x585E;, &#x76F4;&#x5230;&#x961F;&#x5217;&#x53EF;&#x4EE5;&#x653E;&#x5165;&#x6570;&#x636E;.</span><br><span class="line">    &#x5F53;maxsize&#x5C0F;&#x4E8E;&#x6216;&#x8005;&#x7B49;&#x4E8E;0, &#x8868;&#x793A;&#x4E0D;&#x9650;&#x5236;&#x961F;&#x5217;&#x7684;&#x5927;&#x5C0F;(&#x9ED8;&#x8BA4;)</span><br><span class="line">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_init</span><span class="params">(self, maxsize)</span>:</span></span><br><span class="line">        self.queue = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_qsize</span><span class="params">(self, len=len)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> len(self.queue)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_put</span><span class="params">(self, item)</span>:</span></span><br><span class="line">        self.queue.append(item)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.queue.pop()     <span class="comment"># &#x4E0E;Queue&#x76F8;&#x6BD4;&#xFF0C;&#x4EC5;&#x4EC5;&#x662F; &#x5C06;popleft()&#x6539;&#x6210;&#x4E86;pop()</span></span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Python/">Python</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Queue/">Queue</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-python-multi-programming-4" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/15/python-multi-programming-4/" class="article-date">
      <time datetime="2016-05-15T04:44:44.815Z" itemprop="datePublished">2016-05-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/15/python-multi-programming-4/">Python 并发编程系列--4、多进程编程方法</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="&#x4E0A;&#x4E00;&#x7BC7;&#x76F4;&#x901A;&#x8F66;-Python-&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7CFB;&#x5217;&#x2013;3&#x3001;&#x591A;&#x7EBF;&#x7A0B;&#x7F16;&#x7A0B;&#x65B9;&#x6CD5;"><a href="#&#x4E0A;&#x4E00;&#x7BC7;&#x76F4;&#x901A;&#x8F66;-Python-&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7CFB;&#x5217;&#x2013;3&#x3001;&#x591A;&#x7EBF;&#x7A0B;&#x7F16;&#x7A0B;&#x65B9;&#x6CD5;" class="headerlink" title="&#x4E0A;&#x4E00;&#x7BC7;&#x76F4;&#x901A;&#x8F66; Python &#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7CFB;&#x5217;&#x2013;3&#x3001;&#x591A;&#x7EBF;&#x7A0B;&#x7F16;&#x7A0B;&#x65B9;&#x6CD5;"></a>&#x4E0A;&#x4E00;&#x7BC7;&#x76F4;&#x901A;&#x8F66; <a href="../python-multi-programming-3/">Python &#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7CFB;&#x5217;&#x2013;3&#x3001;&#x591A;&#x7EBF;&#x7A0B;&#x7F16;&#x7A0B;&#x65B9;&#x6CD5;</a></h4><h3 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h3><p>&#x4E0A;&#x4E00;&#x7BC7;&#x4ECB;&#x7ECD;&#x4E86;&#x591A;&#x7EBF;&#x7A0B;&#x7F16;&#x7A0B;&#xFF0C;&#x8FD9;&#x4E00;&#x7BC7;&#x4ECB;&#x7ECD;&#x591A;&#x8FDB;&#x7A0B;&#x7F16;&#x7A0B;&#xFF0C;&#x5F53;&#x7136;&#x5E94;&#x7528;&#x573A;&#x666F;&#x662F;CPU&#x5BC6;&#x96C6;&#x578B;&#x4EFB;&#x52A1;&#x3002;</p>
<h3 id="&#x5206;&#x7C7B;"><a href="#&#x5206;&#x7C7B;" class="headerlink" title="&#x5206;&#x7C7B;"></a>&#x5206;&#x7C7B;</h3><p>&#x90FD;&#x662F;&#x91C7;&#x7528;multiprocessing&#x6A21;&#x5757;&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;&#x5E94;&#x7528;&#x7684;&#x7C7B;&#x548C;&#x65B9;&#x6CD5;&#x4E0D;&#x540C;</p>
<ul>
<li>&#x4F7F;&#x7528;Pool&#x5BF9;&#x8C61;&#x7684;map&#x65B9;&#x6CD5;</li>
<li>&#x4F7F;&#x7528;Pool&#x5BF9;&#x8C61;&#x7684;apply_async&#x65B9;&#x6CD5;</li>
<li>&#x4F7F;&#x7528;Process&#x7C7B;</li>
</ul>
<p>&#x4E0B;&#x9762;&#x5206;&#x522B;&#x4ECB;&#x7ECD;</p>
<h4 id="&#x4F7F;&#x7528;Pool&#x5BF9;&#x8C61;&#x7684;map&#x65B9;&#x6CD5;"><a href="#&#x4F7F;&#x7528;Pool&#x5BF9;&#x8C61;&#x7684;map&#x65B9;&#x6CD5;" class="headerlink" title="&#x4F7F;&#x7528;Pool&#x5BF9;&#x8C61;&#x7684;map&#x65B9;&#x6CD5;"></a>&#x4F7F;&#x7528;Pool&#x5BF9;&#x8C61;&#x7684;map&#x65B9;&#x6CD5;</h4><p>&#x4E0E;<a href="../python-multi-programming-3/">&#x4E0A;&#x4E00;&#x7BC7;</a>&#x7C7B;&#x4F3C;&#xFF0C;multiprocessing&#x6A21;&#x5757;&#x7684;Pool&#x5BF9;&#x8C61;&#x5177;&#x6709;map&#x65B9;&#x6CD5;&#xFF0C;&#x5E94;&#x7528;map&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x5F88;&#x4FBF;&#x6377;&#x5730;&#x5B9E;&#x73B0;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x3002;&#x4E0B;&#x9762;&#x7ED9;&#x51FA;&#x4E24;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x5206;&#x522B;&#x6765;&#x81EA;<a href="http://www.cnblogs.com/fengjian2016/p/5261246.html" target="_blank" rel="external">python&#x591A;&#x8FDB;&#x7A0B;(&#x4E09;&#x79CD;&#x65B9;&#x6CD5;)</a>&#x548C;<a href="https://segmentfault.com/a/1190000000414339" target="_blank" rel="external">&#x4E00;&#x884C;Python&#x5B9E;&#x73B0;&#x5E76;&#x884C;&#x5316;</a>&#x3002;<br>&#x9996;&#x5148;&#x770B;&#x7B2C;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x4F7F;&#x7528;&#x591A;&#x7EBF;&#x7A0B;&#x8BA1;&#x7B97;0&#x5230;9&#x7684;&#x5E73;&#x65B9;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">print</span> x</span><br><span class="line">    <span class="keyword">return</span> x*x</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    p=Pool(<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">print</span> (p.map(f,range(<span class="number">10</span>)))</span><br></pre></td></tr></table></figure></p>
<p>&#x4EE3;&#x7801;&#x8FD0;&#x884C;&#x7ED3;&#x679C;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</span><br></pre></td></tr></table></figure></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5217;&#x8868;&#x662F;&#x6309;&#x7167;&#x987A;&#x5E8F;&#x6253;&#x5370;&#x7684;&#xFF0C;&#x8FD9;&#x6B63;&#x662F;&#x91C7;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x6267;&#x884C;&#x7684;&#x597D;&#x5904;&#xFF1A;&#x65E2;&#x5B9E;&#x73B0;&#x4E86;&#x591A;&#x8FDB;&#x7A0B;&#xFF0C;&#x53C8;&#x4FDD;&#x8BC1;&#x4E86;&#x7A0B;&#x5E8F;&#x7684;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x3002;</p>
<p>&#x53E6;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x662F;&#x751F;&#x6210;&#x4E0A;&#x5343;&#x5F20;&#x56FE;&#x7247;&#x7684;&#x7F29;&#x7565;&#x56FE;&#xFF0C;&#x5355;&#x7EBF;&#x7A0B;&#x7248;&#x672C;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> PIL </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool </span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">SIZE = (<span class="number">75</span>,<span class="number">75</span>)</span><br><span class="line">SAVE_DIRECTORY = <span class="string">&apos;thumbs&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_image_paths</span><span class="params">(folder)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> (os.path.join(folder, f) </span><br><span class="line">            <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(folder) </span><br><span class="line">            <span class="keyword">if</span> <span class="string">&apos;jpeg&apos;</span> <span class="keyword">in</span> f)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_thumbnail</span><span class="params">(filename)</span>:</span> </span><br><span class="line">    im = Image.open(filename)</span><br><span class="line">    im.thumbnail(SIZE, Image.ANTIALIAS)</span><br><span class="line">    base, fname = os.path.split(filename) </span><br><span class="line">    save_path = os.path.join(base, SAVE_DIRECTORY, fname)</span><br><span class="line">    im.save(save_path)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    folder = os.path.abspath(</span><br><span class="line">        <span class="string">&apos;11_18_2013_R000_IQM_Big_Sur_Mon__e10d1958e7b766c3e840&apos;</span>)</span><br><span class="line">    os.mkdir(os.path.join(folder, SAVE_DIRECTORY))</span><br><span class="line"></span><br><span class="line">    images = get_image_paths(folder)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> image <span class="keyword">in</span> images:</span><br><span class="line">        create_thumbnail(Image)</span><br></pre></td></tr></table></figure></p>
<p>&#x5728;&#x539F;&#x6587;&#x4F5C;&#x8005;&#x7684;&#x673A;&#x5668;&#x4E0A;&#xFF0C;&#x5904;&#x7406;6000&#x7AE0;&#x56FE;&#x7247;&#x9700;&#x8981;27.9&#x79D2;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x4F7F;&#x7528;map&#x65B9;&#x6CD5;&#x540E;&#x7684;&#x591A;&#x8FDB;&#x7A0B;&#x7248;&#x672C;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> PIL </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool </span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">SIZE = (<span class="number">75</span>,<span class="number">75</span>)</span><br><span class="line">SAVE_DIRECTORY = <span class="string">&apos;thumbs&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_image_paths</span><span class="params">(folder)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> (os.path.join(folder, f) </span><br><span class="line">            <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(folder) </span><br><span class="line">            <span class="keyword">if</span> <span class="string">&apos;jpeg&apos;</span> <span class="keyword">in</span> f)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_thumbnail</span><span class="params">(filename)</span>:</span> </span><br><span class="line">    im = Image.open(filename)</span><br><span class="line">    im.thumbnail(SIZE, Image.ANTIALIAS)</span><br><span class="line">    base, fname = os.path.split(filename) </span><br><span class="line">    save_path = os.path.join(base, SAVE_DIRECTORY, fname)</span><br><span class="line">    im.save(save_path)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    folder = os.path.abspath(</span><br><span class="line">        <span class="string">&apos;11_18_2013_R000_IQM_Big_Sur_Mon__e10d1958e7b766c3e840&apos;</span>)</span><br><span class="line">    os.mkdir(os.path.join(folder, SAVE_DIRECTORY))</span><br><span class="line"></span><br><span class="line">    images = get_image_paths(folder)</span><br><span class="line"></span><br><span class="line">    pool = Pool()</span><br><span class="line">    pool.map(creat_thumbnail, images)</span><br><span class="line">    pool.close()</span><br><span class="line">    pool.join()</span><br></pre></td></tr></table></figure></p>
<p>&#x5728;&#x539F;&#x6587;&#x4F5C;&#x8005;&#x7684;&#x673A;&#x5668;&#x4E0A;&#xFF0C;&#x8FD9;&#x6B21;&#x8FD0;&#x884C;&#x53EA;&#x7528;&#x4E86;5.6&#x79D2;&#xFF0C;&#x53EF;&#x89C1;&#x901F;&#x5EA6;&#x5927;&#x5927;&#x63D0;&#x5347;&#xFF01;<br><strong>&#x6CE8;&#x610F;&#xFF1A;&#x5728;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x65F6;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x4E00;&#x4E9B;&#x5F71;&#x54CD;&#x7A0B;&#x5E8F;&#x6027;&#x80FD;&#x751A;&#x81F3;&#x5F71;&#x54CD;&#x7A0B;&#x5E8F;&#x6B63;&#x5E38;&#x6267;&#x884C;&#x7684;&#x9690;&#x60A3;&#x6240;&#x5728;&#xFF0C;&#x56E0;&#x6B64;&#x6700;&#x597D;&#x4FDD;&#x8BC1;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x5E93;&#x7684;&#x5F15;&#x7528;&#x4EE5;&#x53CA;&#x4E00;&#x4E9B;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x4EE3;&#x7801;&#x4E0D;&#x653E;&#x5728;Pool&#x7684;map&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x6700;&#x597D;&#x653E;&#x5728;map&#x91CC;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#x89C1;<a href="https://segmentfault.com/q/1010000000421911" target="_blank" rel="external">&#x8FD9;&#x4E2A;&#x8BA8;&#x8BBA;</a></strong></p>
<h4 id="&#x4F7F;&#x7528;Pool&#x7684;apply-async&#x65B9;&#x6CD5;"><a href="#&#x4F7F;&#x7528;Pool&#x7684;apply-async&#x65B9;&#x6CD5;" class="headerlink" title="&#x4F7F;&#x7528;Pool&#x7684;apply_async&#x65B9;&#x6CD5;"></a>&#x4F7F;&#x7528;Pool&#x7684;apply_async&#x65B9;&#x6CD5;</h4><p>&#x4E0B;&#x9762;&#x662F;&#x524D;&#x6587;&#x63D0;&#x5230;&#x7684;&#x535A;&#x5BA2;&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x540C;&#x6837;&#x5B8C;&#x6210;&#x8BA1;&#x7B97;0&#x5230;9&#x7684;&#x5E73;&#x65B9;&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> x*x</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> x*x</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    p=Pool(processes=<span class="number">5</span>)</span><br><span class="line">    res_list=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        res=p.apply_async(f,[i,])</span><br><span class="line">        res_list.append(res)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> res_list:</span><br><span class="line">        <span class="keyword">print</span> item.get(),</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#x540C;&#x4E0A;&#xFF0C;&#x4ECD;&#x4E3A;&#x6709;&#x5E8F;&#x5E8F;&#x5217;&#x3002;&#x4E0D;&#x8FC7;&#x4E0D;&#x540C;&#x7684;&#x662F;&#x4E0A;&#x4E00;&#x6B21;&#x662F;&#x6267;&#x884C;&#x5B8C;&#x6210;&#x540E;&#x8FD4;&#x56DE;&#x5217;&#x8868;&#xFF0C;&#x800C;&#x8FD9;&#x4E00;&#x6B21;&#x4E00;&#x8FB9;&#x8BA1;&#x7B97;&#x4E00;&#x8FB9;&#x663E;&#x793A;&#xFF08;&#x8FD9;&#x6B63;&#x662F;&#x4F7F;&#x7528;apply_async&#x65B9;&#x6CD5;&#x7684;&#x7279;&#x70B9;&#xFF0C;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x662F;&#x5F02;&#x6B65;&#x7684;&#xFF09;&#x3002;&#x60F3;&#x8981;&#x8BE6;&#x7EC6;&#x89C2;&#x5BDF;&#x6548;&#x679C;&#x7684;&#x8BDD;&#x5EFA;&#x8BAE;&#x8BFB;&#x8005;&#x5728;&#x672C;&#x5730;&#x673A;&#x5668;&#x4E0A;&#x8FD0;&#x884C;&#x6BD4;&#x8F83;&#x3002;</p>
<h4 id="&#x4F7F;&#x7528;Process&#x7C7B;"><a href="#&#x4F7F;&#x7528;Process&#x7C7B;" class="headerlink" title="&#x4F7F;&#x7528;Process&#x7C7B;"></a>&#x4F7F;&#x7528;Process&#x7C7B;</h4><p>&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x662F;&#x4F7F;&#x7528;multiprocessing&#x6A21;&#x5757;&#x4E2D;&#x7684;Process&#x7C7B;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#x591A;&#x8FDB;&#x7A0B;&#xFF0C;&#x5B9E;&#x4F8B;&#x901A;&#x8FC7;&#x6253;&#x5370;&#x4E3B;&#x8FDB;&#x7A0B;&#x548C;&#x4ECE;&#x8FDB;&#x7A0B;&#x7684;pid&#x6765;&#x9A8C;&#x8BC1;&#x5C5E;&#x4E8E;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">info</span><span class="params">(title)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> title</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&apos;module_name:&apos;</span>,__name__</span><br><span class="line">    <span class="keyword">if</span> hasattr(os,<span class="string">&apos;getppid&apos;</span>):<span class="comment">#&#x4EC5;&#x5728;Unix&#x4E3B;&#x673A;&#x4E0A;&#x624D;&#x6709;&#x6B64;&#x5C5E;&#x6027;</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&apos;parent process:&apos;</span>,os.getppid()</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&apos;process id:&apos;</span>,os.getpid()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(name)</span>:</span></span><br><span class="line">    info(<span class="string">&apos;funcion f&apos;</span>)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&apos;hello&apos;</span>,name</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    info(<span class="string">&apos;main line&apos;</span>)</span><br><span class="line">    p=Process(target=f,args=(<span class="string">&apos;bob&apos;</span>,))</span><br><span class="line">    p.start()</span><br><span class="line">    p.join()</span><br></pre></td></tr></table></figure></p>
<p>&#x7ED3;&#x679C;&#x5982;&#x4E0B;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">main line</span><br><span class="line">module_name: __main__</span><br><span class="line">process id: 11688</span><br><span class="line">funcion f</span><br><span class="line">module_name: __main__</span><br><span class="line">process id: 10520</span><br><span class="line">hello bob</span><br></pre></td></tr></table></figure></p>
<p>&#x901A;&#x8FC7;&#x6253;&#x5370;&#x51FA;&#x7684;&#x7ED3;&#x679C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x901A;&#x8FC7;Process&#x5BF9;&#x8C61;&#x6210;&#x529F;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;</p>
<h4 id="&#x9898;&#x5916;&#x8BDD;"><a href="#&#x9898;&#x5916;&#x8BDD;" class="headerlink" title="&#x9898;&#x5916;&#x8BDD;"></a>&#x9898;&#x5916;&#x8BDD;</h4><p>&#x4E0B;&#x9762;&#x8C08;&#x4E00;&#x4E9B;&#x5468;&#x8FB9;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x9996;&#x5148;&#x901A;&#x8FC7;&#x5B9E;&#x4F8B;&#x9A8C;&#x8BC1;&#x4E00;&#x4E0B;&#x591A;&#x8FDB;&#x7A0B;&#x6570;&#x636E;&#x533A;&#x57DF;&#x7684;&#x72EC;&#x7ACB;&#x6027;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>&#x7B2C;&#x4E00;&#x6B21;&#x8FD0;&#x884C;&#x7ED3;&#x679C;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[0[]1[</span><br><span class="line">]2</span><br><span class="line">[][5]</span><br><span class="line">[3</span><br><span class="line">4]]</span><br><span class="line">[</span><br><span class="line">6]</span><br><span class="line">[7[8]</span><br><span class="line">]</span><br><span class="line">[9]</span><br></pre></td></tr></table></figure></p>
<p>&#x7B2C;&#x4E8C;&#x6B21;&#x8FD0;&#x884C;&#x7ED3;&#x679C;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[[01[3]</span><br><span class="line">][]</span><br><span class="line">2[</span><br><span class="line">[5]</span><br><span class="line">]4</span><br><span class="line">][</span><br><span class="line">6[]7</span><br><span class="line">[]8</span><br><span class="line">][</span><br><span class="line">9]</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x4E0B;&#x4E00;&#x7BC7;&#x9884;&#x544A;"><a href="#&#x4E0B;&#x4E00;&#x7BC7;&#x9884;&#x544A;" class="headerlink" title="&#x4E0B;&#x4E00;&#x7BC7;&#x9884;&#x544A;"></a>&#x4E0B;&#x4E00;&#x7BC7;&#x9884;&#x544A;</h4><p>&#x4E0B;&#x4E00;&#x7BC7;&#x4F1A;&#x8C08;&#x5230;&#x534F;&#x7A0B;&#xFF0C;&#x81F3;&#x4E8E;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x5C31;&#x4E0D;&#x77E5;&#x9053;&#x4E86;2333</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Python/">Python</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/多进程/">多进程</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/并发/">并发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/编程/">编程</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-python-multi-programming-3" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/15/python-multi-programming-3/" class="article-date">
      <time datetime="2016-05-15T04:39:13.550Z" itemprop="datePublished">2016-05-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/15/python-multi-programming-3/">Python 并发编程系列--3、多线程编程方法</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="&#x4E0A;&#x4E00;&#x7BC7;&#x76F4;&#x901A;&#x8F66;-Python-&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7CFB;&#x5217;&#x2013;2&#x3001;&#x5E76;&#x53D1;&#x65B9;&#x5F0F;&#x7684;&#x9009;&#x62E9;"><a href="#&#x4E0A;&#x4E00;&#x7BC7;&#x76F4;&#x901A;&#x8F66;-Python-&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7CFB;&#x5217;&#x2013;2&#x3001;&#x5E76;&#x53D1;&#x65B9;&#x5F0F;&#x7684;&#x9009;&#x62E9;" class="headerlink" title="&#x4E0A;&#x4E00;&#x7BC7;&#x76F4;&#x901A;&#x8F66; Python &#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7CFB;&#x5217;&#x2013;2&#x3001;&#x5E76;&#x53D1;&#x65B9;&#x5F0F;&#x7684;&#x9009;&#x62E9;"></a>&#x4E0A;&#x4E00;&#x7BC7;&#x76F4;&#x901A;&#x8F66; <a href="../python-multi-programming-2/">Python &#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7CFB;&#x5217;&#x2013;2&#x3001;&#x5E76;&#x53D1;&#x65B9;&#x5F0F;&#x7684;&#x9009;&#x62E9;</a></h4><h3 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h3><p>&#x6839;&#x636E;&#x524D;&#x9762;&#x7684;&#x5E94;&#x7528;&#x80CC;&#x666F;&#xFF0C;&#x8FD9;&#x91CC;&#x4ECB;&#x7ECD;Python&#x591A;&#x7EBF;&#x7A0B;&#x7F16;&#x7A0B;&#x65F6;&#x5B9E;&#x4F8B;&#x5E94;&#x7528;&#x4E8E;&#x7F51;&#x7EDC;&#x722C;&#x866B;&#x2013;&#x7EAF;&#x7684;I/O&#x5BC6;&#x96C6;&#x578B;&#x4EFB;&#x52A1;&#x3002;</p>
<h3 id="&#x591A;&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;"><a href="#&#x591A;&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;" class="headerlink" title="&#x591A;&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;"></a>&#x591A;&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;</h3><p>&#x591A;&#x7EBF;&#x7A0B;&#x5728;Python&#x4E2D;&#x6709;&#x4E0D;&#x6B62;&#x4E00;&#x79CD;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7EE7;&#x627F;Threading&#x7C7B;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5355;&#x7EAF;&#x4F7F;&#x7528;Thread&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E0D;&#x540C;&#x4E4B;&#x5904;&#x662F;&#x524D;&#x8005;&#x662F;&#x540E;&#x8005;&#x7684;&#x5C01;&#x88C5;&#x548C;&#x6539;&#x8FDB;&#xFF0C;&#x4E00;&#x822C;&#x7528;&#x524D;&#x8005;&#xFF0C;&#x56E0;&#x4E3A;&#x5176;&#x66F4;&#x52A0;&#x65B9;&#x4FBF;&#xFF0C;&#x5F53;&#x7136;&#x5076;&#x5C14;&#x5B58;&#x5728;&#x9700;&#x8981;&#x4F7F;&#x7528;Thread&#x7C7B;&#x624D;&#x80FD;&#x5B8C;&#x6210;&#x7684;&#x4EFB;&#x52A1;&#xFF08;&#x5982;&#x5BF9;&#x5B50;&#x7EBF;&#x7A0B;&#x751F;&#x547D;&#x5468;&#x671F;&#x7684;&#x63A7;&#x5236;&#xFF0C;&#x8BBE;&#x7F6E;Threading&#x7684;setDaemon&#x65B9;&#x6CD5;&#x53EF;&#x80FD;&#x4E0D;&#x591F;&#x7528;&#xFF09;&#x3002;&#x4ECA;&#x5929;&#x770B;&#x5230;&#x4E86;&#x4E00;&#x7BC7;&#x8BD1;&#x6587;&#xFF1A;<a href="http://blog.segmentfault.com/caspar/1190000000414339" target="_blank" rel="external">&#x300A;&#x4E00;&#x884C; Python &#x5B9E;&#x73B0;&#x5E76;&#x884C;&#x5316; &#x2013; &#x65E5;&#x5E38;&#x591A;&#x7EBF;&#x7A0B;&#x64CD;&#x4F5C;&#x7684;&#x65B0;&#x601D;&#x8DEF;&#x300B;</a>&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;&#x53C2;&#x7167;<a href="https://medium.com/building-things-on-the-internet/40e9b2b36148#66bf-f06f781cb52b" target="_blank" rel="external">&#x539F;&#x4F5C;&#x8005; Chris&#x7684;&#x6587;&#x7AE0;</a>&#xFF0C;&#x4E0A;&#x9762;&#x63D0;&#x5230;&#x4E86;&#x4F7F;&#x7528;map&#x51FD;&#x6570;&#x5B9E;&#x73B0;&#x66F4;&#x4E3A;&#x7B80;&#x6D01;&#x7684;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x65B9;&#x5F0F;&#x3002;&#x672C;&#x6587;&#x5BF9;&#x8FD9;&#x51E0;&#x79CD;&#x5206;&#x522B;&#x8FDB;&#x884C;&#x4ECB;&#x7ECD;&#x3002;</p>
<h4 id="&#x65B9;&#x6CD5;&#x4E00;&#xFF1A;&#x4F7F;&#x7528;Thread&#x7C7B;&#x7684;&#x65B9;&#x6CD5;"><a href="#&#x65B9;&#x6CD5;&#x4E00;&#xFF1A;&#x4F7F;&#x7528;Thread&#x7C7B;&#x7684;&#x65B9;&#x6CD5;" class="headerlink" title="&#x65B9;&#x6CD5;&#x4E00;&#xFF1A;&#x4F7F;&#x7528;Thread&#x7C7B;&#x7684;&#x65B9;&#x6CD5;"></a>&#x65B9;&#x6CD5;&#x4E00;&#xFF1A;&#x4F7F;&#x7528;Thread&#x7C7B;&#x7684;&#x65B9;&#x6CD5;</h4><p>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x6700;&#x4E3A;&#x201D;&#x539F;&#x59CB;&#x201D;,&#x6700;&#x7B80;&#x5355;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x662F;&#x76F4;&#x63A5;&#x5728;&#x9700;&#x8981;&#x7684;&#x65F6;&#x5019;&#x8C03;&#x7528;Thread&#x7C7B;&#x7684;start_new_thread&#x65B9;&#x6CD5;&#xFF0C;&#x5C06;&#x9700;&#x8981;&#x5E76;&#x884C;&#x6267;&#x884C;&#x7684;&#x51FD;&#x6570;&#x53CA;&#x5176;&#x9700;&#x8981;&#x7684;&#x53C2;&#x6570;&#x4F20;&#x8FDB;&#x53BB;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</p>
<h4 id="&#x65B9;&#x6CD5;&#x4E8C;&#xFF1A;&#x4F7F;&#x7528;Threading&#x7ED3;&#x5408;Queue&#x4F7F;&#x7528;"><a href="#&#x65B9;&#x6CD5;&#x4E8C;&#xFF1A;&#x4F7F;&#x7528;Threading&#x7ED3;&#x5408;Queue&#x4F7F;&#x7528;" class="headerlink" title="&#x65B9;&#x6CD5;&#x4E8C;&#xFF1A;&#x4F7F;&#x7528;Threading&#x7ED3;&#x5408;Queue&#x4F7F;&#x7528;"></a>&#x65B9;&#x6CD5;&#x4E8C;&#xFF1A;&#x4F7F;&#x7528;Threading&#x7ED3;&#x5408;Queue&#x4F7F;&#x7528;</h4><p>Python&#x4E2D;&#x7684;Queue&#x6A21;&#x5757;&#x5B9E;&#x73B0;&#x4E86;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x961F;&#x5217;&#x7ED3;&#x6784;&#xFF08;Queue&#x4E2D;&#x4F7F;&#x7528;&#x4E86;Threading&#x4E2D;&#x63D0;&#x4F9B;&#x7684;&#x9501;&#x5B9E;&#x73B0;&#x4E86;&#x540C;&#x6B65;&#x4E0E;&#x4E92;&#x65A5;&#xFF09;&#xFF0C;&#x56E0;&#x6B64;&#x4F7F;&#x7528;Queue&#x5C31;&#x4E0D;&#x7528;&#x62C5;&#x5FC3;&#x9965;&#x997F;&#x6216;&#x8005;&#x6B7B;&#x9501;&#x95EE;&#x9898;&#x7684;&#x53D1;&#x751F;&#x4E86;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x8F83;&#x4E3A;&#x901A;&#x7528;&#x7684;I/O&#x591A;&#x7EBF;&#x7A0B;&#x4E66;&#x5199;&#x6A21;&#x677F;&#xFF0C;&#x53C2;&#x7167;&#x7F51;&#x4E0A;&#x770B;&#x5230;&#x7684;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#xFF1A;<a href="http://www.68idc.cn/help/jiabenmake/python/20150119177823.html" target="_blank" rel="external">Python&#x722C;&#x866B;(&#x516D;)&#x2013;&#x591A;&#x7EBF;&#x7A0B;&#x7EED;(Queue)</a>&#x3002;&#x5173;&#x4E8E;Queue&#x6A21;&#x5757;&#x7684;&#x4ECB;&#x7ECD;&#x53C2;&#x89C1;&#x535A;&#x5BA2;&#x7684;&#x53E6;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;<a href="../python-queue/">Python Queue&#x4ECB;&#x7ECD;</a>&#xFF0C;&#x4E0B;&#x9762;&#x76F4;&#x63A5;&#x4ECB;&#x7ECD;&#x591A;&#x7EBF;&#x7A0B;&#x7ED3;&#x5408;Queue&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x3002;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> Queue</span><br><span class="line"></span><br><span class="line">SHARE_Q=Queue.Queue()</span><br><span class="line"><span class="comment">#&#x7EBF;&#x7A0B;&#x4E2A;&#x6570;</span></span><br><span class="line">_WORKED_THERAD_NUM=<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span><span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    <span class="string">&apos;&apos;&apos;</span><br><span class="line">    &#x5176;&#x4E2D;func&#x4E3A;&#x7EBF;&#x7A0B;&#x51FD;&#x6570;&#x7684;&#x903B;&#x8F91;&#x90E8;&#x5206;</span><br><span class="line">    &apos;&apos;&apos;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,func)</span>:</span></span><br><span class="line">        super(MyThread,self).__init__()</span><br><span class="line">        self.func=func</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">&apos;&apos;&apos;</span><br><span class="line">        &#x91CD;&#x5199;&#x57FA;&#x7C7B;&#x7684;run&#x65B9;&#x6CD5;</span><br><span class="line">        &apos;&apos;&apos;</span></span><br><span class="line">        self.func()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">do_something</span><span class="params">(item)</span>:</span></span><br><span class="line">    <span class="string">&apos;&apos;&apos;</span><br><span class="line">    &#x8FD0;&#x884C;&#x903B;&#x8F91;</span><br><span class="line">    &apos;&apos;&apos;</span></span><br><span class="line">    <span class="keyword">print</span> item</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">worker</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">&apos;&apos;&apos;</span><br><span class="line">    &#x7528;&#x4E8E;&#x5199;&#x5DE5;&#x4F5C;&#x903B;&#x8F91;&#xFF0C;&#x53EA;&#x8981;&#x961F;&#x5217;&#x4E0D;&#x7A7A;&#x5C31;&#x6301;&#x7EED;&#x5904;&#x7406;&#xFF0C;&#x4E3A;&#x7A7A;&#x65F6;&#x68C0;&#x67E5;&#x961F;&#x5217;&#x3002;</span><br><span class="line">    &#x7531;&#x4E8E;Queue&#x4E2D;&#x5DF2;&#x7ECF;&#x5305;&#x542B;&#x4E86;wait notify &#x548C;&#x54CD;&#x5E94;&#x7684;&#x9501;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x9700;&#x8981;&#x5728;&#x53D6;&#x4EFB;&#x52A1;&#x6216;&#x8005;&#x653E;&#x4EFB;&#x52A1;&#x7684;&#x65F6;&#x5019;</span><br><span class="line">    &#x52A0;&#x9501;&#x6216;&#x89E3;&#x9501;</span><br><span class="line">    &apos;&apos;&apos;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">global</span> SHARE_Q</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> SHARE_Q.empty():</span><br><span class="line">        item=SHARE_Q.get()</span><br><span class="line">        do_something(item)</span><br><span class="line">        SHARE_Q.task_done()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> SHARE_Q</span><br><span class="line">    threads=[]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> task <span class="keyword">in</span> xrange(<span class="number">5</span>):</span><br><span class="line">        SHARE_Q.put(task)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(_WORKED_THREAD_NUM):</span><br><span class="line">        thread=MyThread(worker)</span><br><span class="line">        thread.start()</span><br><span class="line">        threads.append(thread)</span><br><span class="line">    <span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">        thread.join()</span><br><span class="line"></span><br><span class="line">    SHARE_Q.join()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>&#x6CE8;&#x610F;&#x4E0A;&#x9762;&#x6709;&#x4E00;&#x5904;&#x548C;&#x539F;&#x6587;&#x5199;&#x7684;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x5728;worker&#x51FD;&#x6570;&#x5185;&#xFF0C;&#x539F;&#x6587;&#x4E66;&#x5199;&#x65B9;&#x5F0F;&#x4E3A;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> SHARE_Q.empty():</span><br><span class="line">        item=SHARE_Q.get()</span><br><span class="line">        do_something(item)</span><br><span class="line">        SHARE_Q.task_done()</span><br></pre></td></tr></table></figure></p>
<p>&#x5B9E;&#x9645;&#x4F7F;&#x7528;&#x65F6;&#x91C7;&#x53D6;&#x8FD9;&#x79CD;&#x7684;&#x65B9;&#x5F0F;&#x4F1A;&#x5BFC;&#x81F4;&#x7A0B;&#x5E8F;&#x65E0;&#x6CD5;&#x7ED3;&#x675F;&#xFF0C;&#x6000;&#x7591;&#x662F;&#x7A0B;&#x5E8F;&#x65E0;&#x6CD5;&#x9000;&#x51FA;while&#x5FAA;&#x73AF;&#xFF08;&#x8FD9;&#x5757;&#x6CA1;&#x6709;&#x4ED4;&#x7EC6;&#x8C03;&#x8BD5;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x80FD;&#x786E;&#x5B9A;&#xFF09;&#x3002;&#x6539;&#x6210;&#x4E0A;&#x9762;&#x4EE3;&#x7801;&#x5904;&#x7684;&#x65B9;&#x5F0F;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x4E2D;&#x6B62;&#x3002;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x4E66;&#x5199;&#x7684;&#x6A21;&#x677F;&#xFF0C;&#x5728;do_something&#x51FD;&#x6570;&#x5185;&#x5B9E;&#x73B0;&#x81EA;&#x5DF1;&#x7684;&#x903B;&#x8F91;&#xFF0C;&#x7136;&#x540E;&#x6DFB;&#x52A0;&#x5FC5;&#x8981;&#x7684;&#x53D8;&#x91CF;&#x6216;&#x8005;&#x63A7;&#x5236;&#x8BED;&#x53E5;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x4EE3;&#x7801;&#x3002;</p>
<h4 id="&#x65B9;&#x6CD5;&#x4E09;&#xFF1A;&#x4F7F;&#x7528;map&#x51FD;&#x6570;&#x548C;multiprocessing&#x6A21;&#x5757;"><a href="#&#x65B9;&#x6CD5;&#x4E09;&#xFF1A;&#x4F7F;&#x7528;map&#x51FD;&#x6570;&#x548C;multiprocessing&#x6A21;&#x5757;" class="headerlink" title="&#x65B9;&#x6CD5;&#x4E09;&#xFF1A;&#x4F7F;&#x7528;map&#x51FD;&#x6570;&#x548C;multiprocessing&#x6A21;&#x5757;"></a>&#x65B9;&#x6CD5;&#x4E09;&#xFF1A;&#x4F7F;&#x7528;map&#x51FD;&#x6570;&#x548C;multiprocessing&#x6A21;&#x5757;</h4><p>&#x524D;&#x9762;&#x8C08;&#x5230;&#x4E86;&#x8FD9;&#x662F;&#x5728;&#x522B;&#x7684;&#x535A;&#x5BA2;&#x4E2D;&#x89C1;&#x5230;&#x7684;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x7B80;&#x6D01;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#xFF0C;&#x521A;&#x597D;&#x5229;&#x7528;&#x4E86;map&#x51FD;&#x6570;&#x7684;&#x529F;&#x80FD;&#x3002;&#x5173;&#x4E8E;map&#x51FD;&#x6570;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x6211;&#x7684;&#x53E6;&#x4E00;&#x7BC7;&#x535A;&#x5BA2; <a href="../../02/python-functions/">Python &#x51FD;&#x6570;</a>,&#x91CC;&#x9762;&#x8BB2;&#x5230;&#x4E86;map&#x51FD;&#x6570;&#x7684;&#x7528;&#x6CD5;&#x3002;&#x4E0B;&#x9762;&#x76F4;&#x63A5;&#x770B;map&#x51FD;&#x6570;&#x7684;&#x6548;&#x679C;&#x3002;<br>&#x5148;&#x770B;&#x4E00;&#x4E0B;map&#x7684;&#x5B9E;&#x73B0;&#x6548;&#x679C;&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x7528;map&#x5BF9;&#x4E00;&#x7CFB;&#x5217;url&#x8FDB;&#x884C;&#x8BBF;&#x95EE;&#xFF0C;&#x5E76;&#x5C06;&#x7ED3;&#x679C;&#x653E;&#x5230;&#x5217;&#x8868;results&#x4E2D;&#x8FD4;&#x56DE;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">results=map(urllib2.urlopen,[<span class="string">&apos;https://www.baidu.com&apos;</span>,<span class="string">&apos;http://cn.bing.com&apos;</span>])</span><br></pre></td></tr></table></figure></p>
<p>&#x76F8;&#x5F53;&#x4E8E;&#x4E0B;&#x9762;&#x7684;&#x64CD;&#x4F5C;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">urls=[<span class="string">&apos;https://www.baidu.com&apos;</span>,<span class="string">&apos;http://cn.bing.com&apos;</span>]</span><br><span class="line">results=[]</span><br><span class="line"><span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">    results.append(urllib2.urlopen(url))</span><br></pre></td></tr></table></figure></p>
<p>map&#x51FD;&#x6570;&#x4E00;&#x624B;&#x5305;&#x529E;&#x4E86;&#x5E8F;&#x5217;&#x64CD;&#x4F5C;&#x3001;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x548C;&#x7ED3;&#x679C;&#x4FDD;&#x5B58;&#x7B49;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x501F;&#x9274;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C;&#x9009;&#x62E9;multiprocessing&#x6A21;&#x5757;&#x4E2D;&#x7684;&#x5B50;&#x6A21;&#x5757;&#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x3002;<br>&#x5728;Python&#x4E2D;&#x7531;&#x4E24;&#x4E2A;&#x5E93;&#x5305;&#x542B;&#x4E86;map&#x51FD;&#x6570;&#xFF0C;multiprocessing&#x548C;&#x5B83;&#x7684;&#x5B50;&#x6A21;&#x5757;multiprocessing.dummy&#xFF0C;&#x524D;&#x8005;&#x7528;&#x5728;&#x591A;&#x8FDB;&#x7A0B;&#xFF0C;&#x800C;&#x540E;&#x8005;&#x7528;&#x4E8E;&#x591A;&#x7EBF;&#x7A0B;&#x3002;&#x4E24;&#x8005;&#x90FD;&#x6709;pool&#x5BF9;&#x8C61;&#xFF08;&#x7EBF;&#x7A0B;&#x6C60;&#x6216;&#x8005;&#x8FDB;&#x7A0B;&#x6C60;&#xFF09;&#x3002;&#x4F7F;&#x7528;&#x4E24;&#x4E2A;pool&#x7684;&#x5BF9;&#x8C61;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"><span class="keyword">from</span> multiprocessing.dummy <span class="keyword">import</span> Pool <span class="keyword">as</span> ThreadPool</span><br></pre></td></tr></table></figure></p>
<p>Pool&#x5BF9;&#x8C61;&#x6709;&#x4E00;&#x4E9B;&#x53C2;&#x6570;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x7528;&#x4E8E;&#x8BBE;&#x5B9A;&#x7EBF;&#x7A0B;&#x6C60;&#x4E2D;&#x7684;&#x7EBF;&#x7A0B;&#x6570;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;CPU&#x7684;&#x6838;&#x6570;&#x3002;&#x7EBF;&#x7A0B;&#x4E0D;&#x591F;&#xFF0C;&#x4F18;&#x52BF;&#x4F53;&#x73B0;&#x5F97;&#x4E0D;&#x660E;&#x663E;&#xFF1B;&#x7EBF;&#x7A0B;&#x8FC7;&#x591A;&#xFF0C;&#x5BFC;&#x81F4;&#x7EBF;&#x7A0B;&#x5207;&#x6362;&#x82B1;&#x7684;&#x65F6;&#x95F4;&#x592A;&#x957F;&#xFF0C;&#x5212;&#x4E0D;&#x6765;&#x3002;&#x5728;&#x5B9E;&#x9645;&#x4F7F;&#x7528;&#x4E2D;&#x6700;&#x597D;&#x6839;&#x636E;&#x9700;&#x6C42;&#x4EBA;&#x4E3A;&#x8BBE;&#x5B9A;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x9488;&#x5BF9;&#x4E0A;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x7248;&#x672C;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib2</span><br><span class="line"><span class="keyword">from</span> multiprocessing.dummy <span class="keyword">import</span> Pool <span class="keyword">as</span> ThreadPool</span><br><span class="line"></span><br><span class="line">urls=[</span><br><span class="line"><span class="string">&apos;http://www.python.org&apos;</span>, </span><br><span class="line">    <span class="string">&apos;http://www.python.org/about/&apos;</span>,</span><br><span class="line">    <span class="string">&apos;http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html&apos;</span>,</span><br><span class="line">    <span class="string">&apos;http://www.python.org/doc/&apos;</span>,</span><br><span class="line">    <span class="string">&apos;http://www.python.org/download/&apos;</span>,</span><br><span class="line">    <span class="string">&apos;http://www.python.org/getit/&apos;</span>,</span><br><span class="line">    <span class="string">&apos;http://www.python.org/community/&apos;</span>,</span><br><span class="line">    <span class="string">&apos;https://wiki.python.org/moin/&apos;</span>,</span><br><span class="line">    <span class="string">&apos;http://planet.python.org/&apos;</span>,</span><br><span class="line">    <span class="string">&apos;https://wiki.python.org/moin/LocalUserGroups&apos;</span>,</span><br><span class="line">    <span class="string">&apos;http://www.python.org/psf/&apos;</span>,</span><br><span class="line">    <span class="string">&apos;http://docs.python.org/devguide/&apos;</span>,</span><br><span class="line">    <span class="string">&apos;http://www.python.org/community/awards/&apos;</span></span><br><span class="line">	]</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#x8BBE;&#x5B9A;&#x6C60;&#x5B50;&#x7684;&#x5927;&#x5C0F;</span></span><br><span class="line">pool=ThreadPool(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">results=pool.map(urllib2.urlopen,urls)</span><br><span class="line">pool.close()</span><br><span class="line">pool.join()</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x9762;&#x6838;&#x5FC3;&#x53EA;&#x6709;4&#x884C;&#x4EE3;&#x7801;&#xFF0C;&#x5173;&#x952E;&#x53EA;&#x6709;&#x7B2C;23&#x884C;&#x8FD9;&#x4E00;&#x884C;&#x3002;&#x800C;&#x4E0B;&#x9762;&#x5219;&#x662F;<a href="http://www.ibm.com/developerworks/aix/library/au-threadingpython/" target="_blank" rel="external">IBM&#x7ECF;&#x5178;&#x6559;&#x7A0B;</a>&#x4E2D;&#x4F7F;&#x7528;&#x6A21;&#x578B;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x8DB3;&#x8DB3;40&#x591A;&#x884C;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&apos;&apos;&apos;</span><br><span class="line">A more realistic thread pool example </span><br><span class="line">&apos;&apos;&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time </span><br><span class="line"><span class="keyword">import</span> threading </span><br><span class="line"><span class="keyword">import</span> Queue </span><br><span class="line"><span class="keyword">import</span> urllib2 </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span><span class="params">(threading.Thread)</span>:</span> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, queue)</span>:</span> </span><br><span class="line">        threading.Thread.__init__(self)</span><br><span class="line">        self._queue = queue </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>: </span><br><span class="line">            content = self._queue.get() </span><br><span class="line">            <span class="keyword">if</span> isinstance(content, str) <span class="keyword">and</span> content == <span class="string">&apos;quit&apos;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            response = urllib2.urlopen(content)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&apos;Bye byes!&apos;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Producer</span><span class="params">()</span>:</span></span><br><span class="line">    urls = [</span><br><span class="line">        <span class="string">&apos;http://www.python.org&apos;</span>, <span class="string">&apos;http://www.yahoo.com&apos;</span></span><br><span class="line">        <span class="string">&apos;http://www.scala.org&apos;</span>, <span class="string">&apos;http://www.google.com&apos;</span></span><br><span class="line">        <span class="comment"># etc.. </span></span><br><span class="line">    ]</span><br><span class="line">    queue = Queue.Queue()</span><br><span class="line">    worker_threads = build_worker_pool(queue, <span class="number">4</span>)</span><br><span class="line">    start_time = time.time()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Add the urls to process</span></span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls: </span><br><span class="line">        queue.put(url)  </span><br><span class="line">    <span class="comment"># Add the poison pillv</span></span><br><span class="line">    <span class="keyword">for</span> worker <span class="keyword">in</span> worker_threads:</span><br><span class="line">        queue.put(<span class="string">&apos;quit&apos;</span>)</span><br><span class="line">    <span class="keyword">for</span> worker <span class="keyword">in</span> worker_threads:</span><br><span class="line">        worker.join()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&apos;Done! Time taken: {}&apos;</span>.format(time.time() - start_time)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_worker_pool</span><span class="params">(queue, size)</span>:</span></span><br><span class="line">    workers = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(size):</span><br><span class="line">        worker = Consumer(queue)</span><br><span class="line">        worker.start() </span><br><span class="line">        workers.append(worker)</span><br><span class="line">    <span class="keyword">return</span> workers</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    Producer()</span><br></pre></td></tr></table></figure></p>
<p>&#x76F8;&#x8F83;&#x4E4B;&#x4E0B;&#xFF0C;&#x4F7F;&#x7528;multiprocessing.dummpy&#x4E2D;&#x7684;pool&#x5BF9;&#x8C61;&#x7684;map&#x65B9;&#x6CD5;&#x8981;&#x65B9;&#x4FBF;&#x5F97;&#x591A;&#x3002;</p>
<h3 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h3><p>&#x4EE5;&#x4E0A;&#x4E09;&#x79CD;&#x65B9;&#x6CD5;&#x53EA;&#x662F;&#x4F17;&#x591A;&#x591A;&#x7EBF;&#x7A0B;&#x65B9;&#x6CD5;&#x4E2D;&#x7684;&#x51E0;&#x79CD;&#xFF0C;&#x9664;&#x6B64;&#x4E4B;&#x5916;&#x6211;&#x4EEC;&#x5F53;&#x7136;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;Threading&#x6A21;&#x5757;&#x672C;&#x8EAB;&#x800C;&#x4E0D;&#x7528;Queue&#x6A21;&#x5757;&#x5B9E;&#x73B0;&#x591A;&#x7EBF;&#x7A0B;&#xFF0C;&#x53EA;&#x662F;&#x8981;&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;&#x4E00;&#x904D;&#x5C01;&#x88C5;&#x7684;&#x8FC7;&#x7A0B;&#x3002;&#x5176;&#x5B9E;&#x5F52;&#x6839;&#x7ED3;&#x5E95;&#x8FD8;&#x662F;Thread&#x548C;Threading&#x6A21;&#x5757;&#xFF0C;&#x901A;&#x6B64;&#x4E24;&#x8005;&#xFF0C;&#x518D;&#x65E0;&#x96BE;&#x4E8B;:-)</p>
<h4 id="&#x4E0B;&#x4E00;&#x7BC7;&#x76F4;&#x901A;&#x8F66;-Python-&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7CFB;&#x5217;&#x2013;4&#x3001;&#x591A;&#x8FDB;&#x7A0B;&#x7F16;&#x7A0B;&#x65B9;&#x6CD5;"><a href="#&#x4E0B;&#x4E00;&#x7BC7;&#x76F4;&#x901A;&#x8F66;-Python-&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7CFB;&#x5217;&#x2013;4&#x3001;&#x591A;&#x8FDB;&#x7A0B;&#x7F16;&#x7A0B;&#x65B9;&#x6CD5;" class="headerlink" title="&#x4E0B;&#x4E00;&#x7BC7;&#x76F4;&#x901A;&#x8F66; Python &#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7CFB;&#x5217;&#x2013;4&#x3001;&#x591A;&#x8FDB;&#x7A0B;&#x7F16;&#x7A0B;&#x65B9;&#x6CD5;"></a>&#x4E0B;&#x4E00;&#x7BC7;&#x76F4;&#x901A;&#x8F66; <a href="../python-multi-programming-4/">Python &#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7CFB;&#x5217;&#x2013;4&#x3001;&#x591A;&#x8FDB;&#x7A0B;&#x7F16;&#x7A0B;&#x65B9;&#x6CD5;</a></h4>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Python/">Python</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/多线程/">多线程</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/并发/">并发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/编程/">编程</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016 wenqiang
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >本站到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.1.22/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>




    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<script>
(function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
  </div>
</body>
</html>

